2025-11-29 19:17:43,455 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-11-29 19:17:43,463 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-11-29 19:17:43,463 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-11-29 19:17:43,463 - INFO - ä¸Šä¼ ç›®å½•: file
2025-11-29 19:17:43,480 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-11-29 19:17:43,480 - INFO - [33mPress CTRL+C to quit[0m
2025-11-29 19:17:49,788 - INFO - 127.0.0.1 - - [29/Nov/2025 19:17:49] "GET / HTTP/1.1" 200 -
2025-11-29 19:17:49,809 - INFO - 127.0.0.1 - - [29/Nov/2025 19:17:49] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-29 19:17:50,028 - INFO - 127.0.0.1 - - [29/Nov/2025 19:17:50] "GET /static/js/app.js HTTP/1.1" 200 -
2025-11-29 19:17:50,378 - INFO - 127.0.0.1 - - [29/Nov/2025 19:17:50] "GET /api/files HTTP/1.1" 200 -
2025-11-29 19:17:50,379 - INFO - 127.0.0.1 - - [29/Nov/2025 19:17:50] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-29 19:17:54,809 - INFO - 127.0.0.1 - - [29/Nov/2025 19:17:54] "GET /api/reports/daily/2025-11-28 HTTP/1.1" 200 -
2025-11-29 19:18:01,714 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:01] "GET /api/reports/monthly/2025-11 HTTP/1.1" 200 -
2025-11-29 19:18:21,512 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:21] "POST /api/schedule/update HTTP/1.1" 200 -
2025-11-29 19:18:25,704 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:25] "POST /api/schedule/update HTTP/1.1" 200 -
2025-11-29 19:18:27,834 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:27] "POST /api/schedule/update HTTP/1.1" 200 -
2025-11-29 19:18:30,647 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:30] "[32mGET /logout HTTP/1.1[0m" 302 -
2025-11-29 19:18:30,731 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:30] "GET /login HTTP/1.1" 200 -
2025-11-29 19:18:42,820 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:42] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-29 19:18:43,018 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:43] "GET / HTTP/1.1" 200 -
2025-11-29 19:18:43,379 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:43] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-29 19:18:43,380 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:43] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-29 19:18:43,636 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:43] "GET /api/files HTTP/1.1" 200 -
2025-11-29 19:18:43,729 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:43] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-29 19:18:52,202 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:52] "GET /api/reports/monthly/2025-11 HTTP/1.1" 200 -
2025-11-29 19:18:54,888 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:54] "[33mGET /api/reports/daily/2025-11-29 HTTP/1.1[0m" 404 -
2025-11-29 19:18:57,911 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:57] "GET /api/reports/daily/2025-11-28 HTTP/1.1" 200 -
2025-11-29 19:21:42,036 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-29 19:21:42,037 - INFO - generate_report function called
2025-11-29 19:21:42,037 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 33, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 30, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 21, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 19, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 19, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 16, ('äºŒç­2ç»„', 'ä½•çµ', 'KF77171520'): 10, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 2, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 1, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1}
2025-11-29 19:21:42,037 - INFO - report_date: 2025-11-28
2025-11-29 19:21:42,037 - INFO - total_operations: 207
2025-11-29 19:21:42,037 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-28', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 207', '- **å‚ä¸äººæ•°**: 11', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 18.8', '']
2025-11-29 19:21:42,038 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251128.txt
2025-11-29 19:21:42,038 - INFO - Generating image report...
2025-11-29 19:21:42,038 - INFO - PIL is available.
2025-11-29 19:21:42,110 - INFO - Saving image to file\table_20251128.png
2025-11-29 19:21:42,160 - INFO - Image saved to file\table_20251128.png
2025-11-29 19:21:42,160 - INFO - Saving JPEG version to file\table_20251128.jpg
2025-11-29 19:21:42,166 - INFO - JPEG version saved to file\table_20251128.jpg
2025-11-29 19:21:42,167 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251128.png
2025-11-29 19:21:42,167 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-11-29 19:21:42,167 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251128.jpg
2025-11-29 19:21:42,167 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-11-29 19:21:42,657 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764415304194171406512226], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-11-29 19:21:42,657 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-11-29 19:21:43,216 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-11-29 19:21:43,216 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-11-29 19:21:43,218 - INFO - 127.0.0.1 - - [29/Nov/2025 19:21:43] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-11-29 19:22:46,466 - INFO - 127.0.0.1 - - [29/Nov/2025 19:22:46] "GET / HTTP/1.1" 200 -
2025-11-29 19:22:46,492 - INFO - 127.0.0.1 - - [29/Nov/2025 19:22:46] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-29 19:22:46,734 - INFO - 127.0.0.1 - - [29/Nov/2025 19:22:46] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-29 19:22:47,102 - INFO - 127.0.0.1 - - [29/Nov/2025 19:22:47] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-29 19:22:47,103 - INFO - 127.0.0.1 - - [29/Nov/2025 19:22:47] "GET /api/files HTTP/1.1" 200 -
2025-11-29 19:22:52,386 - INFO - 127.0.0.1 - - [29/Nov/2025 19:22:52] "GET / HTTP/1.1" 200 -
2025-11-29 19:22:52,689 - INFO - 127.0.0.1 - - [29/Nov/2025 19:22:52] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-29 19:22:52,753 - INFO - 127.0.0.1 - - [29/Nov/2025 19:22:52] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-29 19:22:53,076 - INFO - 127.0.0.1 - - [29/Nov/2025 19:22:53] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-29 19:22:53,077 - INFO - 127.0.0.1 - - [29/Nov/2025 19:22:53] "GET /api/files HTTP/1.1" 200 -
2025-11-29 19:23:15,251 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-11-29 19:23:15,258 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-11-29 19:23:15,258 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-11-29 19:23:15,258 - INFO - ä¸Šä¼ ç›®å½•: file
2025-11-29 19:23:15,266 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-11-29 19:23:15,266 - INFO - [33mPress CTRL+C to quit[0m
2025-11-29 19:23:18,381 - INFO - 127.0.0.1 - - [29/Nov/2025 19:23:18] "GET / HTTP/1.1" 200 -
2025-11-29 19:23:18,404 - INFO - 127.0.0.1 - - [29/Nov/2025 19:23:18] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-29 19:23:18,638 - INFO - 127.0.0.1 - - [29/Nov/2025 19:23:18] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-29 19:23:18,970 - INFO - 127.0.0.1 - - [29/Nov/2025 19:23:18] "GET /api/files HTTP/1.1" 200 -
2025-11-29 19:23:18,974 - INFO - 127.0.0.1 - - [29/Nov/2025 19:23:18] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-30 09:48:23,459 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-11-30 09:48:23,466 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-11-30 09:48:23,466 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-11-30 09:48:23,466 - INFO - ä¸Šä¼ ç›®å½•: file
2025-11-30 09:48:23,466 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-11-30 09:48:23,470 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-11-30 09:48:23,485 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-11-30 09:48:23,485 - INFO - [33mPress CTRL+C to quit[0m
2025-11-30 09:48:28,415 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:28] "GET / HTTP/1.1" 200 -
2025-11-30 09:48:28,459 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:28] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-30 09:48:28,683 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:28] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-30 09:48:29,011 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:29] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-30 09:48:29,011 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:29] "GET /api/files HTTP/1.1" 200 -
2025-11-30 09:48:32,871 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:32] "GET / HTTP/1.1" 200 -
2025-11-30 09:48:33,181 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:33] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-30 09:48:33,243 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:33] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-30 09:48:33,580 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:33] "GET /api/files HTTP/1.1" 200 -
2025-11-30 09:48:33,583 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:33] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-30 09:48:39,452 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:39] "GET /api/reports/daily/2025-11-28 HTTP/1.1" 200 -
2025-11-30 09:48:51,383 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 09:48:51,388 - INFO - æ–‡ä»¶å·²ä¿å­˜: file\KF77100064_20251130094732850.zip
2025-11-30 09:48:51,392 - INFO - æ­£åœ¨å¤„ç†æ–‡ä»¶: KF77100064_20251130094732850.zip
2025-11-30 09:48:53,134 - INFO - æ£€æµ‹åˆ°ç¼–ç : GB2312
2025-11-30 09:48:53,137 - INFO - æˆåŠŸä½¿ç”¨ç¼–ç : gbk
2025-11-30 09:48:53,138 - INFO - CSVæ ‡é¢˜: ['æœåŠ¡å', 'å¸å·', 'å§“å', 'æ¨¡å—', 'æ–¹æ³•æè¿°', 'æ“ä½œæ—¶é—´', 'è€—æ—¶', 'è¯·æ±‚url', 'çŠ¶æ€', 'å…¥å‚']
2025-11-30 09:48:53,142 - INFO - æ­£åœ¨ä¿å­˜ 214 æ¡è®°å½•åˆ°æ•°æ®åº“...
2025-11-30 09:48:53,205 - INFO - æ‰¹é‡æ’å…¥å®Œæˆï¼ŒæˆåŠŸ: 214/214ï¼Œè·³è¿‡é‡å¤: 0
2025-11-30 09:48:53,206 - INFO - æ­£åœ¨æ›´æ–°æ—¥æ±‡æ€»: 2025-11-29
2025-11-30 09:48:53,211 - INFO - æ—¥æ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-11-29
2025-11-30 09:48:53,211 - INFO - æ­£åœ¨æ›´æ–°æœˆæ±‡æ€»: 2025-11
2025-11-30 09:48:53,216 - INFO - æœˆæ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-11
2025-11-30 09:48:53,216 - INFO - generate_report function called
2025-11-30 09:48:53,216 - INFO - report_data: {('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11}
2025-11-30 09:48:53,216 - INFO - report_date: 2025-11-29
2025-11-30 09:48:53,216 - INFO - total_operations: 214
2025-11-30 09:48:53,216 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-11-30 09:48:53,218 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-11-30 09:48:53,218 - INFO - Generating image report...
2025-11-30 09:48:53,218 - INFO - PIL is available.
2025-11-30 09:48:53,300 - INFO - Saving image to file\table_20251129.png
2025-11-30 09:48:53,347 - INFO - Image saved to file\table_20251129.png
2025-11-30 09:48:53,347 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-11-30 09:48:53,352 - INFO - JPEG version saved to file\table_20251129.jpg
2025-11-30 09:48:53,353 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-11-30 09:48:53,353 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:53] "POST /api/upload HTTP/1.1" 200 -
2025-11-30 09:48:53,363 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:53] "GET /api/files HTTP/1.1" 200 -
2025-11-30 09:49:00,618 - INFO - 127.0.0.1 - - [30/Nov/2025 09:49:00] "GET /api/reports/daily/2025-11-29 HTTP/1.1" 200 -
2025-11-30 09:49:10,625 - INFO - 127.0.0.1 - - [30/Nov/2025 09:49:10] "GET /api/files HTTP/1.1" 200 -
2025-11-30 09:49:46,118 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 09:49:46,118 - INFO - generate_report function called
2025-11-30 09:49:46,118 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4}
2025-11-30 09:49:46,118 - INFO - report_date: 2025-11-29
2025-11-30 09:49:46,119 - INFO - total_operations: 214
2025-11-30 09:49:46,119 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-11-30 09:49:46,120 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-11-30 09:49:46,120 - INFO - Generating image report...
2025-11-30 09:49:46,120 - INFO - PIL is available.
2025-11-30 09:49:46,189 - INFO - Saving image to file\table_20251129.png
2025-11-30 09:49:46,209 - INFO - Image saved to file\table_20251129.png
2025-11-30 09:49:46,209 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-11-30 09:49:46,212 - INFO - JPEG version saved to file\table_20251129.jpg
2025-11-30 09:49:46,213 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-11-30 09:49:46,214 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-11-30 09:49:46,214 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251129.jpg
2025-11-30 09:49:46,214 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-11-30 09:49:46,701 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764467388555213340698186], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-11-30 09:49:46,702 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-11-30 09:49:47,232 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-11-30 09:49:47,232 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-11-30 09:49:47,234 - INFO - 127.0.0.1 - - [30/Nov/2025 09:49:47] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-11-30 09:58:08,616 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-11-30 09:58:08,622 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-11-30 09:58:08,622 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-11-30 09:58:08,622 - INFO - ä¸Šä¼ ç›®å½•: file
2025-11-30 09:58:08,622 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-11-30 09:58:08,626 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-11-30 09:58:08,636 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-11-30 09:58:08,636 - INFO - [33mPress CTRL+C to quit[0m
2025-11-30 09:58:23,955 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:23] "GET / HTTP/1.1" 200 -
2025-11-30 09:58:23,985 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:23] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-30 09:58:24,211 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:24] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-30 09:58:24,539 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:24] "GET /api/files HTTP/1.1" 200 -
2025-11-30 09:58:24,542 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:24] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-30 09:58:35,958 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:35] "GET /api/reports/daily/2025-11-29 HTTP/1.1" 200 -
2025-11-30 09:58:49,895 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:49] "POST /api/schedule/update HTTP/1.1" 200 -
2025-11-30 09:58:50,883 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:50] "POST /api/schedule/update HTTP/1.1" 200 -
2025-11-30 09:58:53,396 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:53] "GET / HTTP/1.1" 200 -
2025-11-30 09:58:53,426 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:53] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-30 09:58:53,661 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:53] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-30 09:58:53,983 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:53] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-30 09:58:53,983 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:53] "GET /api/files HTTP/1.1" 200 -
2025-11-30 10:02:41,072 - INFO - 127.0.0.1 - - [30/Nov/2025 10:02:41] "GET /api/reports/daily/2025-11-29 HTTP/1.1" 200 -
2025-11-30 10:02:46,074 - INFO - 127.0.0.1 - - [30/Nov/2025 10:02:46] "POST /api/schedule/update HTTP/1.1" 200 -
2025-11-30 10:03:11,540 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:03:11,541 - INFO - generate_report function called
2025-11-30 10:03:11,541 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4}
2025-11-30 10:03:11,541 - INFO - report_date: 2025-11-29
2025-11-30 10:03:11,541 - INFO - total_operations: 214
2025-11-30 10:03:11,541 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-11-30 10:03:11,543 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-11-30 10:03:11,543 - INFO - Generating image report...
2025-11-30 10:03:11,543 - INFO - PIL is available.
2025-11-30 10:03:11,605 - INFO - Saving image to file\table_20251129.png
2025-11-30 10:03:11,638 - INFO - Image saved to file\table_20251129.png
2025-11-30 10:03:11,638 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-11-30 10:03:11,640 - INFO - JPEG version saved to file\table_20251129.jpg
2025-11-30 10:03:11,642 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-11-30 10:03:11,642 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-11-30 10:03:11,642 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251129.jpg
2025-11-30 10:03:11,642 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-11-30 10:03:12,115 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764468194358773001248401], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-11-30 10:03:12,115 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-11-30 10:03:12,676 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-11-30 10:03:12,676 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-11-30 10:03:12,678 - INFO - 127.0.0.1 - - [30/Nov/2025 10:03:12] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-11-30 10:10:35,236 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-11-30 10:10:35,242 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-11-30 10:10:35,242 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-11-30 10:10:35,242 - INFO - ä¸Šä¼ ç›®å½•: file
2025-11-30 10:10:35,242 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-11-30 10:10:35,246 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-11-30 10:10:35,369 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-11-30 10:10:35,369 - INFO - [33mPress CTRL+C to quit[0m
2025-11-30 10:11:43,792 - INFO - 127.0.0.1 - - [30/Nov/2025 10:11:43] "GET / HTTP/1.1" 200 -
2025-11-30 10:11:43,830 - INFO - 127.0.0.1 - - [30/Nov/2025 10:11:43] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-30 10:11:44,053 - INFO - 127.0.0.1 - - [30/Nov/2025 10:11:44] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-30 10:11:44,402 - INFO - 127.0.0.1 - - [30/Nov/2025 10:11:44] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-30 10:11:44,408 - INFO - 127.0.0.1 - - [30/Nov/2025 10:11:44] "GET /api/files HTTP/1.1" 200 -
2025-11-30 10:11:46,272 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:11:46,272 - INFO - 127.0.0.1 - - [30/Nov/2025 10:11:46] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-11-30 10:11:52,972 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:11:52,974 - INFO - 127.0.0.1 - - [30/Nov/2025 10:11:52] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-11-30 10:12:00,057 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:12:00,057 - INFO - generate_report function called
2025-11-30 10:12:00,057 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4}
2025-11-30 10:12:00,057 - INFO - report_date: 2025-11-29
2025-11-30 10:12:00,057 - INFO - total_operations: 214
2025-11-30 10:12:00,057 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-11-30 10:12:00,058 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-11-30 10:12:00,058 - INFO - Generating image report...
2025-11-30 10:12:00,058 - INFO - PIL is available.
2025-11-30 10:12:00,120 - INFO - Saving image to file\table_20251129.png
2025-11-30 10:12:00,141 - INFO - Image saved to file\table_20251129.png
2025-11-30 10:12:00,141 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-11-30 10:12:00,144 - INFO - JPEG version saved to file\table_20251129.jpg
2025-11-30 10:12:00,145 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-11-30 10:12:00,145 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-11-30 10:12:00,145 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251129.jpg
2025-11-30 10:12:00,145 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-11-30 10:12:00,594 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764468722396422199803659], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-11-30 10:12:00,594 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-11-30 10:12:01,190 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-11-30 10:12:01,190 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-11-30 10:12:01,191 - INFO - 127.0.0.1 - - [30/Nov/2025 10:12:01] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-11-30 10:13:36,883 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-11-30 10:13:36,888 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-11-30 10:13:36,888 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-11-30 10:13:36,888 - INFO - ä¸Šä¼ ç›®å½•: file
2025-11-30 10:13:36,888 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-11-30 10:13:36,891 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-11-30 10:13:36,903 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-11-30 10:13:36,903 - INFO - [33mPress CTRL+C to quit[0m
2025-11-30 10:14:11,494 - INFO - 127.0.0.1 - - [30/Nov/2025 10:14:11] "GET / HTTP/1.1" 200 -
2025-11-30 10:14:11,522 - INFO - 127.0.0.1 - - [30/Nov/2025 10:14:11] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-30 10:14:11,770 - INFO - 127.0.0.1 - - [30/Nov/2025 10:14:11] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-30 10:14:12,133 - INFO - 127.0.0.1 - - [30/Nov/2025 10:14:12] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-30 10:14:12,133 - INFO - 127.0.0.1 - - [30/Nov/2025 10:14:12] "GET /api/files HTTP/1.1" 200 -
2025-11-30 10:14:20,223 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-29, ç¯å¢ƒ: test
2025-11-30 10:14:20,223 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-29, ç¯å¢ƒ: test
2025-11-30 10:14:20,223 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:14:20,223 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:14:20,224 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:14:20,224 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:14:20,230 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:14:20,232 - INFO - generate_report function called
2025-11-30 10:14:20,232 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4}
2025-11-30 10:14:20,232 - INFO - report_date: 2025-11-29
2025-11-30 10:14:20,232 - INFO - total_operations: 214
2025-11-30 10:14:20,232 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-11-30 10:14:20,233 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-11-30 10:14:20,233 - INFO - Generating image report...
2025-11-30 10:14:20,233 - INFO - PIL is available.
2025-11-30 10:14:20,296 - INFO - Saving image to file\table_20251129.png
2025-11-30 10:14:20,329 - INFO - Image saved to file\table_20251129.png
2025-11-30 10:14:20,329 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-11-30 10:14:20,333 - INFO - JPEG version saved to file\table_20251129.jpg
2025-11-30 10:14:20,334 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-11-30 10:14:20,334 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:14:20,334 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-11-30 10:14:20,334 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251129.jpg
2025-11-30 10:14:20,335 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-11-30 10:14:20,729 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764468862555212648536647], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-11-30 10:14:20,729 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-11-30 10:14:21,271 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-11-30 10:14:21,271 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-11-30 10:14:21,271 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-11-30 10:14:21,273 - INFO - 127.0.0.1 - - [30/Nov/2025 10:14:21] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-11-30 10:17:42,549 - INFO - 127.0.0.1 - - [30/Nov/2025 10:17:42] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-30 10:17:42,554 - INFO - 127.0.0.1 - - [30/Nov/2025 10:17:42] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-30 10:17:50,839 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-29, ç¯å¢ƒ: test
2025-11-30 10:17:50,839 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-29, ç¯å¢ƒ: test
2025-11-30 10:17:50,840 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:17:50,840 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:17:50,840 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:17:50,840 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:17:50,847 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:17:50,848 - INFO - generate_report function called
2025-11-30 10:17:50,848 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4}
2025-11-30 10:17:50,848 - INFO - report_date: 2025-11-29
2025-11-30 10:17:50,848 - INFO - total_operations: 214
2025-11-30 10:17:50,848 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-11-30 10:17:50,849 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-11-30 10:17:50,849 - INFO - Generating image report...
2025-11-30 10:17:50,850 - INFO - PIL is available.
2025-11-30 10:17:50,909 - INFO - Saving image to file\table_20251129.png
2025-11-30 10:17:50,929 - INFO - Image saved to file\table_20251129.png
2025-11-30 10:17:50,930 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-11-30 10:17:50,934 - INFO - JPEG version saved to file\table_20251129.jpg
2025-11-30 10:17:50,934 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-11-30 10:17:50,934 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:17:50,935 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-11-30 10:17:50,935 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251129.jpg
2025-11-30 10:17:50,935 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-11-30 10:17:51,413 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764469073448152479758922], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-11-30 10:17:51,414 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-11-30 10:17:52,011 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-11-30 10:17:52,011 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-11-30 10:17:52,011 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-11-30 10:17:52,013 - INFO - 127.0.0.1 - - [30/Nov/2025 10:17:52] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-11-30 10:19:17,212 - INFO - 127.0.0.1 - - [30/Nov/2025 10:19:17] "GET / HTTP/1.1" 200 -
2025-11-30 10:19:17,267 - INFO - 127.0.0.1 - - [30/Nov/2025 10:19:17] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-30 10:19:17,484 - INFO - 127.0.0.1 - - [30/Nov/2025 10:19:17] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-30 10:19:17,571 - INFO - 127.0.0.1 - - [30/Nov/2025 10:19:17] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-30 10:19:17,910 - INFO - 127.0.0.1 - - [30/Nov/2025 10:19:17] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-30 10:19:17,915 - INFO - 127.0.0.1 - - [30/Nov/2025 10:19:17] "GET /api/files HTTP/1.1" 200 -
2025-11-30 10:19:21,221 - INFO - 127.0.0.1 - - [30/Nov/2025 10:19:21] "[33mGET /api/reports/daily/2025-11-30 HTTP/1.1[0m" 404 -
2025-11-30 10:19:25,024 - INFO - 127.0.0.1 - - [30/Nov/2025 10:19:25] "GET /api/reports/daily/2025-11-29 HTTP/1.1" 200 -
2025-11-30 10:19:29,762 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-29, ç¯å¢ƒ: test
2025-11-30 10:19:29,762 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-29, ç¯å¢ƒ: test
2025-11-30 10:19:29,762 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:19:29,762 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:19:29,762 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:19:29,762 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:19:29,769 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:19:29,770 - INFO - generate_report function called
2025-11-30 10:19:29,770 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4}
2025-11-30 10:19:29,770 - INFO - report_date: 2025-11-29
2025-11-30 10:19:29,770 - INFO - total_operations: 214
2025-11-30 10:19:29,770 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-11-30 10:19:29,771 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-11-30 10:19:29,771 - INFO - Generating image report...
2025-11-30 10:19:29,771 - INFO - PIL is available.
2025-11-30 10:19:29,836 - INFO - Saving image to file\table_20251129.png
2025-11-30 10:19:29,857 - INFO - Image saved to file\table_20251129.png
2025-11-30 10:19:29,857 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-11-30 10:19:29,861 - INFO - JPEG version saved to file\table_20251129.jpg
2025-11-30 10:19:29,861 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-11-30 10:19:29,862 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:19:29,862 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-11-30 10:19:29,862 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251129.jpg
2025-11-30 10:19:29,862 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-11-30 10:19:30,328 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764469172427493395517360], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-11-30 10:19:30,328 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-11-30 10:19:30,833 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-11-30 10:19:30,833 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-11-30 10:19:30,834 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-11-30 10:19:30,839 - INFO - 127.0.0.1 - - [30/Nov/2025 10:19:30] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-11-30 10:20:34,987 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:20:34,988 - INFO - å¼€å§‹æ£€æŸ¥å½“å¤©çš„æ–°æ–‡ä»¶...
2025-11-30 10:20:34,988 - INFO - æ‰¾åˆ° 1 ä¸ªå½“å¤©çš„æ–°æ–‡ä»¶: ['KF77100064_20251130094732850.zip']
2025-11-30 10:20:34,988 - INFO - æ­£åœ¨å¤„ç†æ–‡ä»¶: KF77100064_20251130094732850.zip
2025-11-30 10:20:36,631 - INFO - æ£€æµ‹åˆ°ç¼–ç : GB2312
2025-11-30 10:20:36,632 - INFO - æˆåŠŸä½¿ç”¨ç¼–ç : gbk
2025-11-30 10:20:36,632 - INFO - CSVæ ‡é¢˜: ['æœåŠ¡å', 'å¸å·', 'å§“å', 'æ¨¡å—', 'æ–¹æ³•æè¿°', 'æ“ä½œæ—¶é—´', 'è€—æ—¶', 'è¯·æ±‚url', 'çŠ¶æ€', 'å…¥å‚']
2025-11-30 10:20:36,639 - INFO - generate_report function called
2025-11-30 10:20:36,639 - INFO - report_data: {('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11}
2025-11-30 10:20:36,639 - INFO - report_date: 2025-11-29
2025-11-30 10:20:36,639 - INFO - total_operations: 214
2025-11-30 10:20:36,639 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-11-30 10:20:36,641 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-11-30 10:20:36,641 - INFO - Generating image report...
2025-11-30 10:20:36,641 - INFO - PIL is available.
2025-11-30 10:20:36,695 - INFO - Saving image to file\table_20251129.png
2025-11-30 10:20:36,731 - INFO - Image saved to file\table_20251129.png
2025-11-30 10:20:36,731 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-11-30 10:20:36,734 - INFO - JPEG version saved to file\table_20251129.jpg
2025-11-30 10:20:36,735 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-11-30 10:20:36,735 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:20:36,735 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-11-30 10:20:36,735 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251129.jpg
2025-11-30 10:20:36,736 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-11-30 10:20:37,148 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764469239609663190723037], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-11-30 10:20:37,149 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-11-30 10:20:37,728 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-11-30 10:20:37,729 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-11-30 10:20:37,729 - INFO - æ–‡ä»¶ KF77100064_20251130094732850.zip å¤„ç†å®Œæˆå¹¶å‘é€æˆåŠŸ
2025-11-30 10:21:14,226 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:21:14,226 - INFO - å¼€å§‹æ£€æŸ¥å½“å¤©çš„æ–°æ–‡ä»¶...
2025-11-30 10:21:14,226 - INFO - æ‰¾åˆ° 1 ä¸ªå½“å¤©çš„æ–°æ–‡ä»¶: ['KF77100064_20251130094732850.zip']
2025-11-30 10:21:14,226 - INFO - æ­£åœ¨å¤„ç†æ–‡ä»¶: KF77100064_20251130094732850.zip
2025-11-30 10:21:15,859 - INFO - æ£€æµ‹åˆ°ç¼–ç : GB2312
2025-11-30 10:21:15,861 - INFO - æˆåŠŸä½¿ç”¨ç¼–ç : gbk
2025-11-30 10:21:15,861 - INFO - CSVæ ‡é¢˜: ['æœåŠ¡å', 'å¸å·', 'å§“å', 'æ¨¡å—', 'æ–¹æ³•æè¿°', 'æ“ä½œæ—¶é—´', 'è€—æ—¶', 'è¯·æ±‚url', 'çŠ¶æ€', 'å…¥å‚']
2025-11-30 10:21:15,867 - INFO - generate_report function called
2025-11-30 10:21:15,867 - INFO - report_data: {('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11}
2025-11-30 10:21:15,867 - INFO - report_date: 2025-11-29
2025-11-30 10:21:15,867 - INFO - total_operations: 214
2025-11-30 10:21:15,868 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-11-30 10:21:15,869 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-11-30 10:21:15,869 - INFO - Generating image report...
2025-11-30 10:21:15,869 - INFO - PIL is available.
2025-11-30 10:21:15,924 - INFO - Saving image to file\table_20251129.png
2025-11-30 10:21:15,959 - INFO - Image saved to file\table_20251129.png
2025-11-30 10:21:15,960 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-11-30 10:21:15,963 - INFO - JPEG version saved to file\table_20251129.jpg
2025-11-30 10:21:15,963 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-11-30 10:21:15,964 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=f063326...
2025-11-30 10:21:15,964 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-11-30 10:21:15,964 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251129.jpg
2025-11-30 10:21:15,964 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-11-30 10:21:16,402 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764469278560333486777631], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-11-30 10:21:16,402 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-11-30 10:21:16,962 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-11-30 10:21:16,962 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-11-30 10:21:16,962 - INFO - æ–‡ä»¶ KF77100064_20251130094732850.zip å¤„ç†å®Œæˆå¹¶å‘é€æˆåŠŸ
2025-11-30 10:28:27,329 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-11-30 10:28:27,334 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-11-30 10:28:27,334 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-11-30 10:28:27,334 - INFO - ä¸Šä¼ ç›®å½•: file
2025-11-30 10:28:27,334 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-11-30 10:28:27,338 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-11-30 10:28:27,349 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-11-30 10:28:27,349 - INFO - [33mPress CTRL+C to quit[0m
2025-11-30 10:28:30,942 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:30] "GET / HTTP/1.1" 200 -
2025-11-30 10:28:31,013 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:31] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-30 10:28:31,200 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:31] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-30 10:28:31,323 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:31] "GET /static/js/app.js HTTP/1.1" 200 -
2025-11-30 10:28:31,669 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:31] "GET /api/files HTTP/1.1" 200 -
2025-11-30 10:28:31,671 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:31] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-30 10:28:44,843 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:44,844 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:44,844 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:44,844 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:44,844 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:44,844 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:44,851 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:28:44,852 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:44] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-11-30 10:28:47,237 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:47,238 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:47,238 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:47,238 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:47,238 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:47,238 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:47,244 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:28:47,244 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:47] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-11-30 10:28:48,145 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:48,145 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:48,145 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:48,145 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:48,145 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:48,145 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:48,152 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:28:48,153 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:48] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-11-30 10:28:49,416 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:49,417 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:49,418 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:49,418 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:49,419 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:49,419 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:49,430 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:28:49,431 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:49] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-11-30 10:28:51,048 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:51,048 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:51,048 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:51,048 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:51,048 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:51,049 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:51,055 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:28:51,056 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:51] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-11-30 10:28:52,120 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:52,120 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:52,120 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:52,121 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:52,121 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:52,121 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:52,127 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:28:52,128 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:52] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-11-30 10:28:52,761 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:52,761 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:52,761 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:52,761 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:52,762 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:52,762 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:52,769 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:28:52,770 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:52] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-11-30 10:28:56,757 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-29, ç¯å¢ƒ: test
2025-11-30 10:28:56,757 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-29, ç¯å¢ƒ: test
2025-11-30 10:28:56,758 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:56,758 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:56,758 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:56,759 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:56,773 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:28:56,774 - INFO - generate_report function called
2025-11-30 10:28:56,774 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4}
2025-11-30 10:28:56,774 - INFO - report_date: 2025-11-29
2025-11-30 10:28:56,774 - INFO - total_operations: 214
2025-11-30 10:28:56,775 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-11-30 10:28:56,776 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-11-30 10:28:56,776 - INFO - Generating image report...
2025-11-30 10:28:56,777 - INFO - PIL is available.
2025-11-30 10:28:56,839 - INFO - Saving image to file\table_20251129.png
2025-11-30 10:28:56,861 - INFO - Image saved to file\table_20251129.png
2025-11-30 10:28:56,861 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-11-30 10:28:56,865 - INFO - JPEG version saved to file\table_20251129.jpg
2025-11-30 10:28:56,866 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-11-30 10:28:56,866 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:56,866 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-11-30 10:28:56,866 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251129.jpg
2025-11-30 10:28:56,866 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-11-30 10:28:57,322 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764469739182031978468384], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-11-30 10:28:57,322 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-11-30 10:28:57,873 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-11-30 10:28:57,873 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-11-30 10:28:57,873 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-11-30 10:28:57,875 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:57] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-11-30 10:29:10,265 - INFO - 127.0.0.1 - - [30/Nov/2025 10:29:10] "POST /api/schedule/update HTTP/1.1" 200 -
2025-11-30 10:29:28,908 - INFO - 127.0.0.1 - - [30/Nov/2025 10:29:28] "GET /api/reports/daily/2025-11-29 HTTP/1.1" 200 -
2025-11-30 10:29:37,135 - INFO - 127.0.0.1 - - [30/Nov/2025 10:29:37] "GET /api/reports/daily/2025-11-28 HTTP/1.1" 200 -
2025-11-30 10:29:41,849 - INFO - 127.0.0.1 - - [30/Nov/2025 10:29:41] "GET /api/reports/daily/2025-11-28 HTTP/1.1" 200 -
2025-11-30 10:29:44,357 - INFO - 127.0.0.1 - - [30/Nov/2025 10:29:44] "GET /api/reports/daily/2025-11-27 HTTP/1.1" 200 -
2025-11-30 10:29:47,132 - INFO - 127.0.0.1 - - [30/Nov/2025 10:29:47] "GET /api/reports/daily/2025-11-29 HTTP/1.1" 200 -
2025-11-30 10:29:49,983 - INFO - 127.0.0.1 - - [30/Nov/2025 10:29:49] "GET /api/reports/monthly/2025-11 HTTP/1.1" 200 -
2025-11-30 10:30:48,053 - INFO - 127.0.0.1 - - [30/Nov/2025 10:30:48] "GET / HTTP/1.1" 200 -
2025-11-30 10:30:48,083 - INFO - 127.0.0.1 - - [30/Nov/2025 10:30:48] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-30 10:30:48,297 - INFO - 127.0.0.1 - - [30/Nov/2025 10:30:48] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-30 10:30:48,627 - INFO - 127.0.0.1 - - [30/Nov/2025 10:30:48] "GET /api/files HTTP/1.1" 200 -
2025-11-30 10:30:48,658 - INFO - 127.0.0.1 - - [30/Nov/2025 10:30:48] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-30 10:31:04,566 - INFO - 127.0.0.1 - - [30/Nov/2025 10:31:04] "GET /api/files HTTP/1.1" 200 -
2025-11-30 10:31:18,395 - INFO - 127.0.0.1 - - [30/Nov/2025 10:31:18] "GET /api/reports/daily/2025-11-29 HTTP/1.1" 200 -
2025-11-30 10:31:22,733 - INFO - 127.0.0.1 - - [30/Nov/2025 10:31:22] "GET /api/reports/daily/2025-11-18 HTTP/1.1" 200 -
2025-11-30 10:32:13,650 - INFO - 127.0.0.1 - - [30/Nov/2025 10:32:13] "GET / HTTP/1.1" 200 -
2025-11-30 10:32:13,793 - INFO - 127.0.0.1 - - [30/Nov/2025 10:32:13] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-30 10:32:13,917 - INFO - 127.0.0.1 - - [30/Nov/2025 10:32:13] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-30 10:32:14,247 - INFO - 127.0.0.1 - - [30/Nov/2025 10:32:14] "GET /api/files HTTP/1.1" 200 -
2025-11-30 10:32:14,251 - INFO - 127.0.0.1 - - [30/Nov/2025 10:32:14] "GET /api/schedule/status HTTP/1.1" 200 -
