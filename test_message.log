2025-12-03 17:08:21,629 - INFO - 127.0.0.1 - - [03/Dec/2025 17:08:21] "GET /api/reports/monthly/2025-10 HTTP/1.1" 200 -
2025-12-03 17:10:11,775 - INFO - 127.0.0.1 - - [03/Dec/2025 17:10:11] "GET /api/files HTTP/1.1" 200 -
2025-12-03 17:14:41,470 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-12-03 17:14:41,470 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-12-03 17:14:41,471 - INFO - ä¸Šä¼ ç›®å½•: file
2025-12-03 17:14:41,471 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-12-03 17:14:41,472 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-12-03 17:14:41,481 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-12-03 17:14:41,481 - INFO - [33mPress CTRL+C to quit[0m
2025-12-03 17:18:02,575 - INFO - 127.0.0.1 - - [03/Dec/2025 17:18:02] "GET / HTTP/1.1" 200 -
2025-12-03 17:18:02,629 - INFO - 127.0.0.1 - - [03/Dec/2025 17:18:02] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-03 17:18:02,824 - INFO - 127.0.0.1 - - [03/Dec/2025 17:18:02] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-03 17:18:03,174 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-03 17:18:03,175 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-03 17:18:03,175 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-03 17:18:03,175 - INFO - 127.0.0.1 - - [03/Dec/2025 17:18:03] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-03 17:18:03,359 - INFO - 127.0.0.1 - - [03/Dec/2025 17:18:03] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-03 17:18:03,372 - INFO - 127.0.0.1 - - [03/Dec/2025 17:18:03] "GET /api/files HTTP/1.1" 200 -
2025-12-03 17:18:57,343 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-03 17:18:57,343 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-03 17:18:57,345 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-03 17:18:57,345 - INFO - 127.0.0.1 - - [03/Dec/2025 17:18:57] "GET /api/reports/monthly/2025-11 HTTP/1.1" 200 -
2025-12-03 17:19:40,202 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-03 17:19:40,202 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-03 17:19:40,203 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-03 17:19:40,203 - INFO - 127.0.0.1 - - [03/Dec/2025 17:19:40] "GET /api/reports/monthly/2025-10 HTTP/1.1" 200 -
2025-12-03 17:24:07,225 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-12-03 17:24:07,225 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-12-03 17:24:07,226 - INFO - ä¸Šä¼ ç›®å½•: file
2025-12-03 17:24:07,226 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-12-03 17:24:07,227 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-12-03 17:24:07,239 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-12-03 17:24:07,239 - INFO - [33mPress CTRL+C to quit[0m
2025-12-03 17:24:15,527 - INFO - å·²åˆ›å»ºå®šæ—¶ä»»åŠ¡: æ¯å¤© 10:00 æ‰§è¡Œ
2025-12-03 17:24:15,527 - INFO - å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨çº¿ç¨‹å·²å¯åŠ¨
2025-12-03 17:24:15,527 - INFO - å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨å·²å¯åŠ¨
2025-12-03 17:24:15,528 - INFO - 127.0.0.1 - - [03/Dec/2025 17:24:15] "POST /api/schedule/update HTTP/1.1" 200 -
2025-12-03 17:24:23,597 - INFO - å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨çº¿ç¨‹å·²åœæ­¢
2025-12-03 17:24:23,597 - INFO - å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨å·²åœæ­¢
2025-12-03 17:24:23,597 - INFO - å®šæ—¶ä»»åŠ¡å·²åœç”¨
2025-12-03 17:24:23,598 - INFO - 127.0.0.1 - - [03/Dec/2025 17:24:23] "POST /api/schedule/update HTTP/1.1" 200 -
2025-12-03 17:25:31,705 - INFO - 127.0.0.1 - - [03/Dec/2025 17:25:31] "GET /api/files HTTP/1.1" 200 -
2025-12-03 17:26:30,285 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-03 17:26:30,285 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-03 17:26:30,286 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-03 17:26:30,286 - INFO - 127.0.0.1 - - [03/Dec/2025 17:26:30] "GET /api/reports/monthly/2025-12 HTTP/1.1" 200 -
2025-12-04 08:45:51,940 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-12-04 08:45:51,940 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-12-04 08:45:51,941 - INFO - ä¸Šä¼ ç›®å½•: file
2025-12-04 08:45:51,941 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-12-04 08:45:51,941 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-12-04 08:45:51,972 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-12-04 08:45:51,973 - INFO - [33mPress CTRL+C to quit[0m
2025-12-04 08:45:56,443 - INFO - 127.0.0.1 - - [04/Dec/2025 08:45:56] "GET / HTTP/1.1" 200 -
2025-12-04 08:45:56,522 - INFO - 127.0.0.1 - - [04/Dec/2025 08:45:56] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-04 08:45:56,761 - INFO - 127.0.0.1 - - [04/Dec/2025 08:45:56] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-04 08:45:57,268 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-04 08:45:57,269 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-04 08:45:57,272 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-04 08:45:57,273 - INFO - 127.0.0.1 - - [04/Dec/2025 08:45:57] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-04 08:45:57,320 - INFO - 127.0.0.1 - - [04/Dec/2025 08:45:57] "GET /api/files HTTP/1.1" 200 -
2025-12-04 08:45:57,366 - INFO - 127.0.0.1 - - [04/Dec/2025 08:45:57] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-04 08:46:21,440 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-04 08:46:21,441 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-04 08:46:21,441 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-04 08:46:21,443 - INFO - æ–‡ä»¶å·²ä¿å­˜: file\KF77100064_20251204084446476.zip
2025-12-04 08:46:21,446 - INFO - æ­£åœ¨å¤„ç†æ–‡ä»¶: KF77100064_20251204084446476.zip
2025-12-04 08:46:23,608 - INFO - æ£€æµ‹åˆ°ç¼–ç : GB2312
2025-12-04 08:46:23,609 - INFO - æˆåŠŸä½¿ç”¨ç¼–ç : gbk
2025-12-04 08:46:23,610 - INFO - CSVæ ‡é¢˜: ['æœåŠ¡å', 'å¸å·', 'å§“å', 'æ¨¡å—', 'æ–¹æ³•æè¿°', 'æ“ä½œæ—¶é—´', 'è€—æ—¶', 'è¯·æ±‚url', 'çŠ¶æ€', 'å…¥å‚']
2025-12-04 08:46:23,619 - INFO - æ­£åœ¨ä¿å­˜ 1081 æ¡è®°å½•åˆ°æ•°æ®åº“...
2025-12-04 08:46:24,407 - INFO - æ‰¹é‡æ’å…¥å®Œæˆï¼ŒæˆåŠŸ: 1022/1081ï¼Œè·³è¿‡é‡å¤: 59
2025-12-04 08:46:24,407 - INFO - æ­£åœ¨æ›´æ–°æ—¥æ±‡æ€»: 2025-12-03
2025-12-04 08:46:24,411 - INFO - æ—¥æ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-12-03
2025-12-04 08:46:24,411 - INFO - æ­£åœ¨æ›´æ–°æœˆæ±‡æ€»: 2025-12
2025-12-04 08:46:24,432 - ERROR - æ›´æ–°æœˆæ±‡æ€»å¤±è´¥: UNIQUE constraint failed: monthly_summary.year_month, monthly_summary.account
2025-12-04 08:46:24,432 - INFO - generate_report function called
2025-12-04 08:46:24,432 - INFO - report_data: {('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 11, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 22, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 22, ('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 28, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 15, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 25, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1, ('äºŒç­2ç»„', 'ä½•çµ', 'KF77171520'): 13, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 36}
2025-12-04 08:46:24,432 - INFO - report_date: 2025-12-03
2025-12-04 08:46:24,433 - INFO - total_operations: 173
2025-12-04 08:46:24,433 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-03', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 173', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 19.2', '']
2025-12-04 08:46:24,433 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251203.txt
2025-12-04 08:46:24,434 - INFO - Generating image report...
2025-12-04 08:46:24,434 - INFO - PIL is available.
2025-12-04 08:46:24,515 - INFO - Saving image to file\table_20251203.png
2025-12-04 08:46:24,560 - INFO - Image saved to file\table_20251203.png
2025-12-04 08:46:24,561 - INFO - Saving JPEG version to file\table_20251203.jpg
2025-12-04 08:46:24,566 - INFO - JPEG version saved to file\table_20251203.jpg
2025-12-04 08:46:24,567 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251203.png
2025-12-04 08:46:24,568 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-04 08:46:24,568 - INFO - 127.0.0.1 - - [04/Dec/2025 08:46:24] "POST /api/upload HTTP/1.1" 200 -
2025-12-04 08:46:24,890 - INFO - 127.0.0.1 - - [04/Dec/2025 08:46:24] "GET /api/files HTTP/1.1" 200 -
2025-12-04 08:46:32,699 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-04 08:46:32,699 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-04 08:46:32,700 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-04 08:46:32,700 - INFO - 127.0.0.1 - - [04/Dec/2025 08:46:32] "GET /api/reports/daily/2025-12-03 HTTP/1.1" 200 -
2025-12-04 08:47:10,627 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-04 08:47:10,628 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-04 08:47:10,633 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-04 08:47:10,634 - INFO - 127.0.0.1 - - [04/Dec/2025 08:47:10] "GET /api/reports/daily/2025-12-02 HTTP/1.1" 200 -
2025-12-04 08:47:20,291 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-04 08:47:20,292 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-04 08:47:20,292 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-04 08:47:20,293 - INFO - 127.0.0.1 - - [04/Dec/2025 08:47:20] "GET /api/reports/daily/2025-12-03 HTTP/1.1" 200 -
2025-12-04 08:47:36,891 - INFO - å·²åˆ›å»ºå®šæ—¶ä»»åŠ¡: æ¯å¤© 10:00 æ‰§è¡Œ
2025-12-04 08:47:36,891 - INFO - å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨çº¿ç¨‹å·²å¯åŠ¨
2025-12-04 08:47:36,892 - INFO - å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨å·²å¯åŠ¨
2025-12-04 08:47:36,892 - INFO - 127.0.0.1 - - [04/Dec/2025 08:47:36] "POST /api/schedule/update HTTP/1.1" 200 -
2025-12-04 08:47:43,361 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-04, ç¯å¢ƒ: test
2025-12-04 08:47:43,361 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-04 08:47:43,361 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-04 08:47:43,362 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-04 08:47:43,362 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-04 08:47:43,369 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-04 08:47:43,370 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-04 08:47:43,370 - INFO - 127.0.0.1 - - [04/Dec/2025 08:47:43] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-12-04 08:47:48,304 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-03, ç¯å¢ƒ: test
2025-12-04 08:47:48,305 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-04 08:47:48,305 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-04 08:47:48,306 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-04 08:47:48,307 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-04 08:47:48,319 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-04 08:47:48,321 - INFO - generate_report function called
2025-12-04 08:47:48,321 - INFO - report_data: {('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 36, ('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 28, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 25, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 22, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 22, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 15, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 11, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1}
2025-12-04 08:47:48,322 - INFO - report_date: 2025-12-03
2025-12-04 08:47:48,322 - INFO - total_operations: 160
2025-12-04 08:47:48,322 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-03', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 160', '- **å‚ä¸äººæ•°**: 8', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 20.0', '']
2025-12-04 08:47:48,324 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251203.txt
2025-12-04 08:47:48,324 - INFO - Generating image report...
2025-12-04 08:47:48,324 - INFO - PIL is available.
2025-12-04 08:47:48,439 - INFO - Saving image to file\table_20251203.png
2025-12-04 08:47:48,460 - INFO - Image saved to file\table_20251203.png
2025-12-04 08:47:48,460 - INFO - Saving JPEG version to file\table_20251203.jpg
2025-12-04 08:47:48,464 - INFO - JPEG version saved to file\table_20251203.jpg
2025-12-04 08:47:48,465 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251203.png
2025-12-04 08:47:48,465 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-04 08:47:48,465 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251203.jpg
2025-12-04 08:47:48,465 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-04 08:47:48,958 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764809269189711632583622], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-04 08:47:48,958 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-04 08:47:49,514 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-04 08:47:49,514 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-04 08:47:49,514 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-04 08:47:49,515 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-04 08:47:49,516 - INFO - 127.0.0.1 - - [04/Dec/2025 08:47:49] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-04 08:48:30,639 - INFO - å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨çº¿ç¨‹å·²åœæ­¢
2025-12-04 08:48:30,639 - INFO - å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨å·²åœæ­¢
2025-12-04 08:48:30,639 - INFO - å®šæ—¶ä»»åŠ¡å·²åœç”¨
2025-12-04 08:48:30,640 - INFO - 127.0.0.1 - - [04/Dec/2025 08:48:30] "POST /api/schedule/update HTTP/1.1" 200 -
2025-12-04 08:53:20,564 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-04 08:53:20,564 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-04 08:53:20,565 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-04 08:53:20,565 - INFO - 127.0.0.1 - - [04/Dec/2025 08:53:20] "GET /api/reports/daily/2025-12-03 HTTP/1.1" 200 -
2025-12-04 09:05:23,912 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-04 09:05:23,912 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-04 09:05:23,912 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-04 09:05:23,913 - INFO - 127.0.0.1 - - [04/Dec/2025 09:05:23] "GET /api/reports/daily/2025-12-03 HTTP/1.1" 200 -
2025-12-04 09:05:31,763 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-04 09:05:31,763 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-04 09:05:31,764 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-04 09:05:31,764 - INFO - 127.0.0.1 - - [04/Dec/2025 09:05:31] "GET /api/reports/daily/2025-12-02 HTTP/1.1" 200 -
2025-12-04 09:05:42,784 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-03, ç¯å¢ƒ: test
2025-12-04 09:05:42,784 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-04 09:05:42,784 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-04 09:05:42,785 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-04 09:05:42,785 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-04 09:05:42,793 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-04 09:05:42,794 - INFO - generate_report function called
2025-12-04 09:05:42,794 - INFO - report_data: {('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 36, ('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 28, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 25, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 22, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 22, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 15, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 11, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1}
2025-12-04 09:05:42,794 - INFO - report_date: 2025-12-03
2025-12-04 09:05:42,794 - INFO - total_operations: 160
2025-12-04 09:05:42,794 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-03', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 160', '- **å‚ä¸äººæ•°**: 8', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 20.0', '']
2025-12-04 09:05:42,795 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251203.txt
2025-12-04 09:05:42,795 - INFO - Generating image report...
2025-12-04 09:05:42,796 - INFO - PIL is available.
2025-12-04 09:05:42,881 - INFO - Saving image to file\table_20251203.png
2025-12-04 09:05:42,901 - INFO - Image saved to file\table_20251203.png
2025-12-04 09:05:42,901 - INFO - Saving JPEG version to file\table_20251203.jpg
2025-12-04 09:05:42,904 - INFO - JPEG version saved to file\table_20251203.jpg
2025-12-04 09:05:42,906 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251203.png
2025-12-04 09:05:42,906 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-04 09:05:42,906 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251203.jpg
2025-12-04 09:05:42,906 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-04 09:05:43,332 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764810343194172202073449], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-04 09:05:43,332 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-04 09:05:43,863 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-04 09:05:43,863 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-04 09:05:43,863 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-04 09:05:43,863 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-04 09:05:43,865 - INFO - 127.0.0.1 - - [04/Dec/2025 09:05:43] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-04 09:16:05,344 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-12-04 09:16:05,344 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-12-04 09:16:05,344 - INFO - ä¸Šä¼ ç›®å½•: file
2025-12-04 09:16:05,344 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-12-04 09:16:05,345 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-12-04 09:16:05,356 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-12-04 09:16:05,356 - INFO - [33mPress CTRL+C to quit[0m
2025-12-04 09:17:51,279 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-04 09:17:51,280 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-04 09:17:51,280 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-04 09:17:51,281 - INFO - æ–‡ä»¶å·²ä¿å­˜: file\KF77100064_20251204084446476.zip
2025-12-04 09:17:51,284 - INFO - æ­£åœ¨å¤„ç†æ–‡ä»¶: KF77100064_20251204084446476.zip
2025-12-04 09:17:53,296 - INFO - æ£€æµ‹åˆ°ç¼–ç : GB2312
2025-12-04 09:17:53,297 - INFO - æˆåŠŸä½¿ç”¨ç¼–ç : gbk
2025-12-04 09:17:53,297 - INFO - CSVæ ‡é¢˜: ['æœåŠ¡å', 'å¸å·', 'å§“å', 'æ¨¡å—', 'æ–¹æ³•æè¿°', 'æ“ä½œæ—¶é—´', 'è€—æ—¶', 'è¯·æ±‚url', 'çŠ¶æ€', 'å…¥å‚']
2025-12-04 09:17:53,302 - INFO - æ­£åœ¨ä¿å­˜ 1081 æ¡è®°å½•åˆ°æ•°æ®åº“...
2025-12-04 09:17:53,710 - INFO - æ‰¹é‡æ’å…¥å®Œæˆï¼ŒæˆåŠŸ: 0/1081ï¼Œè·³è¿‡é‡å¤: 1081
2025-12-04 09:17:53,710 - INFO - æ­£åœ¨æ›´æ–°æ—¥æ±‡æ€»: 2025-12-03
2025-12-04 09:17:53,722 - INFO - æ—¥æ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-12-03
2025-12-04 09:17:53,722 - INFO - æ­£åœ¨æ›´æ–°æœˆæ±‡æ€»: 2025-12
2025-12-04 09:17:53,726 - ERROR - æ›´æ–°æœˆæ±‡æ€»å¤±è´¥: UNIQUE constraint failed: monthly_summary.year_month, monthly_summary.account
2025-12-04 09:17:53,726 - INFO - generate_report function called
2025-12-04 09:17:53,726 - INFO - report_data: {('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 11, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 22, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 22, ('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 28, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 15, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 25, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1, ('äºŒç­2ç»„', 'ä½•çµ', 'KF77171520'): 13, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 36}
2025-12-04 09:17:53,726 - INFO - report_date: 2025-12-03
2025-12-04 09:17:53,726 - INFO - total_operations: 173
2025-12-04 09:17:53,726 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-03', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 173', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 19.2', '']
2025-12-04 09:17:53,727 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251203.txt
2025-12-04 09:17:53,727 - INFO - Generating image report...
2025-12-04 09:17:53,727 - INFO - PIL is available.
2025-12-04 09:17:53,782 - INFO - Saving image to file\table_20251203.png
2025-12-04 09:17:53,802 - INFO - Image saved to file\table_20251203.png
2025-12-04 09:17:53,802 - INFO - Saving JPEG version to file\table_20251203.jpg
2025-12-04 09:17:53,806 - INFO - JPEG version saved to file\table_20251203.jpg
2025-12-04 09:17:53,806 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251203.png
2025-12-04 09:17:53,807 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-04 09:17:53,807 - INFO - 127.0.0.1 - - [04/Dec/2025 09:17:53] "POST /api/upload HTTP/1.1" 200 -
2025-12-04 09:17:53,814 - INFO - 127.0.0.1 - - [04/Dec/2025 09:17:53] "GET /api/files HTTP/1.1" 200 -
2025-12-04 09:17:59,277 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-04 09:17:59,277 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-04 09:17:59,278 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-04 09:17:59,278 - INFO - 127.0.0.1 - - [04/Dec/2025 09:17:59] "GET /api/reports/daily/2025-12-03 HTTP/1.1" 200 -
2025-12-04 09:18:08,653 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-12-04 09:18:08,653 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-12-04 09:18:08,654 - INFO - ä¸Šä¼ ç›®å½•: file
2025-12-04 09:18:08,654 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-12-04 09:18:08,656 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-12-04 09:18:08,667 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-12-04 09:18:08,667 - INFO - [33mPress CTRL+C to quit[0m
2025-12-04 09:18:10,933 - INFO - 127.0.0.1 - - [04/Dec/2025 09:18:10] "GET / HTTP/1.1" 200 -
2025-12-04 09:18:10,968 - INFO - 127.0.0.1 - - [04/Dec/2025 09:18:10] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-04 09:18:11,184 - INFO - 127.0.0.1 - - [04/Dec/2025 09:18:11] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-04 09:18:11,516 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-04 09:18:11,516 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-04 09:18:11,516 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-04 09:18:11,517 - INFO - 127.0.0.1 - - [04/Dec/2025 09:18:11] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-04 09:18:11,581 - INFO - 127.0.0.1 - - [04/Dec/2025 09:18:11] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-04 09:18:11,590 - INFO - 127.0.0.1 - - [04/Dec/2025 09:18:11] "GET /api/files HTTP/1.1" 200 -
2025-12-04 09:18:17,531 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-04 09:18:17,532 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-04 09:18:17,533 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-04 09:18:17,533 - INFO - æ–‡ä»¶å·²ä¿å­˜: file\KF77100064_20251204084446476.zip
2025-12-04 09:18:17,535 - INFO - æ­£åœ¨å¤„ç†æ–‡ä»¶: KF77100064_20251204084446476.zip
2025-12-04 09:18:19,685 - INFO - æ£€æµ‹åˆ°ç¼–ç : GB2312
2025-12-04 09:18:19,686 - INFO - æˆåŠŸä½¿ç”¨ç¼–ç : gbk
2025-12-04 09:18:19,686 - INFO - CSVæ ‡é¢˜: ['æœåŠ¡å', 'å¸å·', 'å§“å', 'æ¨¡å—', 'æ–¹æ³•æè¿°', 'æ“ä½œæ—¶é—´', 'è€—æ—¶', 'è¯·æ±‚url', 'çŠ¶æ€', 'å…¥å‚']
2025-12-04 09:18:19,694 - INFO - æ­£åœ¨ä¿å­˜ 1081 æ¡è®°å½•åˆ°æ•°æ®åº“...
2025-12-04 09:18:20,120 - INFO - æ‰¹é‡æ’å…¥å®Œæˆï¼ŒæˆåŠŸ: 0/1081ï¼Œè·³è¿‡é‡å¤: 1081
2025-12-04 09:18:20,120 - INFO - æ­£åœ¨æ›´æ–°æ—¥æ±‡æ€»: 2025-12-03
2025-12-04 09:18:20,132 - INFO - æ—¥æ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-12-03
2025-12-04 09:18:20,133 - INFO - æ­£åœ¨æ›´æ–°æœˆæ±‡æ€»: 2025-12
2025-12-04 09:18:20,146 - INFO - æœˆæ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-12
2025-12-04 09:18:20,146 - INFO - æ•°æ®åº“æŸ¥è¯¢ç»“æœ: æ€»æ¬¡æ•°=160, å‚ä¸äººæ•°=8
2025-12-04 09:18:20,146 - INFO - generate_report function called
2025-12-04 09:18:20,146 - INFO - report_data: {('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 36, ('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 28, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 25, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 22, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 22, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 15, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 11, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1}
2025-12-04 09:18:20,146 - INFO - report_date: 2025-12-03
2025-12-04 09:18:20,146 - INFO - total_operations: 160
2025-12-04 09:18:20,146 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-03', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 160', '- **å‚ä¸äººæ•°**: 8', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 20.0', '']
2025-12-04 09:18:20,147 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251203.txt
2025-12-04 09:18:20,147 - INFO - Generating image report...
2025-12-04 09:18:20,147 - INFO - PIL is available.
2025-12-04 09:18:20,203 - INFO - Saving image to file\table_20251203.png
2025-12-04 09:18:20,246 - INFO - Image saved to file\table_20251203.png
2025-12-04 09:18:20,246 - INFO - Saving JPEG version to file\table_20251203.jpg
2025-12-04 09:18:20,248 - INFO - JPEG version saved to file\table_20251203.jpg
2025-12-04 09:18:20,250 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251203.png
2025-12-04 09:18:20,251 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-04 09:18:20,251 - INFO - 127.0.0.1 - - [04/Dec/2025 09:18:20] "POST /api/upload HTTP/1.1" 200 -
2025-12-04 09:18:20,572 - INFO - 127.0.0.1 - - [04/Dec/2025 09:18:20] "GET /api/files HTTP/1.1" 200 -
2025-12-04 09:18:25,814 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-03, ç¯å¢ƒ: test
2025-12-04 09:18:25,814 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-04 09:18:25,814 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-04 09:18:25,817 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-04 09:18:25,817 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-04 09:18:25,824 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-04 09:18:25,825 - INFO - generate_report function called
2025-12-04 09:18:25,825 - INFO - report_data: {('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 36, ('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 28, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 25, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 22, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 22, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 15, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 11, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1}
2025-12-04 09:18:25,825 - INFO - report_date: 2025-12-03
2025-12-04 09:18:25,825 - INFO - total_operations: 160
2025-12-04 09:18:25,825 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-03', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 160', '- **å‚ä¸äººæ•°**: 8', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 20.0', '']
2025-12-04 09:18:25,826 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251203.txt
2025-12-04 09:18:25,826 - INFO - Generating image report...
2025-12-04 09:18:25,826 - INFO - PIL is available.
2025-12-04 09:18:25,888 - INFO - Saving image to file\table_20251203.png
2025-12-04 09:18:25,912 - INFO - Image saved to file\table_20251203.png
2025-12-04 09:18:25,912 - INFO - Saving JPEG version to file\table_20251203.jpg
2025-12-04 09:18:25,915 - INFO - JPEG version saved to file\table_20251203.jpg
2025-12-04 09:18:25,916 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251203.png
2025-12-04 09:18:25,916 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-04 09:18:25,917 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251203.jpg
2025-12-04 09:18:25,917 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-04 09:18:26,397 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764811106606552670767207], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-04 09:18:26,397 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-04 09:18:26,935 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-04 09:18:26,935 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-04 09:18:26,935 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-04 09:18:26,936 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-04 09:18:26,937 - INFO - 127.0.0.1 - - [04/Dec/2025 09:18:26] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-04 09:18:27,330 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-04 09:18:27,331 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-04 09:18:27,331 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-04 09:18:27,331 - INFO - 127.0.0.1 - - [04/Dec/2025 09:18:27] "[33mGET /api/reports/daily/2025-12-04 HTTP/1.1[0m" 404 -
2025-12-04 09:18:29,936 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-04 09:18:29,936 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-04 09:18:29,937 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-04 09:18:29,937 - INFO - 127.0.0.1 - - [04/Dec/2025 09:18:29] "GET /api/reports/daily/2025-12-03 HTTP/1.1" 200 -
2025-12-04 09:18:48,480 - INFO - å·²åˆ›å»ºå®šæ—¶ä»»åŠ¡: æ¯å¤© 10:00 æ‰§è¡Œ
2025-12-04 09:18:48,481 - INFO - å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨çº¿ç¨‹å·²å¯åŠ¨
2025-12-04 09:18:48,481 - INFO - å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨å·²å¯åŠ¨
2025-12-04 09:18:48,482 - INFO - 127.0.0.1 - - [04/Dec/2025 09:18:48] "POST /api/schedule/update HTTP/1.1" 200 -
2025-12-04 09:25:12,063 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-04 09:25:12,063 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-04 09:25:12,064 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-04 09:25:12,065 - INFO - 127.0.0.1 - - [04/Dec/2025 09:25:12] "GET /api/reports/monthly/2025-12 HTTP/1.1" 200 -
2025-12-04 09:25:25,192 - INFO - 127.0.0.1 - - [04/Dec/2025 09:25:25] "GET /api/files HTTP/1.1" 200 -
2025-12-04 09:25:27,728 - INFO - æ–‡ä»¶å·²åˆ é™¤: KF77100064_20251204084446476.zip
2025-12-04 09:25:27,728 - INFO - 127.0.0.1 - - [04/Dec/2025 09:25:27] "DELETE /api/files/KF77100064_20251204084446476.zip HTTP/1.1" 200 -
2025-12-04 09:25:29,030 - INFO - 127.0.0.1 - - [04/Dec/2025 09:25:29] "GET /api/files HTTP/1.1" 200 -
2025-12-04 09:33:36,707 - INFO - 127.0.0.1 - - [04/Dec/2025 09:33:36] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-12-04 09:33:36,970 - INFO - 127.0.0.1 - - [04/Dec/2025 09:33:36] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-12-04 09:33:37,034 - INFO - 127.0.0.1 - - [04/Dec/2025 09:33:37] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-12-04 09:36:03,381 - INFO - 127.0.0.1 - - [04/Dec/2025 09:36:03] "GET / HTTP/1.1" 200 -
2025-12-04 09:36:03,405 - INFO - 127.0.0.1 - - [04/Dec/2025 09:36:03] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-04 09:36:03,650 - INFO - 127.0.0.1 - - [04/Dec/2025 09:36:03] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-04 09:36:04,015 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-04 09:36:04,016 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-04 09:36:04,017 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-04 09:36:04,017 - INFO - 127.0.0.1 - - [04/Dec/2025 09:36:04] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-04 09:36:04,057 - INFO - 127.0.0.1 - - [04/Dec/2025 09:36:04] "GET /api/files HTTP/1.1" 200 -
2025-12-04 09:36:04,062 - INFO - 127.0.0.1 - - [04/Dec/2025 09:36:04] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-04 10:00:00,856 - INFO - ========== æ‰§è¡Œå®šæ—¶å‘é€ä»»åŠ¡ ==========
2025-12-04 10:00:00,856 - INFO - æŸ¥è¯¢æ—¥æœŸ: 2025-12-03
2025-12-04 10:00:00,857 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-04 10:00:00,857 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-04 10:00:00,858 - INFO - æ‰¾åˆ° 8 æ¡æ•°æ®è®°å½•
2025-12-04 10:00:00,858 - INFO - è·å–åˆ°æœˆç´¯è®¡æ•°æ®: 11 æ¡
2025-12-04 10:00:00,858 - INFO - generate_report function called
2025-12-04 10:00:00,859 - INFO - report_data: {('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 36, ('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 28, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 25, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 22, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 22, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 15, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 11, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1}
2025-12-04 10:00:00,859 - INFO - report_date: 2025-12-03
2025-12-04 10:00:00,859 - INFO - total_operations: 160
2025-12-04 10:00:00,859 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-03', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 160', '- **å‚ä¸äººæ•°**: 8', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 20.0', '']
2025-12-04 10:00:00,861 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251203.txt
2025-12-04 10:00:00,861 - INFO - Generating image report...
2025-12-04 10:00:00,861 - INFO - PIL is available.
2025-12-04 10:00:00,922 - INFO - Saving image to file\table_20251203.png
2025-12-04 10:00:00,944 - INFO - Image saved to file\table_20251203.png
2025-12-04 10:00:00,944 - INFO - Saving JPEG version to file\table_20251203.jpg
2025-12-04 10:00:00,954 - INFO - JPEG version saved to file\table_20251203.jpg
2025-12-04 10:00:00,955 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251203.png
2025-12-04 10:00:00,963 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-04 10:00:00,963 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-04 10:00:00,964 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251203.jpg
2025-12-04 10:00:00,964 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-04 10:00:01,415 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764813601486500497355524], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-04 10:00:01,415 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-04 10:00:01,907 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-04 10:00:01,908 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-04 10:00:01,908 - INFO - âœ“ å®šæ—¶æŠ¥è¡¨å‘é€æˆåŠŸ - æ—¥æœŸ: 2025-12-03, æ€»æ¬¡æ•°: 160
2025-12-04 10:00:01,908 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-05 08:31:18,753 - INFO - 127.0.0.1 - - [05/Dec/2025 08:31:18] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-12-05 08:31:18,872 - INFO - 127.0.0.1 - - [05/Dec/2025 08:31:18] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-12-05 08:39:00,812 - INFO - 127.0.0.1 - - [05/Dec/2025 08:39:00] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-05 08:39:00,812 - INFO - 127.0.0.1 - - [05/Dec/2025 08:39:00] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-05 08:39:01,038 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-05 08:39:01,044 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-05 08:39:01,058 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-05 08:39:01,059 - INFO - 127.0.0.1 - - [05/Dec/2025 08:39:01] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-05 08:39:01,299 - INFO - 127.0.0.1 - - [05/Dec/2025 08:39:01] "GET /api/files HTTP/1.1" 200 -
2025-12-05 08:39:01,347 - INFO - 127.0.0.1 - - [05/Dec/2025 08:39:01] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-05 08:39:10,974 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-05 08:39:10,974 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-05 08:39:10,982 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-05 08:39:10,982 - INFO - 127.0.0.1 - - [05/Dec/2025 08:39:10] "GET /api/reports/daily/2025-12-03 HTTP/1.1" 200 -
2025-12-05 08:39:16,542 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-03, ç¯å¢ƒ: test
2025-12-05 08:39:16,542 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-05 08:39:16,542 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-05 08:39:16,543 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-05 08:39:16,544 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-05 08:39:16,587 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-05 08:39:16,588 - INFO - generate_report function called
2025-12-05 08:39:16,588 - INFO - report_data: {('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 36, ('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 28, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 25, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 22, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 22, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 15, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 11, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1}
2025-12-05 08:39:16,588 - INFO - report_date: 2025-12-03
2025-12-05 08:39:16,589 - INFO - total_operations: 160
2025-12-05 08:39:16,591 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-03', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 160', '- **å‚ä¸äººæ•°**: 8', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 20.0', '']
2025-12-05 08:39:16,592 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251203.txt
2025-12-05 08:39:16,593 - INFO - Generating image report...
2025-12-05 08:39:16,593 - INFO - PIL is available.
2025-12-05 08:39:16,682 - INFO - Saving image to file\table_20251203.png
2025-12-05 08:39:16,706 - INFO - Image saved to file\table_20251203.png
2025-12-05 08:39:16,707 - INFO - Saving JPEG version to file\table_20251203.jpg
2025-12-05 08:39:16,711 - INFO - JPEG version saved to file\table_20251203.jpg
2025-12-05 08:39:16,713 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251203.png
2025-12-05 08:39:16,713 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-05 08:39:16,713 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251203.jpg
2025-12-05 08:39:16,713 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-05 08:39:17,239 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764895157611674183255283], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-05 08:39:17,239 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-05 08:39:17,777 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-05 08:39:17,777 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-05 08:39:17,777 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-05 08:39:17,777 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-05 08:39:17,780 - INFO - 127.0.0.1 - - [05/Dec/2025 08:39:17] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-05 08:52:33,608 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-12-05 08:52:33,608 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-12-05 08:52:33,608 - INFO - ä¸Šä¼ ç›®å½•: file
2025-12-05 08:52:33,608 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-12-05 08:52:33,610 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-12-05 08:52:33,628 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-12-05 08:52:33,628 - INFO - [33mPress CTRL+C to quit[0m
2025-12-05 08:52:39,336 - INFO - 127.0.0.1 - - [05/Dec/2025 08:52:39] "GET / HTTP/1.1" 200 -
2025-12-05 08:52:39,366 - INFO - 127.0.0.1 - - [05/Dec/2025 08:52:39] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-05 08:52:39,607 - INFO - 127.0.0.1 - - [05/Dec/2025 08:52:39] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-05 08:52:39,950 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-05 08:52:39,950 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-05 08:52:39,953 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-05 08:52:39,953 - INFO - 127.0.0.1 - - [05/Dec/2025 08:52:39] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-05 08:52:40,001 - INFO - 127.0.0.1 - - [05/Dec/2025 08:52:40] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-05 08:52:40,013 - INFO - 127.0.0.1 - - [05/Dec/2025 08:52:40] "GET /api/files HTTP/1.1" 200 -
2025-12-05 08:52:43,932 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-03, ç¯å¢ƒ: test
2025-12-05 08:52:43,932 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-05 08:52:43,932 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-05 08:52:43,933 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-05 08:52:43,933 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-05 08:52:43,941 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-05 08:52:43,941 - INFO - generate_report function called
2025-12-05 08:52:43,942 - INFO - report_data: {('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 36, ('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 28, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 25, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 22, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 22, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 15, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 11, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1}
2025-12-05 08:52:43,942 - INFO - report_date: 2025-12-03
2025-12-05 08:52:43,942 - INFO - total_operations: 160
2025-12-05 08:52:43,942 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-03', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 160', '- **å‚ä¸äººæ•°**: 8', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 20.0', '']
2025-12-05 08:52:43,943 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251203.txt
2025-12-05 08:52:43,943 - INFO - Generating image report...
2025-12-05 08:52:43,943 - INFO - PIL is available.
2025-12-05 08:52:44,011 - INFO - Saving image to file\table_20251203.png
2025-12-05 08:52:44,033 - INFO - Image saved to file\table_20251203.png
2025-12-05 08:52:44,033 - INFO - Saving JPEG version to file\table_20251203.jpg
2025-12-05 08:52:44,038 - INFO - JPEG version saved to file\table_20251203.jpg
2025-12-05 08:52:44,039 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251203.png
2025-12-05 08:52:44,039 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-05 08:52:44,039 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251203.jpg
2025-12-05 08:52:44,039 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-05 08:52:44,508 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764895964448151921014611], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-05 08:52:44,508 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-05 08:52:45,004 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-05 08:52:45,004 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-05 08:52:45,004 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-05 08:52:45,005 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-05 08:52:45,006 - INFO - 127.0.0.1 - - [05/Dec/2025 08:52:45] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-05 10:00:00,036 - INFO - ========== æ‰§è¡Œå®šæ—¶å‘é€ä»»åŠ¡ ==========
2025-12-05 10:00:00,047 - INFO - æŸ¥è¯¢æ—¥æœŸ: 2025-12-04
2025-12-05 10:00:00,056 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-05 10:00:00,056 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-05 10:00:00,058 - WARNING - æ²¡æœ‰æ‰¾åˆ° 2025-12-04 çš„æ•°æ®ï¼Œè·³è¿‡å‘é€
2025-12-05 10:00:00,059 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-05 10:14:25,608 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-05 10:14:25,628 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-05 10:14:25,628 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-05 10:14:25,631 - INFO - æ–‡ä»¶å·²ä¿å­˜: file\KF77100064_20251205101341387.zip
2025-12-05 10:14:25,642 - INFO - æ­£åœ¨å¤„ç†æ–‡ä»¶: KF77100064_20251205101341387.zip
2025-12-05 10:14:28,262 - INFO - æ£€æµ‹åˆ°ç¼–ç : GB2312
2025-12-05 10:14:28,263 - INFO - æˆåŠŸä½¿ç”¨ç¼–ç : gbk
2025-12-05 10:14:28,265 - INFO - CSVæ ‡é¢˜: ['æœåŠ¡å', 'å¸å·', 'å§“å', 'æ¨¡å—', 'æ–¹æ³•æè¿°', 'æ“ä½œæ—¶é—´', 'è€—æ—¶', 'è¯·æ±‚url', 'çŠ¶æ€', 'å…¥å‚']
2025-12-05 10:14:28,271 - INFO - æ­£åœ¨ä¿å­˜ 926 æ¡è®°å½•åˆ°æ•°æ®åº“...
2025-12-05 10:14:29,136 - INFO - æ‰¹é‡æ’å…¥å®Œæˆï¼ŒæˆåŠŸ: 925/926ï¼Œè·³è¿‡é‡å¤: 1
2025-12-05 10:14:29,136 - INFO - æ­£åœ¨æ›´æ–°æ—¥æ±‡æ€»: 2025-12-04
2025-12-05 10:14:29,143 - INFO - æ—¥æ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-12-04
2025-12-05 10:14:29,143 - INFO - æ­£åœ¨æ›´æ–°æœˆæ±‡æ€»: 2025-12
2025-12-05 10:14:29,172 - INFO - æœˆæ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-12
2025-12-05 10:14:29,172 - INFO - æ•°æ®åº“æŸ¥è¯¢ç»“æœ: æ€»æ¬¡æ•°=164, å‚ä¸äººæ•°=8
2025-12-05 10:14:29,172 - INFO - generate_report function called
2025-12-05 10:14:29,172 - INFO - report_data: {('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 37, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 29, ('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 26, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 25, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 17, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 17, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 12, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 1}
2025-12-05 10:14:29,172 - INFO - report_date: 2025-12-04
2025-12-05 10:14:29,172 - INFO - total_operations: 164
2025-12-05 10:14:29,172 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-04', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 164', '- **å‚ä¸äººæ•°**: 8', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 20.5', '']
2025-12-05 10:14:29,175 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251204.txt
2025-12-05 10:14:29,175 - INFO - Generating image report...
2025-12-05 10:14:29,175 - INFO - PIL is available.
2025-12-05 10:14:29,257 - INFO - Saving image to file\table_20251204.png
2025-12-05 10:14:29,280 - INFO - Image saved to file\table_20251204.png
2025-12-05 10:14:29,280 - INFO - Saving JPEG version to file\table_20251204.jpg
2025-12-05 10:14:29,284 - INFO - JPEG version saved to file\table_20251204.jpg
2025-12-05 10:14:29,285 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251204.png
2025-12-05 10:14:29,288 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-05 10:14:29,289 - INFO - 127.0.0.1 - - [05/Dec/2025 10:14:29] "POST /api/upload HTTP/1.1" 200 -
2025-12-05 10:14:29,295 - INFO - 127.0.0.1 - - [05/Dec/2025 10:14:29] "GET /api/files HTTP/1.1" 200 -
2025-12-05 10:14:33,680 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-05 10:14:33,680 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-05 10:14:33,681 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-05 10:14:33,681 - INFO - 127.0.0.1 - - [05/Dec/2025 10:14:33] "GET /api/reports/daily/2025-12-04 HTTP/1.1" 200 -
2025-12-05 10:14:43,891 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-04, ç¯å¢ƒ: test
2025-12-05 10:14:43,891 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-05 10:14:43,891 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-05 10:14:43,892 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-05 10:14:43,892 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-05 10:14:43,903 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-05 10:14:43,904 - INFO - generate_report function called
2025-12-05 10:14:43,904 - INFO - report_data: {('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 37, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 29, ('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 26, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 25, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 17, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 17, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 12, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 1}
2025-12-05 10:14:43,904 - INFO - report_date: 2025-12-04
2025-12-05 10:14:43,904 - INFO - total_operations: 164
2025-12-05 10:14:43,904 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-04', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 164', '- **å‚ä¸äººæ•°**: 8', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 20.5', '']
2025-12-05 10:14:43,905 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251204.txt
2025-12-05 10:14:43,905 - INFO - Generating image report...
2025-12-05 10:14:43,905 - INFO - PIL is available.
2025-12-05 10:14:43,983 - INFO - Saving image to file\table_20251204.png
2025-12-05 10:14:44,009 - INFO - Image saved to file\table_20251204.png
2025-12-05 10:14:44,010 - INFO - Saving JPEG version to file\table_20251204.jpg
2025-12-05 10:14:44,013 - INFO - JPEG version saved to file\table_20251204.jpg
2025-12-05 10:14:44,013 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251204.png
2025-12-05 10:14:44,013 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-05 10:14:44,014 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251204.jpg
2025-12-05 10:14:44,014 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-05 10:14:44,507 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764900884611673316129715], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-05 10:14:44,507 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-05 10:14:45,047 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-05 10:14:45,048 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-05 10:14:45,048 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-05 10:14:45,048 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-05 10:14:45,049 - INFO - 127.0.0.1 - - [05/Dec/2025 10:14:45] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-05 10:14:56,934 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-04, ç¯å¢ƒ: prod
2025-12-05 10:14:56,934 - INFO - ç¯å¢ƒ: prod, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=f063326...
2025-12-05 10:14:56,934 - INFO - å‡†å¤‡å‘é€åˆ°ç”Ÿäº§ç¯å¢ƒ
2025-12-05 10:14:56,935 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-05 10:14:56,935 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-05 10:14:56,943 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-05 10:14:56,944 - INFO - generate_report function called
2025-12-05 10:14:56,944 - INFO - report_data: {('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 37, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 29, ('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 26, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 25, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 17, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 17, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 12, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 1}
2025-12-05 10:14:56,944 - INFO - report_date: 2025-12-04
2025-12-05 10:14:56,944 - INFO - total_operations: 164
2025-12-05 10:14:56,944 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-04', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 164', '- **å‚ä¸äººæ•°**: 8', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 20.5', '']
2025-12-05 10:14:56,945 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251204.txt
2025-12-05 10:14:56,945 - INFO - Generating image report...
2025-12-05 10:14:56,946 - INFO - PIL is available.
2025-12-05 10:14:57,012 - INFO - Saving image to file\table_20251204.png
2025-12-05 10:14:57,033 - INFO - Image saved to file\table_20251204.png
2025-12-05 10:14:57,033 - INFO - Saving JPEG version to file\table_20251204.jpg
2025-12-05 10:14:57,037 - INFO - JPEG version saved to file\table_20251204.jpg
2025-12-05 10:14:57,038 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251204.png
2025-12-05 10:14:57,038 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-05 10:14:57,038 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251204.jpg
2025-12-05 10:14:57,038 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-05 10:14:57,504 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764900897182031402762825], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-05 10:14:57,504 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-05 10:14:57,966 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-05 10:14:57,967 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-05 10:14:57,967 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°ç”Ÿäº§ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=f063326...)
2025-12-05 10:14:57,967 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-05 10:14:57,969 - INFO - 127.0.0.1 - - [05/Dec/2025 10:14:57] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-05 12:45:51,410 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-12-05 12:45:51,410 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-12-05 12:45:51,410 - INFO - ä¸Šä¼ ç›®å½•: file
2025-12-05 12:45:51,410 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-12-05 12:45:51,411 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-12-05 12:45:51,436 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-12-05 12:45:51,436 - INFO - [33mPress CTRL+C to quit[0m
2025-12-05 12:45:57,536 - INFO - 127.0.0.1 - - [05/Dec/2025 12:45:57] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-05 12:45:57,574 - INFO - 127.0.0.1 - - [05/Dec/2025 12:45:57] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-05 12:45:58,161 - INFO - 127.0.0.1 - - [05/Dec/2025 12:45:58] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-05 12:45:58,163 - INFO - 127.0.0.1 - - [05/Dec/2025 12:45:58] "GET /api/files HTTP/1.1" 200 -
2025-12-05 12:45:58,179 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-05 12:45:58,179 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-05 12:45:58,183 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-05 12:45:58,183 - INFO - 127.0.0.1 - - [05/Dec/2025 12:45:58] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-05 12:45:58,414 - INFO - 127.0.0.1 - - [05/Dec/2025 12:45:58] "GET / HTTP/1.1" 200 -
2025-12-05 12:45:58,637 - INFO - 127.0.0.1 - - [05/Dec/2025 12:45:58] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-05 12:45:58,762 - INFO - 127.0.0.1 - - [05/Dec/2025 12:45:58] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-05 12:45:58,839 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-05 12:45:58,840 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-05 12:45:58,842 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-05 12:45:58,843 - INFO - 127.0.0.1 - - [05/Dec/2025 12:45:58] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-05 12:45:59,091 - INFO - 127.0.0.1 - - [05/Dec/2025 12:45:59] "GET /api/files HTTP/1.1" 200 -
2025-12-05 12:45:59,133 - INFO - 127.0.0.1 - - [05/Dec/2025 12:45:59] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-05 12:46:01,853 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-05 12:46:01,854 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-05 12:46:01,855 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-05 12:46:01,855 - INFO - 127.0.0.1 - - [05/Dec/2025 12:46:01] "GET /api/reports/daily/2025-12-03 HTTP/1.1" 200 -
2025-12-05 12:46:07,451 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-03, ç¯å¢ƒ: test
2025-12-05 12:46:07,451 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-05 12:46:07,451 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-05 12:46:07,453 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-05 12:46:07,453 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-05 12:46:07,478 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-05 12:46:07,479 - INFO - generate_report function called
2025-12-05 12:46:07,479 - INFO - report_data: {('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 36, ('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 28, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 25, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 22, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 22, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 15, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 11, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1}
2025-12-05 12:46:07,479 - INFO - report_date: 2025-12-03
2025-12-05 12:46:07,479 - INFO - total_operations: 160
2025-12-05 12:46:07,479 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-03', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 160', '- **å‚ä¸äººæ•°**: 8', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 20.0', '']
2025-12-05 12:46:07,480 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251203.txt
2025-12-05 12:46:07,480 - INFO - Generating image report...
2025-12-05 12:46:07,481 - INFO - PIL is available.
2025-12-05 12:46:07,563 - INFO - Saving image to file\table_20251203.png
2025-12-05 12:46:07,586 - INFO - Image saved to file\table_20251203.png
2025-12-05 12:46:07,586 - INFO - Saving JPEG version to file\table_20251203.jpg
2025-12-05 12:46:07,589 - INFO - JPEG version saved to file\table_20251203.jpg
2025-12-05 12:46:07,590 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251203.png
2025-12-05 12:46:07,590 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-05 12:46:07,590 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251203.jpg
2025-12-05 12:46:07,590 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-05 12:46:08,116 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764909968617343266609978], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-05 12:46:08,116 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-05 12:46:08,611 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-05 12:46:08,611 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-05 12:46:08,612 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-05 12:46:08,612 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-05 12:46:08,613 - INFO - 127.0.0.1 - - [05/Dec/2025 12:46:08] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-05 12:46:59,512 - INFO - 127.0.0.1 - - [05/Dec/2025 12:46:59] "GET / HTTP/1.1" 200 -
2025-12-05 12:46:59,547 - INFO - 127.0.0.1 - - [05/Dec/2025 12:46:59] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-05 12:46:59,769 - INFO - 127.0.0.1 - - [05/Dec/2025 12:46:59] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-05 12:47:00,118 - INFO - 127.0.0.1 - - [05/Dec/2025 12:47:00] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-05 12:47:00,118 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-05 12:47:00,118 - INFO - 127.0.0.1 - - [05/Dec/2025 12:47:00] "GET /api/files HTTP/1.1" 200 -
2025-12-05 12:47:00,119 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-05 12:47:00,120 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-05 12:47:00,121 - INFO - 127.0.0.1 - - [05/Dec/2025 12:47:00] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-05 12:47:05,626 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-02, ç¯å¢ƒ: test
2025-12-05 12:47:05,626 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-05 12:47:05,626 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-05 12:47:05,627 - INFO - æ•°æ®åº“è¿æ¥å·²å»ºç«‹ï¼Œå¯ç”¨ WAL æ¨¡å¼: data/wecom_bot.db
2025-12-05 12:47:05,627 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-05 12:47:05,635 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-05 12:47:05,638 - INFO - generate_report function called
2025-12-05 12:47:05,638 - INFO - report_data: {('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 57, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 37, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 27, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 23, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 18, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 15, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 14, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 11}
2025-12-05 12:47:05,638 - INFO - report_date: 2025-12-02
2025-12-05 12:47:05,638 - INFO - total_operations: 225
2025-12-05 12:47:05,638 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-02', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 225', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 25.0', '']
2025-12-05 12:47:05,638 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251202.txt
2025-12-05 12:47:05,639 - INFO - Generating image report...
2025-12-05 12:47:05,639 - INFO - PIL is available.
2025-12-05 12:47:05,716 - INFO - Saving image to file\table_20251202.png
2025-12-05 12:47:05,759 - INFO - Image saved to file\table_20251202.png
2025-12-05 12:47:05,759 - INFO - Saving JPEG version to file\table_20251202.jpg
2025-12-05 12:47:05,763 - INFO - JPEG version saved to file\table_20251202.jpg
2025-12-05 12:47:05,766 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251202.png
2025-12-05 12:47:05,766 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-05 12:47:05,767 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251202.jpg
2025-12-05 12:47:05,767 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-05 12:47:06,247 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764910026617232011010062], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-05 12:47:06,247 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-05 12:47:06,792 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-05 12:47:06,793 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-05 12:47:06,793 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-05 12:47:06,793 - INFO - æ•°æ®åº“è¿æ¥å·²å…³é—­
2025-12-05 12:47:06,794 - INFO - 127.0.0.1 - - [05/Dec/2025 12:47:06] "POST /api/send-to-wecom HTTP/1.1" 200 -
