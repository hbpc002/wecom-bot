2025-11-29 19:17:43,455 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-11-29 19:17:43,463 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-11-29 19:17:43,463 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-11-29 19:17:43,463 - INFO - ä¸Šä¼ ç›®å½•: file
2025-11-29 19:17:43,480 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-11-29 19:17:43,480 - INFO - [33mPress CTRL+C to quit[0m
2025-11-29 19:17:49,788 - INFO - 127.0.0.1 - - [29/Nov/2025 19:17:49] "GET / HTTP/1.1" 200 -
2025-11-29 19:17:49,809 - INFO - 127.0.0.1 - - [29/Nov/2025 19:17:49] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-29 19:17:50,028 - INFO - 127.0.0.1 - - [29/Nov/2025 19:17:50] "GET /static/js/app.js HTTP/1.1" 200 -
2025-11-29 19:17:50,378 - INFO - 127.0.0.1 - - [29/Nov/2025 19:17:50] "GET /api/files HTTP/1.1" 200 -
2025-11-29 19:17:50,379 - INFO - 127.0.0.1 - - [29/Nov/2025 19:17:50] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-29 19:17:54,809 - INFO - 127.0.0.1 - - [29/Nov/2025 19:17:54] "GET /api/reports/daily/2025-11-28 HTTP/1.1" 200 -
2025-11-29 19:18:01,714 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:01] "GET /api/reports/monthly/2025-11 HTTP/1.1" 200 -
2025-11-29 19:18:21,512 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:21] "POST /api/schedule/update HTTP/1.1" 200 -
2025-11-29 19:18:25,704 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:25] "POST /api/schedule/update HTTP/1.1" 200 -
2025-11-29 19:18:27,834 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:27] "POST /api/schedule/update HTTP/1.1" 200 -
2025-11-29 19:18:30,647 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:30] "[32mGET /logout HTTP/1.1[0m" 302 -
2025-11-29 19:18:30,731 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:30] "GET /login HTTP/1.1" 200 -
2025-11-29 19:18:42,820 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:42] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-11-29 19:18:43,018 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:43] "GET / HTTP/1.1" 200 -
2025-11-29 19:18:43,379 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:43] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-29 19:18:43,380 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:43] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-29 19:18:43,636 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:43] "GET /api/files HTTP/1.1" 200 -
2025-11-29 19:18:43,729 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:43] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-29 19:18:52,202 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:52] "GET /api/reports/monthly/2025-11 HTTP/1.1" 200 -
2025-11-29 19:18:54,888 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:54] "[33mGET /api/reports/daily/2025-11-29 HTTP/1.1[0m" 404 -
2025-11-29 19:18:57,911 - INFO - 127.0.0.1 - - [29/Nov/2025 19:18:57] "GET /api/reports/daily/2025-11-28 HTTP/1.1" 200 -
2025-11-29 19:21:42,036 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-29 19:21:42,037 - INFO - generate_report function called
2025-11-29 19:21:42,037 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 33, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 30, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 21, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 19, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 19, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 16, ('äºŒç­2ç»„', 'ä½•çµ', 'KF77171520'): 10, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 2, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 1, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1}
2025-11-29 19:21:42,037 - INFO - report_date: 2025-11-28
2025-11-29 19:21:42,037 - INFO - total_operations: 207
2025-11-29 19:21:42,037 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-28', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 207', '- **å‚ä¸äººæ•°**: 11', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 18.8', '']
2025-11-29 19:21:42,038 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251128.txt
2025-11-29 19:21:42,038 - INFO - Generating image report...
2025-11-29 19:21:42,038 - INFO - PIL is available.
2025-11-29 19:21:42,110 - INFO - Saving image to file\table_20251128.png
2025-11-29 19:21:42,160 - INFO - Image saved to file\table_20251128.png
2025-11-29 19:21:42,160 - INFO - Saving JPEG version to file\table_20251128.jpg
2025-11-29 19:21:42,166 - INFO - JPEG version saved to file\table_20251128.jpg
2025-11-29 19:21:42,167 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251128.png
2025-11-29 19:21:42,167 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-11-29 19:21:42,167 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251128.jpg
2025-11-29 19:21:42,167 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-11-29 19:21:42,657 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764415304194171406512226], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-11-29 19:21:42,657 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-11-29 19:21:43,216 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-11-29 19:21:43,216 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-11-29 19:21:43,218 - INFO - 127.0.0.1 - - [29/Nov/2025 19:21:43] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-11-29 19:22:46,466 - INFO - 127.0.0.1 - - [29/Nov/2025 19:22:46] "GET / HTTP/1.1" 200 -
2025-11-29 19:22:46,492 - INFO - 127.0.0.1 - - [29/Nov/2025 19:22:46] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-29 19:22:46,734 - INFO - 127.0.0.1 - - [29/Nov/2025 19:22:46] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-29 19:22:47,102 - INFO - 127.0.0.1 - - [29/Nov/2025 19:22:47] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-29 19:22:47,103 - INFO - 127.0.0.1 - - [29/Nov/2025 19:22:47] "GET /api/files HTTP/1.1" 200 -
2025-11-29 19:22:52,386 - INFO - 127.0.0.1 - - [29/Nov/2025 19:22:52] "GET / HTTP/1.1" 200 -
2025-11-29 19:22:52,689 - INFO - 127.0.0.1 - - [29/Nov/2025 19:22:52] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-29 19:22:52,753 - INFO - 127.0.0.1 - - [29/Nov/2025 19:22:52] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-29 19:22:53,076 - INFO - 127.0.0.1 - - [29/Nov/2025 19:22:53] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-29 19:22:53,077 - INFO - 127.0.0.1 - - [29/Nov/2025 19:22:53] "GET /api/files HTTP/1.1" 200 -
2025-11-29 19:23:15,251 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-11-29 19:23:15,258 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-11-29 19:23:15,258 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-11-29 19:23:15,258 - INFO - ä¸Šä¼ ç›®å½•: file
2025-11-29 19:23:15,266 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-11-29 19:23:15,266 - INFO - [33mPress CTRL+C to quit[0m
2025-11-29 19:23:18,381 - INFO - 127.0.0.1 - - [29/Nov/2025 19:23:18] "GET / HTTP/1.1" 200 -
2025-11-29 19:23:18,404 - INFO - 127.0.0.1 - - [29/Nov/2025 19:23:18] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-29 19:23:18,638 - INFO - 127.0.0.1 - - [29/Nov/2025 19:23:18] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-29 19:23:18,970 - INFO - 127.0.0.1 - - [29/Nov/2025 19:23:18] "GET /api/files HTTP/1.1" 200 -
2025-11-29 19:23:18,974 - INFO - 127.0.0.1 - - [29/Nov/2025 19:23:18] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-30 09:48:23,459 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-11-30 09:48:23,466 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-11-30 09:48:23,466 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-11-30 09:48:23,466 - INFO - ä¸Šä¼ ç›®å½•: file
2025-11-30 09:48:23,466 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-11-30 09:48:23,470 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-11-30 09:48:23,485 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-11-30 09:48:23,485 - INFO - [33mPress CTRL+C to quit[0m
2025-11-30 09:48:28,415 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:28] "GET / HTTP/1.1" 200 -
2025-11-30 09:48:28,459 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:28] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-30 09:48:28,683 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:28] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-30 09:48:29,011 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:29] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-30 09:48:29,011 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:29] "GET /api/files HTTP/1.1" 200 -
2025-11-30 09:48:32,871 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:32] "GET / HTTP/1.1" 200 -
2025-11-30 09:48:33,181 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:33] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-30 09:48:33,243 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:33] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-30 09:48:33,580 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:33] "GET /api/files HTTP/1.1" 200 -
2025-11-30 09:48:33,583 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:33] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-30 09:48:39,452 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:39] "GET /api/reports/daily/2025-11-28 HTTP/1.1" 200 -
2025-11-30 09:48:51,383 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 09:48:51,388 - INFO - æ–‡ä»¶å·²ä¿å­˜: file\KF77100064_20251130094732850.zip
2025-11-30 09:48:51,392 - INFO - æ­£åœ¨å¤„ç†æ–‡ä»¶: KF77100064_20251130094732850.zip
2025-11-30 09:48:53,134 - INFO - æ£€æµ‹åˆ°ç¼–ç : GB2312
2025-11-30 09:48:53,137 - INFO - æˆåŠŸä½¿ç”¨ç¼–ç : gbk
2025-11-30 09:48:53,138 - INFO - CSVæ ‡é¢˜: ['æœåŠ¡å', 'å¸å·', 'å§“å', 'æ¨¡å—', 'æ–¹æ³•æè¿°', 'æ“ä½œæ—¶é—´', 'è€—æ—¶', 'è¯·æ±‚url', 'çŠ¶æ€', 'å…¥å‚']
2025-11-30 09:48:53,142 - INFO - æ­£åœ¨ä¿å­˜ 214 æ¡è®°å½•åˆ°æ•°æ®åº“...
2025-11-30 09:48:53,205 - INFO - æ‰¹é‡æ’å…¥å®Œæˆï¼ŒæˆåŠŸ: 214/214ï¼Œè·³è¿‡é‡å¤: 0
2025-11-30 09:48:53,206 - INFO - æ­£åœ¨æ›´æ–°æ—¥æ±‡æ€»: 2025-11-29
2025-11-30 09:48:53,211 - INFO - æ—¥æ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-11-29
2025-11-30 09:48:53,211 - INFO - æ­£åœ¨æ›´æ–°æœˆæ±‡æ€»: 2025-11
2025-11-30 09:48:53,216 - INFO - æœˆæ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-11
2025-11-30 09:48:53,216 - INFO - generate_report function called
2025-11-30 09:48:53,216 - INFO - report_data: {('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11}
2025-11-30 09:48:53,216 - INFO - report_date: 2025-11-29
2025-11-30 09:48:53,216 - INFO - total_operations: 214
2025-11-30 09:48:53,216 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-11-30 09:48:53,218 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-11-30 09:48:53,218 - INFO - Generating image report...
2025-11-30 09:48:53,218 - INFO - PIL is available.
2025-11-30 09:48:53,300 - INFO - Saving image to file\table_20251129.png
2025-11-30 09:48:53,347 - INFO - Image saved to file\table_20251129.png
2025-11-30 09:48:53,347 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-11-30 09:48:53,352 - INFO - JPEG version saved to file\table_20251129.jpg
2025-11-30 09:48:53,353 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-11-30 09:48:53,353 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:53] "POST /api/upload HTTP/1.1" 200 -
2025-11-30 09:48:53,363 - INFO - 127.0.0.1 - - [30/Nov/2025 09:48:53] "GET /api/files HTTP/1.1" 200 -
2025-11-30 09:49:00,618 - INFO - 127.0.0.1 - - [30/Nov/2025 09:49:00] "GET /api/reports/daily/2025-11-29 HTTP/1.1" 200 -
2025-11-30 09:49:10,625 - INFO - 127.0.0.1 - - [30/Nov/2025 09:49:10] "GET /api/files HTTP/1.1" 200 -
2025-11-30 09:49:46,118 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 09:49:46,118 - INFO - generate_report function called
2025-11-30 09:49:46,118 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4}
2025-11-30 09:49:46,118 - INFO - report_date: 2025-11-29
2025-11-30 09:49:46,119 - INFO - total_operations: 214
2025-11-30 09:49:46,119 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-11-30 09:49:46,120 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-11-30 09:49:46,120 - INFO - Generating image report...
2025-11-30 09:49:46,120 - INFO - PIL is available.
2025-11-30 09:49:46,189 - INFO - Saving image to file\table_20251129.png
2025-11-30 09:49:46,209 - INFO - Image saved to file\table_20251129.png
2025-11-30 09:49:46,209 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-11-30 09:49:46,212 - INFO - JPEG version saved to file\table_20251129.jpg
2025-11-30 09:49:46,213 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-11-30 09:49:46,214 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-11-30 09:49:46,214 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251129.jpg
2025-11-30 09:49:46,214 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-11-30 09:49:46,701 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764467388555213340698186], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-11-30 09:49:46,702 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-11-30 09:49:47,232 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-11-30 09:49:47,232 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-11-30 09:49:47,234 - INFO - 127.0.0.1 - - [30/Nov/2025 09:49:47] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-11-30 09:58:08,616 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-11-30 09:58:08,622 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-11-30 09:58:08,622 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-11-30 09:58:08,622 - INFO - ä¸Šä¼ ç›®å½•: file
2025-11-30 09:58:08,622 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-11-30 09:58:08,626 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-11-30 09:58:08,636 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-11-30 09:58:08,636 - INFO - [33mPress CTRL+C to quit[0m
2025-11-30 09:58:23,955 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:23] "GET / HTTP/1.1" 200 -
2025-11-30 09:58:23,985 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:23] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-30 09:58:24,211 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:24] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-30 09:58:24,539 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:24] "GET /api/files HTTP/1.1" 200 -
2025-11-30 09:58:24,542 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:24] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-30 09:58:35,958 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:35] "GET /api/reports/daily/2025-11-29 HTTP/1.1" 200 -
2025-11-30 09:58:49,895 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:49] "POST /api/schedule/update HTTP/1.1" 200 -
2025-11-30 09:58:50,883 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:50] "POST /api/schedule/update HTTP/1.1" 200 -
2025-11-30 09:58:53,396 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:53] "GET / HTTP/1.1" 200 -
2025-11-30 09:58:53,426 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:53] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-30 09:58:53,661 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:53] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-30 09:58:53,983 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:53] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-30 09:58:53,983 - INFO - 127.0.0.1 - - [30/Nov/2025 09:58:53] "GET /api/files HTTP/1.1" 200 -
2025-11-30 10:02:41,072 - INFO - 127.0.0.1 - - [30/Nov/2025 10:02:41] "GET /api/reports/daily/2025-11-29 HTTP/1.1" 200 -
2025-11-30 10:02:46,074 - INFO - 127.0.0.1 - - [30/Nov/2025 10:02:46] "POST /api/schedule/update HTTP/1.1" 200 -
2025-11-30 10:03:11,540 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:03:11,541 - INFO - generate_report function called
2025-11-30 10:03:11,541 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4}
2025-11-30 10:03:11,541 - INFO - report_date: 2025-11-29
2025-11-30 10:03:11,541 - INFO - total_operations: 214
2025-11-30 10:03:11,541 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-11-30 10:03:11,543 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-11-30 10:03:11,543 - INFO - Generating image report...
2025-11-30 10:03:11,543 - INFO - PIL is available.
2025-11-30 10:03:11,605 - INFO - Saving image to file\table_20251129.png
2025-11-30 10:03:11,638 - INFO - Image saved to file\table_20251129.png
2025-11-30 10:03:11,638 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-11-30 10:03:11,640 - INFO - JPEG version saved to file\table_20251129.jpg
2025-11-30 10:03:11,642 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-11-30 10:03:11,642 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-11-30 10:03:11,642 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251129.jpg
2025-11-30 10:03:11,642 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-11-30 10:03:12,115 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764468194358773001248401], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-11-30 10:03:12,115 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-11-30 10:03:12,676 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-11-30 10:03:12,676 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-11-30 10:03:12,678 - INFO - 127.0.0.1 - - [30/Nov/2025 10:03:12] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-11-30 10:10:35,236 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-11-30 10:10:35,242 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-11-30 10:10:35,242 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-11-30 10:10:35,242 - INFO - ä¸Šä¼ ç›®å½•: file
2025-11-30 10:10:35,242 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-11-30 10:10:35,246 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-11-30 10:10:35,369 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-11-30 10:10:35,369 - INFO - [33mPress CTRL+C to quit[0m
2025-11-30 10:11:43,792 - INFO - 127.0.0.1 - - [30/Nov/2025 10:11:43] "GET / HTTP/1.1" 200 -
2025-11-30 10:11:43,830 - INFO - 127.0.0.1 - - [30/Nov/2025 10:11:43] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-30 10:11:44,053 - INFO - 127.0.0.1 - - [30/Nov/2025 10:11:44] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-30 10:11:44,402 - INFO - 127.0.0.1 - - [30/Nov/2025 10:11:44] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-30 10:11:44,408 - INFO - 127.0.0.1 - - [30/Nov/2025 10:11:44] "GET /api/files HTTP/1.1" 200 -
2025-11-30 10:11:46,272 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:11:46,272 - INFO - 127.0.0.1 - - [30/Nov/2025 10:11:46] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-11-30 10:11:52,972 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:11:52,974 - INFO - 127.0.0.1 - - [30/Nov/2025 10:11:52] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-11-30 10:12:00,057 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:12:00,057 - INFO - generate_report function called
2025-11-30 10:12:00,057 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4}
2025-11-30 10:12:00,057 - INFO - report_date: 2025-11-29
2025-11-30 10:12:00,057 - INFO - total_operations: 214
2025-11-30 10:12:00,057 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-11-30 10:12:00,058 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-11-30 10:12:00,058 - INFO - Generating image report...
2025-11-30 10:12:00,058 - INFO - PIL is available.
2025-11-30 10:12:00,120 - INFO - Saving image to file\table_20251129.png
2025-11-30 10:12:00,141 - INFO - Image saved to file\table_20251129.png
2025-11-30 10:12:00,141 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-11-30 10:12:00,144 - INFO - JPEG version saved to file\table_20251129.jpg
2025-11-30 10:12:00,145 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-11-30 10:12:00,145 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-11-30 10:12:00,145 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251129.jpg
2025-11-30 10:12:00,145 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-11-30 10:12:00,594 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764468722396422199803659], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-11-30 10:12:00,594 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-11-30 10:12:01,190 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-11-30 10:12:01,190 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-11-30 10:12:01,191 - INFO - 127.0.0.1 - - [30/Nov/2025 10:12:01] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-11-30 10:13:36,883 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-11-30 10:13:36,888 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-11-30 10:13:36,888 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-11-30 10:13:36,888 - INFO - ä¸Šä¼ ç›®å½•: file
2025-11-30 10:13:36,888 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-11-30 10:13:36,891 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-11-30 10:13:36,903 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-11-30 10:13:36,903 - INFO - [33mPress CTRL+C to quit[0m
2025-11-30 10:14:11,494 - INFO - 127.0.0.1 - - [30/Nov/2025 10:14:11] "GET / HTTP/1.1" 200 -
2025-11-30 10:14:11,522 - INFO - 127.0.0.1 - - [30/Nov/2025 10:14:11] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-30 10:14:11,770 - INFO - 127.0.0.1 - - [30/Nov/2025 10:14:11] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-30 10:14:12,133 - INFO - 127.0.0.1 - - [30/Nov/2025 10:14:12] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-30 10:14:12,133 - INFO - 127.0.0.1 - - [30/Nov/2025 10:14:12] "GET /api/files HTTP/1.1" 200 -
2025-11-30 10:14:20,223 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-29, ç¯å¢ƒ: test
2025-11-30 10:14:20,223 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-29, ç¯å¢ƒ: test
2025-11-30 10:14:20,223 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:14:20,223 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:14:20,224 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:14:20,224 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:14:20,230 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:14:20,232 - INFO - generate_report function called
2025-11-30 10:14:20,232 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4}
2025-11-30 10:14:20,232 - INFO - report_date: 2025-11-29
2025-11-30 10:14:20,232 - INFO - total_operations: 214
2025-11-30 10:14:20,232 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-11-30 10:14:20,233 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-11-30 10:14:20,233 - INFO - Generating image report...
2025-11-30 10:14:20,233 - INFO - PIL is available.
2025-11-30 10:14:20,296 - INFO - Saving image to file\table_20251129.png
2025-11-30 10:14:20,329 - INFO - Image saved to file\table_20251129.png
2025-11-30 10:14:20,329 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-11-30 10:14:20,333 - INFO - JPEG version saved to file\table_20251129.jpg
2025-11-30 10:14:20,334 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-11-30 10:14:20,334 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:14:20,334 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-11-30 10:14:20,334 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251129.jpg
2025-11-30 10:14:20,335 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-11-30 10:14:20,729 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764468862555212648536647], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-11-30 10:14:20,729 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-11-30 10:14:21,271 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-11-30 10:14:21,271 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-11-30 10:14:21,271 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-11-30 10:14:21,273 - INFO - 127.0.0.1 - - [30/Nov/2025 10:14:21] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-11-30 10:17:42,549 - INFO - 127.0.0.1 - - [30/Nov/2025 10:17:42] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-30 10:17:42,554 - INFO - 127.0.0.1 - - [30/Nov/2025 10:17:42] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-30 10:17:50,839 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-29, ç¯å¢ƒ: test
2025-11-30 10:17:50,839 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-29, ç¯å¢ƒ: test
2025-11-30 10:17:50,840 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:17:50,840 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:17:50,840 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:17:50,840 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:17:50,847 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:17:50,848 - INFO - generate_report function called
2025-11-30 10:17:50,848 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4}
2025-11-30 10:17:50,848 - INFO - report_date: 2025-11-29
2025-11-30 10:17:50,848 - INFO - total_operations: 214
2025-11-30 10:17:50,848 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-11-30 10:17:50,849 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-11-30 10:17:50,849 - INFO - Generating image report...
2025-11-30 10:17:50,850 - INFO - PIL is available.
2025-11-30 10:17:50,909 - INFO - Saving image to file\table_20251129.png
2025-11-30 10:17:50,929 - INFO - Image saved to file\table_20251129.png
2025-11-30 10:17:50,930 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-11-30 10:17:50,934 - INFO - JPEG version saved to file\table_20251129.jpg
2025-11-30 10:17:50,934 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-11-30 10:17:50,934 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:17:50,935 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-11-30 10:17:50,935 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251129.jpg
2025-11-30 10:17:50,935 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-11-30 10:17:51,413 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764469073448152479758922], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-11-30 10:17:51,414 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-11-30 10:17:52,011 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-11-30 10:17:52,011 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-11-30 10:17:52,011 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-11-30 10:17:52,013 - INFO - 127.0.0.1 - - [30/Nov/2025 10:17:52] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-11-30 10:19:17,212 - INFO - 127.0.0.1 - - [30/Nov/2025 10:19:17] "GET / HTTP/1.1" 200 -
2025-11-30 10:19:17,267 - INFO - 127.0.0.1 - - [30/Nov/2025 10:19:17] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-30 10:19:17,484 - INFO - 127.0.0.1 - - [30/Nov/2025 10:19:17] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-11-30 10:19:17,571 - INFO - 127.0.0.1 - - [30/Nov/2025 10:19:17] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-30 10:19:17,910 - INFO - 127.0.0.1 - - [30/Nov/2025 10:19:17] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-30 10:19:17,915 - INFO - 127.0.0.1 - - [30/Nov/2025 10:19:17] "GET /api/files HTTP/1.1" 200 -
2025-11-30 10:19:21,221 - INFO - 127.0.0.1 - - [30/Nov/2025 10:19:21] "[33mGET /api/reports/daily/2025-11-30 HTTP/1.1[0m" 404 -
2025-11-30 10:19:25,024 - INFO - 127.0.0.1 - - [30/Nov/2025 10:19:25] "GET /api/reports/daily/2025-11-29 HTTP/1.1" 200 -
2025-11-30 10:19:29,762 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-29, ç¯å¢ƒ: test
2025-11-30 10:19:29,762 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-29, ç¯å¢ƒ: test
2025-11-30 10:19:29,762 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:19:29,762 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:19:29,762 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:19:29,762 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:19:29,769 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:19:29,770 - INFO - generate_report function called
2025-11-30 10:19:29,770 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4}
2025-11-30 10:19:29,770 - INFO - report_date: 2025-11-29
2025-11-30 10:19:29,770 - INFO - total_operations: 214
2025-11-30 10:19:29,770 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-11-30 10:19:29,771 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-11-30 10:19:29,771 - INFO - Generating image report...
2025-11-30 10:19:29,771 - INFO - PIL is available.
2025-11-30 10:19:29,836 - INFO - Saving image to file\table_20251129.png
2025-11-30 10:19:29,857 - INFO - Image saved to file\table_20251129.png
2025-11-30 10:19:29,857 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-11-30 10:19:29,861 - INFO - JPEG version saved to file\table_20251129.jpg
2025-11-30 10:19:29,861 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-11-30 10:19:29,862 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:19:29,862 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-11-30 10:19:29,862 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251129.jpg
2025-11-30 10:19:29,862 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-11-30 10:19:30,328 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764469172427493395517360], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-11-30 10:19:30,328 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-11-30 10:19:30,833 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-11-30 10:19:30,833 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-11-30 10:19:30,834 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-11-30 10:19:30,839 - INFO - 127.0.0.1 - - [30/Nov/2025 10:19:30] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-11-30 10:20:34,987 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:20:34,988 - INFO - å¼€å§‹æ£€æŸ¥å½“å¤©çš„æ–°æ–‡ä»¶...
2025-11-30 10:20:34,988 - INFO - æ‰¾åˆ° 1 ä¸ªå½“å¤©çš„æ–°æ–‡ä»¶: ['KF77100064_20251130094732850.zip']
2025-11-30 10:20:34,988 - INFO - æ­£åœ¨å¤„ç†æ–‡ä»¶: KF77100064_20251130094732850.zip
2025-11-30 10:20:36,631 - INFO - æ£€æµ‹åˆ°ç¼–ç : GB2312
2025-11-30 10:20:36,632 - INFO - æˆåŠŸä½¿ç”¨ç¼–ç : gbk
2025-11-30 10:20:36,632 - INFO - CSVæ ‡é¢˜: ['æœåŠ¡å', 'å¸å·', 'å§“å', 'æ¨¡å—', 'æ–¹æ³•æè¿°', 'æ“ä½œæ—¶é—´', 'è€—æ—¶', 'è¯·æ±‚url', 'çŠ¶æ€', 'å…¥å‚']
2025-11-30 10:20:36,639 - INFO - generate_report function called
2025-11-30 10:20:36,639 - INFO - report_data: {('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11}
2025-11-30 10:20:36,639 - INFO - report_date: 2025-11-29
2025-11-30 10:20:36,639 - INFO - total_operations: 214
2025-11-30 10:20:36,639 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-11-30 10:20:36,641 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-11-30 10:20:36,641 - INFO - Generating image report...
2025-11-30 10:20:36,641 - INFO - PIL is available.
2025-11-30 10:20:36,695 - INFO - Saving image to file\table_20251129.png
2025-11-30 10:20:36,731 - INFO - Image saved to file\table_20251129.png
2025-11-30 10:20:36,731 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-11-30 10:20:36,734 - INFO - JPEG version saved to file\table_20251129.jpg
2025-11-30 10:20:36,735 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-11-30 10:20:36,735 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:20:36,735 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-11-30 10:20:36,735 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251129.jpg
2025-11-30 10:20:36,736 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-11-30 10:20:37,148 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764469239609663190723037], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-11-30 10:20:37,149 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-11-30 10:20:37,728 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-11-30 10:20:37,729 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-11-30 10:20:37,729 - INFO - æ–‡ä»¶ KF77100064_20251130094732850.zip å¤„ç†å®Œæˆå¹¶å‘é€æˆåŠŸ
2025-11-30 10:21:14,226 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:21:14,226 - INFO - å¼€å§‹æ£€æŸ¥å½“å¤©çš„æ–°æ–‡ä»¶...
2025-11-30 10:21:14,226 - INFO - æ‰¾åˆ° 1 ä¸ªå½“å¤©çš„æ–°æ–‡ä»¶: ['KF77100064_20251130094732850.zip']
2025-11-30 10:21:14,226 - INFO - æ­£åœ¨å¤„ç†æ–‡ä»¶: KF77100064_20251130094732850.zip
2025-11-30 10:21:15,859 - INFO - æ£€æµ‹åˆ°ç¼–ç : GB2312
2025-11-30 10:21:15,861 - INFO - æˆåŠŸä½¿ç”¨ç¼–ç : gbk
2025-11-30 10:21:15,861 - INFO - CSVæ ‡é¢˜: ['æœåŠ¡å', 'å¸å·', 'å§“å', 'æ¨¡å—', 'æ–¹æ³•æè¿°', 'æ“ä½œæ—¶é—´', 'è€—æ—¶', 'è¯·æ±‚url', 'çŠ¶æ€', 'å…¥å‚']
2025-11-30 10:21:15,867 - INFO - generate_report function called
2025-11-30 10:21:15,867 - INFO - report_data: {('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11}
2025-11-30 10:21:15,867 - INFO - report_date: 2025-11-29
2025-11-30 10:21:15,867 - INFO - total_operations: 214
2025-11-30 10:21:15,868 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-11-30 10:21:15,869 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-11-30 10:21:15,869 - INFO - Generating image report...
2025-11-30 10:21:15,869 - INFO - PIL is available.
2025-11-30 10:21:15,924 - INFO - Saving image to file\table_20251129.png
2025-11-30 10:21:15,959 - INFO - Image saved to file\table_20251129.png
2025-11-30 10:21:15,960 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-11-30 10:21:15,963 - INFO - JPEG version saved to file\table_20251129.jpg
2025-11-30 10:21:15,963 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-11-30 10:21:15,964 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=f063326...
2025-11-30 10:21:15,964 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-11-30 10:21:15,964 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251129.jpg
2025-11-30 10:21:15,964 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-11-30 10:21:16,402 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764469278560333486777631], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-11-30 10:21:16,402 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-11-30 10:21:16,962 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-11-30 10:21:16,962 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-11-30 10:21:16,962 - INFO - æ–‡ä»¶ KF77100064_20251130094732850.zip å¤„ç†å®Œæˆå¹¶å‘é€æˆåŠŸ
2025-11-30 10:28:27,329 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-11-30 10:28:27,334 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-11-30 10:28:27,334 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-11-30 10:28:27,334 - INFO - ä¸Šä¼ ç›®å½•: file
2025-11-30 10:28:27,334 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-11-30 10:28:27,338 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-11-30 10:28:27,349 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-11-30 10:28:27,349 - INFO - [33mPress CTRL+C to quit[0m
2025-11-30 10:28:30,942 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:30] "GET / HTTP/1.1" 200 -
2025-11-30 10:28:31,013 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:31] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-11-30 10:28:31,200 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:31] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-30 10:28:31,323 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:31] "GET /static/js/app.js HTTP/1.1" 200 -
2025-11-30 10:28:31,669 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:31] "GET /api/files HTTP/1.1" 200 -
2025-11-30 10:28:31,671 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:31] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-30 10:28:44,843 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:44,844 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:44,844 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:44,844 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:44,844 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:44,844 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:44,851 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:28:44,852 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:44] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-11-30 10:28:47,237 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:47,238 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:47,238 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:47,238 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:47,238 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:47,238 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:47,244 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:28:47,244 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:47] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-11-30 10:28:48,145 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:48,145 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:48,145 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:48,145 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:48,145 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:48,145 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:48,152 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:28:48,153 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:48] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-11-30 10:28:49,416 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:49,417 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:49,418 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:49,418 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:49,419 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:49,419 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:49,430 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:28:49,431 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:49] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-11-30 10:28:51,048 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:51,048 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:51,048 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:51,048 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:51,048 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:51,049 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:51,055 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:28:51,056 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:51] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-11-30 10:28:52,120 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:52,120 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:52,120 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:52,121 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:52,121 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:52,121 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:52,127 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:28:52,128 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:52] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-11-30 10:28:52,761 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:52,761 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-11-30 10:28:52,761 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:52,761 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:52,762 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:52,762 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:52,769 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:28:52,770 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:52] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-11-30 10:28:56,757 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-29, ç¯å¢ƒ: test
2025-11-30 10:28:56,757 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-29, ç¯å¢ƒ: test
2025-11-30 10:28:56,758 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:56,758 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:56,758 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:56,759 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:28:56,773 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:28:56,774 - INFO - generate_report function called
2025-11-30 10:28:56,774 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4}
2025-11-30 10:28:56,774 - INFO - report_date: 2025-11-29
2025-11-30 10:28:56,774 - INFO - total_operations: 214
2025-11-30 10:28:56,775 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-11-30 10:28:56,776 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-11-30 10:28:56,776 - INFO - Generating image report...
2025-11-30 10:28:56,777 - INFO - PIL is available.
2025-11-30 10:28:56,839 - INFO - Saving image to file\table_20251129.png
2025-11-30 10:28:56,861 - INFO - Image saved to file\table_20251129.png
2025-11-30 10:28:56,861 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-11-30 10:28:56,865 - INFO - JPEG version saved to file\table_20251129.jpg
2025-11-30 10:28:56,866 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-11-30 10:28:56,866 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:28:56,866 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-11-30 10:28:56,866 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251129.jpg
2025-11-30 10:28:56,866 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-11-30 10:28:57,322 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764469739182031978468384], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-11-30 10:28:57,322 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-11-30 10:28:57,873 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-11-30 10:28:57,873 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-11-30 10:28:57,873 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-11-30 10:28:57,875 - INFO - 127.0.0.1 - - [30/Nov/2025 10:28:57] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-11-30 10:29:10,265 - INFO - 127.0.0.1 - - [30/Nov/2025 10:29:10] "POST /api/schedule/update HTTP/1.1" 200 -
2025-11-30 10:29:28,908 - INFO - 127.0.0.1 - - [30/Nov/2025 10:29:28] "GET /api/reports/daily/2025-11-29 HTTP/1.1" 200 -
2025-11-30 10:29:37,135 - INFO - 127.0.0.1 - - [30/Nov/2025 10:29:37] "GET /api/reports/daily/2025-11-28 HTTP/1.1" 200 -
2025-11-30 10:29:41,849 - INFO - 127.0.0.1 - - [30/Nov/2025 10:29:41] "GET /api/reports/daily/2025-11-28 HTTP/1.1" 200 -
2025-11-30 10:29:44,357 - INFO - 127.0.0.1 - - [30/Nov/2025 10:29:44] "GET /api/reports/daily/2025-11-27 HTTP/1.1" 200 -
2025-11-30 10:29:47,132 - INFO - 127.0.0.1 - - [30/Nov/2025 10:29:47] "GET /api/reports/daily/2025-11-29 HTTP/1.1" 200 -
2025-11-30 10:29:49,983 - INFO - 127.0.0.1 - - [30/Nov/2025 10:29:49] "GET /api/reports/monthly/2025-11 HTTP/1.1" 200 -
2025-11-30 10:30:48,053 - INFO - 127.0.0.1 - - [30/Nov/2025 10:30:48] "GET / HTTP/1.1" 200 -
2025-11-30 10:30:48,083 - INFO - 127.0.0.1 - - [30/Nov/2025 10:30:48] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-30 10:30:48,297 - INFO - 127.0.0.1 - - [30/Nov/2025 10:30:48] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-30 10:30:48,627 - INFO - 127.0.0.1 - - [30/Nov/2025 10:30:48] "GET /api/files HTTP/1.1" 200 -
2025-11-30 10:30:48,658 - INFO - 127.0.0.1 - - [30/Nov/2025 10:30:48] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-30 10:31:04,566 - INFO - 127.0.0.1 - - [30/Nov/2025 10:31:04] "GET /api/files HTTP/1.1" 200 -
2025-11-30 10:31:18,395 - INFO - 127.0.0.1 - - [30/Nov/2025 10:31:18] "GET /api/reports/daily/2025-11-29 HTTP/1.1" 200 -
2025-11-30 10:31:22,733 - INFO - 127.0.0.1 - - [30/Nov/2025 10:31:22] "GET /api/reports/daily/2025-11-18 HTTP/1.1" 200 -
2025-11-30 10:32:13,650 - INFO - 127.0.0.1 - - [30/Nov/2025 10:32:13] "GET / HTTP/1.1" 200 -
2025-11-30 10:32:13,793 - INFO - 127.0.0.1 - - [30/Nov/2025 10:32:13] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-30 10:32:13,917 - INFO - 127.0.0.1 - - [30/Nov/2025 10:32:13] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-30 10:32:14,247 - INFO - 127.0.0.1 - - [30/Nov/2025 10:32:14] "GET /api/files HTTP/1.1" 200 -
2025-11-30 10:32:14,251 - INFO - 127.0.0.1 - - [30/Nov/2025 10:32:14] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-30 10:35:35,259 - INFO - 127.0.0.1 - - [30/Nov/2025 10:35:35] "GET / HTTP/1.1" 200 -
2025-11-30 10:35:35,297 - INFO - 127.0.0.1 - - [30/Nov/2025 10:35:35] "GET /static/css/style.css HTTP/1.1" 200 -
2025-11-30 10:35:35,527 - INFO - 127.0.0.1 - - [30/Nov/2025 10:35:35] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-11-30 10:35:35,919 - INFO - 127.0.0.1 - - [30/Nov/2025 10:35:35] "GET /api/files HTTP/1.1" 200 -
2025-11-30 10:35:35,919 - INFO - 127.0.0.1 - - [30/Nov/2025 10:35:35] "GET /api/schedule/status HTTP/1.1" 200 -
2025-11-30 10:35:52,142 - INFO - 127.0.0.1 - - [30/Nov/2025 10:35:52] "[33mGET /api/reports/daily/2025-11-30 HTTP/1.1[0m" 404 -
2025-11-30 10:35:54,946 - INFO - 127.0.0.1 - - [30/Nov/2025 10:35:54] "GET /api/reports/daily/2025-11-29 HTTP/1.1" 200 -
2025-11-30 10:36:23,150 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-29, ç¯å¢ƒ: test
2025-11-30 10:36:23,150 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-29, ç¯å¢ƒ: test
2025-11-30 10:36:23,151 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:36:23,151 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:36:23,151 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:36:23,151 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-11-30 10:36:23,158 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-11-30 10:36:23,159 - INFO - generate_report function called
2025-11-30 10:36:23,159 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4}
2025-11-30 10:36:23,159 - INFO - report_date: 2025-11-29
2025-11-30 10:36:23,159 - INFO - total_operations: 214
2025-11-30 10:36:23,159 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-11-30 10:36:23,160 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-11-30 10:36:23,160 - INFO - Generating image report...
2025-11-30 10:36:23,161 - INFO - PIL is available.
2025-11-30 10:36:23,223 - INFO - Saving image to file\table_20251129.png
2025-11-30 10:36:23,242 - INFO - Image saved to file\table_20251129.png
2025-11-30 10:36:23,242 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-11-30 10:36:23,245 - INFO - JPEG version saved to file\table_20251129.jpg
2025-11-30 10:36:23,246 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-11-30 10:36:23,246 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-11-30 10:36:23,246 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-11-30 10:36:23,246 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251129.jpg
2025-11-30 10:36:23,247 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-11-30 10:36:23,673 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764470185351091260535290], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-11-30 10:36:23,673 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-11-30 10:36:24,191 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-11-30 10:36:24,191 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-11-30 10:36:24,191 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-11-30 10:36:24,193 - INFO - 127.0.0.1 - - [30/Nov/2025 10:36:24] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-11-30 10:36:38,571 - INFO - 127.0.0.1 - - [30/Nov/2025 10:36:38] "POST /api/schedule/update HTTP/1.1" 200 -
2025-11-30 10:36:49,568 - INFO - 127.0.0.1 - - [30/Nov/2025 10:36:49] "GET /api/reports/monthly/2025-11 HTTP/1.1" 200 -
2025-11-30 10:36:55,931 - INFO - 127.0.0.1 - - [30/Nov/2025 10:36:55] "GET /api/reports/daily/2025-11-29 HTTP/1.1" 200 -
2025-11-30 10:36:58,521 - INFO - 127.0.0.1 - - [30/Nov/2025 10:36:58] "GET /api/reports/daily/2025-11-20 HTTP/1.1" 200 -
2025-11-30 10:39:01,285 - INFO - 127.0.0.1 - - [30/Nov/2025 10:39:01] "GET /api/files HTTP/1.1" 200 -
2025-11-30 10:39:02,529 - INFO - 127.0.0.1 - - [30/Nov/2025 10:39:02] "GET /api/files HTTP/1.1" 200 -
2025-12-01 10:00:02,866 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:00:02,870 - INFO - æ–‡ä»¶å·²ä¿å­˜: file\KF77100064_20251130094732850.zip
2025-12-01 10:00:02,874 - INFO - æ­£åœ¨å¤„ç†æ–‡ä»¶: KF77100064_20251130094732850.zip
2025-12-01 10:00:04,679 - INFO - æ£€æµ‹åˆ°ç¼–ç : GB2312
2025-12-01 10:00:04,681 - INFO - æˆåŠŸä½¿ç”¨ç¼–ç : gbk
2025-12-01 10:00:04,682 - INFO - CSVæ ‡é¢˜: ['æœåŠ¡å', 'å¸å·', 'å§“å', 'æ¨¡å—', 'æ–¹æ³•æè¿°', 'æ“ä½œæ—¶é—´', 'è€—æ—¶', 'è¯·æ±‚url', 'çŠ¶æ€', 'å…¥å‚']
2025-12-01 10:00:04,687 - INFO - æ­£åœ¨ä¿å­˜ 214 æ¡è®°å½•åˆ°æ•°æ®åº“...
2025-12-01 10:00:04,743 - INFO - æ‰¹é‡æ’å…¥å®Œæˆï¼ŒæˆåŠŸ: 0/214ï¼Œè·³è¿‡é‡å¤: 214
2025-12-01 10:00:04,743 - INFO - æ­£åœ¨æ›´æ–°æ—¥æ±‡æ€»: 2025-11-29
2025-12-01 10:00:04,750 - INFO - æ—¥æ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-11-29
2025-12-01 10:00:04,750 - INFO - æ­£åœ¨æ›´æ–°æœˆæ±‡æ€»: 2025-11
2025-12-01 10:00:04,755 - INFO - æœˆæ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-11
2025-12-01 10:00:04,755 - INFO - generate_report function called
2025-12-01 10:00:04,755 - INFO - report_data: {('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11}
2025-12-01 10:00:04,756 - INFO - report_date: 2025-11-29
2025-12-01 10:00:04,756 - INFO - total_operations: 214
2025-12-01 10:00:04,756 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-12-01 10:00:04,756 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-12-01 10:00:04,757 - INFO - Generating image report...
2025-12-01 10:00:04,757 - INFO - PIL is available.
2025-12-01 10:00:04,829 - INFO - Saving image to file\table_20251129.png
2025-12-01 10:00:04,852 - INFO - Image saved to file\table_20251129.png
2025-12-01 10:00:04,852 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-12-01 10:00:04,856 - INFO - JPEG version saved to file\table_20251129.jpg
2025-12-01 10:00:04,856 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-12-01 10:00:04,858 - INFO - 127.0.0.1 - - [01/Dec/2025 10:00:04] "POST /api/upload HTTP/1.1" 200 -
2025-12-01 10:00:04,871 - INFO - 127.0.0.1 - - [01/Dec/2025 10:00:04] "GET /api/files HTTP/1.1" 200 -
2025-12-01 10:00:10,675 - INFO - 127.0.0.1 - - [01/Dec/2025 10:00:10] "[33mGET /api/reports/daily/2025-11-30 HTTP/1.1[0m" 404 -
2025-12-01 10:00:13,975 - INFO - 127.0.0.1 - - [01/Dec/2025 10:00:13] "[33mGET /api/reports/daily/2025-11-30 HTTP/1.1[0m" 404 -
2025-12-01 10:00:16,064 - INFO - 127.0.0.1 - - [01/Dec/2025 10:00:16] "[33mGET /api/reports/daily/2025-11-30 HTTP/1.1[0m" 404 -
2025-12-01 10:00:18,478 - INFO - 127.0.0.1 - - [01/Dec/2025 10:00:18] "[33mGET /api/reports/daily/2025-11-30 HTTP/1.1[0m" 404 -
2025-12-01 10:00:19,655 - INFO - 127.0.0.1 - - [01/Dec/2025 10:00:19] "[33mGET /api/reports/daily/2025-11-30 HTTP/1.1[0m" 404 -
2025-12-01 10:00:20,198 - INFO - 127.0.0.1 - - [01/Dec/2025 10:00:20] "[33mGET /api/reports/daily/2025-11-30 HTTP/1.1[0m" 404 -
2025-12-01 10:00:23,235 - INFO - 127.0.0.1 - - [01/Dec/2025 10:00:23] "[33mGET /api/reports/daily/2025-11-30 HTTP/1.1[0m" 404 -
2025-12-01 10:00:32,695 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-12-01 10:00:32,695 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-12-01 10:00:32,695 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:00:32,695 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:00:32,695 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:00:32,695 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:00:32,703 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:00:32,704 - INFO - 127.0.0.1 - - [01/Dec/2025 10:00:32] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-12-01 10:00:35,568 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-12-01 10:00:35,568 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-12-01 10:00:35,569 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:00:35,569 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:00:35,569 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:00:35,570 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:00:35,593 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:00:35,594 - INFO - 127.0.0.1 - - [01/Dec/2025 10:00:35] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-12-01 10:00:36,734 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-12-01 10:00:36,734 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-12-01 10:00:36,734 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:00:36,734 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:00:36,734 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:00:36,734 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:00:36,741 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:00:36,742 - INFO - 127.0.0.1 - - [01/Dec/2025 10:00:36] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-12-01 10:00:37,980 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-12-01 10:00:37,980 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-12-01 10:00:37,980 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:00:37,980 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:00:37,980 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:00:37,980 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:00:37,986 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:00:37,987 - INFO - 127.0.0.1 - - [01/Dec/2025 10:00:37] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-12-01 10:00:39,262 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-12-01 10:00:39,262 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-12-01 10:00:39,262 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:00:39,263 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:00:39,263 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:00:39,263 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:00:39,269 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:00:39,270 - INFO - 127.0.0.1 - - [01/Dec/2025 10:00:39] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-12-01 10:00:42,219 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-12-01 10:00:42,220 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-12-01 10:00:42,220 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:00:42,220 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:00:42,220 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:00:42,220 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:00:42,226 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:00:42,227 - INFO - 127.0.0.1 - - [01/Dec/2025 10:00:42] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-12-01 10:00:43,888 - INFO - 127.0.0.1 - - [01/Dec/2025 10:00:43] "[33mGET /api/reports/daily/2025-11-30 HTTP/1.1[0m" 404 -
2025-12-01 10:00:53,414 - INFO - 127.0.0.1 - - [01/Dec/2025 10:00:53] "GET / HTTP/1.1" 200 -
2025-12-01 10:00:53,483 - INFO - 127.0.0.1 - - [01/Dec/2025 10:00:53] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-01 10:00:53,651 - INFO - 127.0.0.1 - - [01/Dec/2025 10:00:53] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-01 10:00:53,989 - INFO - 127.0.0.1 - - [01/Dec/2025 10:00:53] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-01 10:00:53,989 - INFO - 127.0.0.1 - - [01/Dec/2025 10:00:53] "GET /api/files HTTP/1.1" 200 -
2025-12-01 10:01:03,041 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:01:03,042 - INFO - æ–‡ä»¶å·²ä¿å­˜: file\KF77100064_20251201095938502.zip
2025-12-01 10:01:03,043 - INFO - æ­£åœ¨å¤„ç†æ–‡ä»¶: KF77100064_20251201095938502.zip
2025-12-01 10:01:05,574 - INFO - æ£€æµ‹åˆ°ç¼–ç : GB2312
2025-12-01 10:01:05,575 - INFO - æˆåŠŸä½¿ç”¨ç¼–ç : gbk
2025-12-01 10:01:05,576 - INFO - CSVæ ‡é¢˜: ['æœåŠ¡å', 'å¸å·', 'å§“å', 'æ¨¡å—', 'æ–¹æ³•æè¿°', 'æ“ä½œæ—¶é—´', 'è€—æ—¶', 'è¯·æ±‚url', 'çŠ¶æ€', 'å…¥å‚']
2025-12-01 10:01:05,582 - INFO - æ­£åœ¨ä¿å­˜ 320 æ¡è®°å½•åˆ°æ•°æ®åº“...
2025-12-01 10:01:05,646 - INFO - æ‰¹é‡æ’å…¥å®Œæˆï¼ŒæˆåŠŸ: 318/320ï¼Œè·³è¿‡é‡å¤: 2
2025-12-01 10:01:05,646 - INFO - æ­£åœ¨æ›´æ–°æ—¥æ±‡æ€»: 2025-11-30
2025-12-01 10:01:05,651 - INFO - æ—¥æ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-11-30
2025-12-01 10:01:05,651 - INFO - æ­£åœ¨æ›´æ–°æœˆæ±‡æ€»: 2025-11
2025-12-01 10:01:05,656 - INFO - æœˆæ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-11
2025-12-01 10:01:05,656 - INFO - generate_report function called
2025-12-01 10:01:05,656 - INFO - report_data: {('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 8, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 27, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 35, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 40, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 24, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 67, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 31, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 31, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 54, ('äºŒç­2ç»„', 'ä½•çµ', 'KF77171520'): 1, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 2}
2025-12-01 10:01:05,656 - INFO - report_date: 2025-11-30
2025-12-01 10:01:05,656 - INFO - total_operations: 320
2025-12-01 10:01:05,657 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-30', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 320', '- **å‚ä¸äººæ•°**: 11', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 29.1', '']
2025-12-01 10:01:05,658 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251130.txt
2025-12-01 10:01:05,658 - INFO - Generating image report...
2025-12-01 10:01:05,658 - INFO - PIL is available.
2025-12-01 10:01:05,724 - INFO - Saving image to file\table_20251130.png
2025-12-01 10:01:05,747 - INFO - Image saved to file\table_20251130.png
2025-12-01 10:01:05,748 - INFO - Saving JPEG version to file\table_20251130.jpg
2025-12-01 10:01:05,752 - INFO - JPEG version saved to file\table_20251130.jpg
2025-12-01 10:01:05,753 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251130.png
2025-12-01 10:01:05,754 - INFO - 127.0.0.1 - - [01/Dec/2025 10:01:05] "POST /api/upload HTTP/1.1" 200 -
2025-12-01 10:01:06,068 - INFO - 127.0.0.1 - - [01/Dec/2025 10:01:06] "GET /api/files HTTP/1.1" 200 -
2025-12-01 10:01:08,041 - INFO - 127.0.0.1 - - [01/Dec/2025 10:01:08] "[33mGET /api/reports/daily/2025-12-01 HTTP/1.1[0m" 404 -
2025-12-01 10:01:12,969 - INFO - 127.0.0.1 - - [01/Dec/2025 10:01:12] "GET /api/reports/daily/2025-11-30 HTTP/1.1" 200 -
2025-12-01 10:01:17,263 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-01 10:01:17,263 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-01 10:01:17,264 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:01:17,264 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:01:17,264 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:01:17,264 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:01:17,270 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:01:17,271 - INFO - 127.0.0.1 - - [01/Dec/2025 10:01:17] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-12-01 10:01:32,674 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-01 10:01:32,674 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-01 10:01:32,674 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:01:32,674 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:01:32,674 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:01:32,674 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:01:32,681 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:01:32,681 - INFO - 127.0.0.1 - - [01/Dec/2025 10:01:32] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-12-01 10:01:36,719 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-12-01 10:01:36,719 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-12-01 10:01:36,719 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:01:36,719 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:01:36,719 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:01:36,719 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:01:36,726 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:01:36,726 - INFO - generate_report function called
2025-12-01 10:01:36,726 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 67, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 52, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 40, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 35, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 31, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 31, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 27, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 24, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 8, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 2, ('äºŒç­2ç»„', 'ä½•çµ', 'KF77171520'): 1}
2025-12-01 10:01:36,727 - INFO - report_date: 2025-11-30
2025-12-01 10:01:36,727 - INFO - total_operations: 318
2025-12-01 10:01:36,727 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-30', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 318', '- **å‚ä¸äººæ•°**: 11', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 28.9', '']
2025-12-01 10:01:36,728 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251130.txt
2025-12-01 10:01:36,728 - INFO - Generating image report...
2025-12-01 10:01:36,728 - INFO - PIL is available.
2025-12-01 10:01:36,801 - INFO - Saving image to file\table_20251130.png
2025-12-01 10:01:36,824 - INFO - Image saved to file\table_20251130.png
2025-12-01 10:01:36,824 - INFO - Saving JPEG version to file\table_20251130.jpg
2025-12-01 10:01:36,827 - INFO - JPEG version saved to file\table_20251130.jpg
2025-12-01 10:01:36,828 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251130.png
2025-12-01 10:01:36,828 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:01:36,828 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-01 10:01:36,828 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251130.jpg
2025-12-01 10:01:36,828 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-01 10:01:37,285 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764554497189712356007237], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-01 10:01:37,285 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-01 10:01:37,931 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-01 10:01:37,931 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-01 10:01:37,931 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-01 10:01:37,933 - INFO - 127.0.0.1 - - [01/Dec/2025 10:01:37] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-01 10:01:50,839 - INFO - 127.0.0.1 - - [01/Dec/2025 10:01:50] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-12-01 10:01:50,839 - INFO - 127.0.0.1 - - [01/Dec/2025 10:01:50] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-01 10:02:24,304 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:02:24,304 - INFO - å¼€å§‹æ£€æŸ¥å½“å¤©çš„æ–°æ–‡ä»¶...
2025-12-01 10:02:24,304 - INFO - æ‰¾åˆ° 1 ä¸ªå½“å¤©çš„æ–°æ–‡ä»¶: ['KF77100064_20251201095938502.zip']
2025-12-01 10:02:24,304 - INFO - æ­£åœ¨å¤„ç†æ–‡ä»¶: KF77100064_20251201095938502.zip
2025-12-01 10:02:26,851 - INFO - æ£€æµ‹åˆ°ç¼–ç : GB2312
2025-12-01 10:02:26,853 - INFO - æˆåŠŸä½¿ç”¨ç¼–ç : gbk
2025-12-01 10:02:26,854 - INFO - CSVæ ‡é¢˜: ['æœåŠ¡å', 'å¸å·', 'å§“å', 'æ¨¡å—', 'æ–¹æ³•æè¿°', 'æ“ä½œæ—¶é—´', 'è€—æ—¶', 'è¯·æ±‚url', 'çŠ¶æ€', 'å…¥å‚']
2025-12-01 10:02:26,862 - INFO - generate_report function called
2025-12-01 10:02:26,862 - INFO - report_data: {('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 8, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 27, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 35, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 40, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 24, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 67, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 31, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 31, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 54, ('äºŒç­2ç»„', 'ä½•çµ', 'KF77171520'): 1, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 2}
2025-12-01 10:02:26,863 - INFO - report_date: 2025-11-30
2025-12-01 10:02:26,863 - INFO - total_operations: 320
2025-12-01 10:02:26,863 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-30', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 320', '- **å‚ä¸äººæ•°**: 11', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 29.1', '']
2025-12-01 10:02:26,864 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251130.txt
2025-12-01 10:02:26,864 - INFO - Generating image report...
2025-12-01 10:02:26,865 - INFO - PIL is available.
2025-12-01 10:02:26,933 - INFO - Saving image to file\table_20251130.png
2025-12-01 10:02:26,993 - INFO - Image saved to file\table_20251130.png
2025-12-01 10:02:26,993 - INFO - Saving JPEG version to file\table_20251130.jpg
2025-12-01 10:02:26,996 - INFO - JPEG version saved to file\table_20251130.jpg
2025-12-01 10:02:26,998 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251130.png
2025-12-01 10:02:26,998 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:02:26,998 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-01 10:02:26,998 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251130.jpg
2025-12-01 10:02:26,998 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-01 10:02:27,521 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764554547196733393050897], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-01 10:02:27,521 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-01 10:02:28,096 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-01 10:02:28,096 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-01 10:02:28,096 - INFO - æ–‡ä»¶ KF77100064_20251201095938502.zip å¤„ç†å®Œæˆå¹¶å‘é€æˆåŠŸ
2025-12-01 10:02:45,321 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:02:45,321 - INFO - å¼€å§‹æ£€æŸ¥å½“å¤©çš„æ–°æ–‡ä»¶...
2025-12-01 10:02:45,321 - INFO - æ‰¾åˆ° 1 ä¸ªå½“å¤©çš„æ–°æ–‡ä»¶: ['KF77100064_20251201095938502.zip']
2025-12-01 10:02:45,321 - INFO - æ­£åœ¨å¤„ç†æ–‡ä»¶: KF77100064_20251201095938502.zip
2025-12-01 10:02:47,814 - INFO - æ£€æµ‹åˆ°ç¼–ç : GB2312
2025-12-01 10:02:47,815 - INFO - æˆåŠŸä½¿ç”¨ç¼–ç : gbk
2025-12-01 10:02:47,815 - INFO - CSVæ ‡é¢˜: ['æœåŠ¡å', 'å¸å·', 'å§“å', 'æ¨¡å—', 'æ–¹æ³•æè¿°', 'æ“ä½œæ—¶é—´', 'è€—æ—¶', 'è¯·æ±‚url', 'çŠ¶æ€', 'å…¥å‚']
2025-12-01 10:02:47,823 - INFO - generate_report function called
2025-12-01 10:02:47,823 - INFO - report_data: {('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 8, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 27, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 35, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 40, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 24, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 67, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 31, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 31, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 54, ('äºŒç­2ç»„', 'ä½•çµ', 'KF77171520'): 1, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 2}
2025-12-01 10:02:47,823 - INFO - report_date: 2025-11-30
2025-12-01 10:02:47,823 - INFO - total_operations: 320
2025-12-01 10:02:47,823 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-30', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 320', '- **å‚ä¸äººæ•°**: 11', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 29.1', '']
2025-12-01 10:02:47,824 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251130.txt
2025-12-01 10:02:47,824 - INFO - Generating image report...
2025-12-01 10:02:47,825 - INFO - PIL is available.
2025-12-01 10:02:47,887 - INFO - Saving image to file\table_20251130.png
2025-12-01 10:02:47,927 - INFO - Image saved to file\table_20251130.png
2025-12-01 10:02:47,927 - INFO - Saving JPEG version to file\table_20251130.jpg
2025-12-01 10:02:47,930 - INFO - JPEG version saved to file\table_20251130.jpg
2025-12-01 10:02:47,931 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251130.png
2025-12-01 10:02:47,932 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=f063326...
2025-12-01 10:02:47,932 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-01 10:02:47,932 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251130.jpg
2025-12-01 10:02:47,932 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-01 10:02:48,397 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764554568501862556152928], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-01 10:02:48,398 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-01 10:02:48,944 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-01 10:02:48,945 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-01 10:02:48,945 - INFO - æ–‡ä»¶ KF77100064_20251201095938502.zip å¤„ç†å®Œæˆå¹¶å‘é€æˆåŠŸ
2025-12-01 10:11:23,082 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-12-01 10:11:23,085 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-12-01 10:11:23,089 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:11:23,090 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:11:23,090 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:11:23,090 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:11:23,132 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:11:23,135 - INFO - generate_report function called
2025-12-01 10:11:23,135 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 67, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 52, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 40, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 35, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 31, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 31, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 27, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 24, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 8, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 2, ('äºŒç­2ç»„', 'ä½•çµ', 'KF77171520'): 1}
2025-12-01 10:11:23,135 - INFO - report_date: 2025-11-30
2025-12-01 10:11:23,136 - INFO - total_operations: 318
2025-12-01 10:11:23,140 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-30', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 318', '- **å‚ä¸äººæ•°**: 11', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 28.9', '']
2025-12-01 10:11:23,143 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251130.txt
2025-12-01 10:11:23,144 - INFO - Generating image report...
2025-12-01 10:11:23,144 - INFO - PIL is available.
2025-12-01 10:11:23,280 - INFO - Saving image to file\table_20251130.png
2025-12-01 10:11:23,305 - INFO - Image saved to file\table_20251130.png
2025-12-01 10:11:23,305 - INFO - Saving JPEG version to file\table_20251130.jpg
2025-12-01 10:11:23,309 - INFO - JPEG version saved to file\table_20251130.jpg
2025-12-01 10:11:23,311 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251130.png
2025-12-01 10:11:23,311 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:11:23,312 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-01 10:11:23,312 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251130.jpg
2025-12-01 10:11:23,312 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-01 10:11:23,810 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764555084593752688535685], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-01 10:11:23,811 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-01 10:11:24,400 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-01 10:11:24,400 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-01 10:11:24,401 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-01 10:11:24,409 - INFO - 127.0.0.1 - - [01/Dec/2025 10:11:24] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-01 10:13:38,901 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-12-01 10:13:38,901 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-12-01 10:13:38,901 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:13:38,901 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:13:38,901 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:13:38,901 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:13:38,908 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:13:38,908 - INFO - generate_report function called
2025-12-01 10:13:38,908 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 67, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 52, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 40, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 35, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 31, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 31, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 27, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 24, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 8, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 2, ('äºŒç­2ç»„', 'ä½•çµ', 'KF77171520'): 1}
2025-12-01 10:13:38,908 - INFO - report_date: 2025-11-30
2025-12-01 10:13:38,908 - INFO - total_operations: 318
2025-12-01 10:13:38,908 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-30', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 318', '- **å‚ä¸äººæ•°**: 11', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 28.9', '']
2025-12-01 10:13:38,913 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251130.txt
2025-12-01 10:13:38,913 - INFO - Generating image report...
2025-12-01 10:13:38,913 - INFO - PIL is available.
2025-12-01 10:13:38,999 - INFO - Saving image to file\table_20251130.png
2025-12-01 10:13:39,024 - INFO - Image saved to file\table_20251130.png
2025-12-01 10:13:39,024 - INFO - Saving JPEG version to file\table_20251130.jpg
2025-12-01 10:13:39,028 - INFO - JPEG version saved to file\table_20251130.jpg
2025-12-01 10:13:39,028 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251130.png
2025-12-01 10:13:39,028 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:13:39,028 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-01 10:13:39,029 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251130.jpg
2025-12-01 10:13:39,029 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-01 10:13:39,495 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764555219445411494405956], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-01 10:13:39,496 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-01 10:13:40,082 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-01 10:13:40,082 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-01 10:13:40,082 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-01 10:13:40,084 - INFO - 127.0.0.1 - - [01/Dec/2025 10:13:40] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-01 10:13:47,162 - INFO - 127.0.0.1 - - [01/Dec/2025 10:13:47] "GET / HTTP/1.1" 200 -
2025-12-01 10:13:47,477 - INFO - 127.0.0.1 - - [01/Dec/2025 10:13:47] "GET /static/css/style.css HTTP/1.1" 200 -
2025-12-01 10:13:47,558 - INFO - 127.0.0.1 - - [01/Dec/2025 10:13:47] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-12-01 10:13:47,559 - INFO - 127.0.0.1 - - [01/Dec/2025 10:13:47] "GET /static/js/app.js HTTP/1.1" 200 -
2025-12-01 10:13:47,914 - INFO - 127.0.0.1 - - [01/Dec/2025 10:13:47] "GET /api/files HTTP/1.1" 200 -
2025-12-01 10:13:47,929 - INFO - 127.0.0.1 - - [01/Dec/2025 10:13:47] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-01 10:13:50,279 - INFO - 127.0.0.1 - - [01/Dec/2025 10:13:50] "[33mGET /api/reports/daily/2025-12-01 HTTP/1.1[0m" 404 -
2025-12-01 10:14:00,171 - INFO - 127.0.0.1 - - [01/Dec/2025 10:14:00] "GET /api/reports/daily/2025-11-29 HTTP/1.1" 200 -
2025-12-01 10:14:04,376 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-01 10:14:04,376 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-01 10:14:04,376 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:14:04,376 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:14:04,377 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:14:04,377 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:14:04,386 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:14:04,387 - INFO - 127.0.0.1 - - [01/Dec/2025 10:14:04] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-12-01 10:14:07,463 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-01 10:14:07,463 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-01 10:14:07,463 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:14:07,463 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:14:07,463 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:14:07,464 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:14:07,471 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:14:07,472 - INFO - 127.0.0.1 - - [01/Dec/2025 10:14:07] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-12-01 10:14:12,514 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-29, ç¯å¢ƒ: test
2025-12-01 10:14:12,514 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-29, ç¯å¢ƒ: test
2025-12-01 10:14:12,514 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:14:12,514 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:14:12,514 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:14:12,514 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:14:12,521 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:14:12,522 - INFO - generate_report function called
2025-12-01 10:14:12,522 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4}
2025-12-01 10:14:12,522 - INFO - report_date: 2025-11-29
2025-12-01 10:14:12,523 - INFO - total_operations: 214
2025-12-01 10:14:12,523 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-12-01 10:14:12,524 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-12-01 10:14:12,524 - INFO - Generating image report...
2025-12-01 10:14:12,525 - INFO - PIL is available.
2025-12-01 10:14:12,595 - INFO - Saving image to file\table_20251129.png
2025-12-01 10:14:12,617 - INFO - Image saved to file\table_20251129.png
2025-12-01 10:14:12,617 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-12-01 10:14:12,620 - INFO - JPEG version saved to file\table_20251129.jpg
2025-12-01 10:14:12,621 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-12-01 10:14:12,621 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:14:12,621 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-01 10:14:12,621 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251129.jpg
2025-12-01 10:14:12,621 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-01 10:14:13,099 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764555253596311253588541], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-01 10:14:13,100 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-01 10:14:13,664 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-01 10:14:13,665 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-01 10:14:13,665 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-01 10:14:13,667 - INFO - 127.0.0.1 - - [01/Dec/2025 10:14:13] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-01 10:14:26,532 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-29, ç¯å¢ƒ: test
2025-12-01 10:14:26,532 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-29, ç¯å¢ƒ: test
2025-12-01 10:14:26,532 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:14:26,532 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:14:26,533 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:14:26,533 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:14:26,540 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:14:26,540 - INFO - generate_report function called
2025-12-01 10:14:26,540 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4}
2025-12-01 10:14:26,540 - INFO - report_date: 2025-11-29
2025-12-01 10:14:26,540 - INFO - total_operations: 214
2025-12-01 10:14:26,540 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-12-01 10:14:26,542 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-12-01 10:14:26,542 - INFO - Generating image report...
2025-12-01 10:14:26,542 - INFO - PIL is available.
2025-12-01 10:14:26,603 - INFO - Saving image to file\table_20251129.png
2025-12-01 10:14:26,625 - INFO - Image saved to file\table_20251129.png
2025-12-01 10:14:26,625 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-12-01 10:14:26,628 - INFO - JPEG version saved to file\table_20251129.jpg
2025-12-01 10:14:26,629 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-12-01 10:14:26,629 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:14:26,629 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-01 10:14:26,629 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251129.jpg
2025-12-01 10:14:26,629 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-01 10:14:27,080 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764555267427491091950807], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-01 10:14:27,080 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-01 10:14:27,586 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-01 10:14:27,586 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-01 10:14:27,586 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-01 10:14:27,588 - INFO - 127.0.0.1 - - [01/Dec/2025 10:14:27] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-01 10:15:51,898 - INFO - 127.0.0.1 - - [01/Dec/2025 10:15:51] "GET / HTTP/1.1" 200 -
2025-12-01 10:15:51,965 - INFO - 127.0.0.1 - - [01/Dec/2025 10:15:51] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-12-01 10:15:52,161 - INFO - 127.0.0.1 - - [01/Dec/2025 10:15:52] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-01 10:15:52,278 - INFO - 127.0.0.1 - - [01/Dec/2025 10:15:52] "GET /static/js/app.js HTTP/1.1" 200 -
2025-12-01 10:15:52,609 - INFO - 127.0.0.1 - - [01/Dec/2025 10:15:52] "GET /api/files HTTP/1.1" 200 -
2025-12-01 10:15:52,613 - INFO - 127.0.0.1 - - [01/Dec/2025 10:15:52] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-01 10:15:57,367 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-12-01 10:15:57,367 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-12-01 10:15:57,367 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:15:57,367 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:15:57,367 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:15:57,367 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:15:57,374 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:15:57,375 - INFO - generate_report function called
2025-12-01 10:15:57,375 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 67, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 52, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 40, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 35, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 31, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 31, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 27, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 24, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 8, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 2, ('äºŒç­2ç»„', 'ä½•çµ', 'KF77171520'): 1}
2025-12-01 10:15:57,375 - INFO - report_date: 2025-11-30
2025-12-01 10:15:57,375 - INFO - total_operations: 318
2025-12-01 10:15:57,375 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-30', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 318', '- **å‚ä¸äººæ•°**: 11', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 28.9', '']
2025-12-01 10:15:57,376 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251130.txt
2025-12-01 10:15:57,377 - INFO - Generating image report...
2025-12-01 10:15:57,377 - INFO - PIL is available.
2025-12-01 10:15:57,452 - INFO - Saving image to file\table_20251130.png
2025-12-01 10:15:57,475 - INFO - Image saved to file\table_20251130.png
2025-12-01 10:15:57,476 - INFO - Saving JPEG version to file\table_20251130.jpg
2025-12-01 10:15:57,479 - INFO - JPEG version saved to file\table_20251130.jpg
2025-12-01 10:15:57,480 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251130.png
2025-12-01 10:15:57,480 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:15:57,480 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-01 10:15:57,480 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251130.jpg
2025-12-01 10:15:57,480 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-01 10:15:57,982 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764555358184591380166760], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-01 10:15:57,982 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-01 10:15:58,553 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-01 10:15:58,554 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-01 10:15:58,556 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-01 10:15:58,560 - INFO - 127.0.0.1 - - [01/Dec/2025 10:15:58] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-01 10:16:16,455 - INFO - 127.0.0.1 - - [01/Dec/2025 10:16:16] "[33mGET /api/reports/monthly/2025-12 HTTP/1.1[0m" 404 -
2025-12-01 10:16:19,049 - INFO - 127.0.0.1 - - [01/Dec/2025 10:16:19] "GET /api/reports/monthly/2025-11 HTTP/1.1" 200 -
2025-12-01 10:16:27,679 - INFO - 127.0.0.1 - - [01/Dec/2025 10:16:27] "GET /api/reports/monthly/2025-11 HTTP/1.1" 200 -
2025-12-01 10:16:36,570 - INFO - 127.0.0.1 - - [01/Dec/2025 10:16:36] "GET / HTTP/1.1" 200 -
2025-12-01 10:16:36,904 - INFO - 127.0.0.1 - - [01/Dec/2025 10:16:36] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-01 10:16:36,947 - INFO - 127.0.0.1 - - [01/Dec/2025 10:16:36] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-12-01 10:16:36,948 - INFO - 127.0.0.1 - - [01/Dec/2025 10:16:36] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-01 10:16:37,292 - INFO - 127.0.0.1 - - [01/Dec/2025 10:16:37] "GET /api/files HTTP/1.1" 200 -
2025-12-01 10:16:37,313 - INFO - 127.0.0.1 - - [01/Dec/2025 10:16:37] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-01 10:16:40,952 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-01 10:16:40,952 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-01 10:16:40,952 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:16:40,952 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:16:40,952 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:16:40,952 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:16:40,959 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:16:40,960 - INFO - 127.0.0.1 - - [01/Dec/2025 10:16:40] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-12-01 10:16:43,952 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-01 10:16:43,952 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-01 10:16:43,952 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:16:43,952 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:16:43,952 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:16:43,952 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:16:43,958 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:16:43,959 - INFO - 127.0.0.1 - - [01/Dec/2025 10:16:43] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-12-01 10:16:52,367 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-29, ç¯å¢ƒ: test
2025-12-01 10:16:52,367 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-29, ç¯å¢ƒ: test
2025-12-01 10:16:52,367 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:16:52,367 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:16:52,367 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:16:52,368 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:16:52,375 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:16:52,375 - INFO - generate_report function called
2025-12-01 10:16:52,375 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 55, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 33, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 32, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 20, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 18, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 18, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 11, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 4}
2025-12-01 10:16:52,375 - INFO - report_date: 2025-11-29
2025-12-01 10:16:52,375 - INFO - total_operations: 214
2025-12-01 10:16:52,376 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-29', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 214', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.8', '']
2025-12-01 10:16:52,377 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251129.txt
2025-12-01 10:16:52,378 - INFO - Generating image report...
2025-12-01 10:16:52,378 - INFO - PIL is available.
2025-12-01 10:16:52,446 - INFO - Saving image to file\table_20251129.png
2025-12-01 10:16:52,466 - INFO - Image saved to file\table_20251129.png
2025-12-01 10:16:52,466 - INFO - Saving JPEG version to file\table_20251129.jpg
2025-12-01 10:16:52,472 - INFO - JPEG version saved to file\table_20251129.jpg
2025-12-01 10:16:52,473 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251129.png
2025-12-01 10:16:52,473 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:16:52,473 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-01 10:16:52,473 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251129.jpg
2025-12-01 10:16:52,473 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-01 10:16:52,907 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764555413499303951664441], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-01 10:16:52,907 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-01 10:16:53,402 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-01 10:16:53,402 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-01 10:16:53,403 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-01 10:16:53,405 - INFO - 127.0.0.1 - - [01/Dec/2025 10:16:53] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-01 10:17:15,447 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-12-01 10:17:15,447 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-12-01 10:17:15,447 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:17:15,447 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:17:15,447 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:17:15,448 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:17:15,454 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:17:15,455 - INFO - generate_report function called
2025-12-01 10:17:15,455 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 67, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 52, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 40, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 35, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 31, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 31, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 27, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 24, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 8, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 2, ('äºŒç­2ç»„', 'ä½•çµ', 'KF77171520'): 1}
2025-12-01 10:17:15,455 - INFO - report_date: 2025-11-30
2025-12-01 10:17:15,455 - INFO - total_operations: 318
2025-12-01 10:17:15,455 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-30', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 318', '- **å‚ä¸äººæ•°**: 11', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 28.9', '']
2025-12-01 10:17:15,456 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251130.txt
2025-12-01 10:17:15,456 - INFO - Generating image report...
2025-12-01 10:17:15,456 - INFO - PIL is available.
2025-12-01 10:17:15,539 - INFO - Saving image to file\table_20251130.png
2025-12-01 10:17:15,562 - INFO - Image saved to file\table_20251130.png
2025-12-01 10:17:15,562 - INFO - Saving JPEG version to file\table_20251130.jpg
2025-12-01 10:17:15,567 - INFO - JPEG version saved to file\table_20251130.jpg
2025-12-01 10:17:15,568 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251130.png
2025-12-01 10:17:15,568 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:17:15,568 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-01 10:17:15,569 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251130.jpg
2025-12-01 10:17:15,569 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-01 10:17:16,023 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764555436182031128956802], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-01 10:17:16,023 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-01 10:17:16,620 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-01 10:17:16,621 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-01 10:17:16,622 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-01 10:17:16,626 - INFO - 127.0.0.1 - - [01/Dec/2025 10:17:16] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-01 10:17:19,305 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: prod
2025-12-01 10:17:19,305 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: prod
2025-12-01 10:17:19,305 - INFO - ç¯å¢ƒ: prod, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=f063326...
2025-12-01 10:17:19,305 - INFO - å‡†å¤‡å‘é€åˆ°ç”Ÿäº§ç¯å¢ƒ
2025-12-01 10:17:19,306 - INFO - ç¯å¢ƒ: prod, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=f063326...
2025-12-01 10:17:19,306 - INFO - å‡†å¤‡å‘é€åˆ°ç”Ÿäº§ç¯å¢ƒ
2025-12-01 10:17:19,313 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:17:19,314 - INFO - generate_report function called
2025-12-01 10:17:19,314 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 67, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 52, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 40, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 35, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 31, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 31, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 27, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 24, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 8, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 2, ('äºŒç­2ç»„', 'ä½•çµ', 'KF77171520'): 1}
2025-12-01 10:17:19,314 - INFO - report_date: 2025-11-30
2025-12-01 10:17:19,314 - INFO - total_operations: 318
2025-12-01 10:17:19,314 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-30', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 318', '- **å‚ä¸äººæ•°**: 11', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 28.9', '']
2025-12-01 10:17:19,315 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251130.txt
2025-12-01 10:17:19,315 - INFO - Generating image report...
2025-12-01 10:17:19,315 - INFO - PIL is available.
2025-12-01 10:17:19,399 - INFO - Saving image to file\table_20251130.png
2025-12-01 10:17:19,427 - INFO - Image saved to file\table_20251130.png
2025-12-01 10:17:19,428 - INFO - Saving JPEG version to file\table_20251130.jpg
2025-12-01 10:17:19,432 - INFO - JPEG version saved to file\table_20251130.jpg
2025-12-01 10:17:19,433 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251130.png
2025-12-01 10:17:19,433 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=f063326...
2025-12-01 10:17:19,433 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-01 10:17:19,433 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251130.jpg
2025-12-01 10:17:19,433 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-01 10:17:19,908 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764555440499303801615356], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-01 10:17:19,908 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-01 10:17:20,433 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-01 10:17:20,434 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-01 10:17:20,434 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°ç”Ÿäº§ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=f063326...)
2025-12-01 10:17:20,439 - INFO - 127.0.0.1 - - [01/Dec/2025 10:17:20] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-01 10:23:07,809 - INFO - 127.0.0.1 - - [01/Dec/2025 10:23:07] "GET /api/files HTTP/1.1" 200 -
2025-12-01 10:24:00,637 - INFO - 127.0.0.1 - - [01/Dec/2025 10:24:00] "GET / HTTP/1.1" 200 -
2025-12-01 10:24:00,775 - INFO - 127.0.0.1 - - [01/Dec/2025 10:24:00] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-01 10:24:01,101 - INFO - 127.0.0.1 - - [01/Dec/2025 10:24:01] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-01 10:24:01,468 - INFO - 127.0.0.1 - - [01/Dec/2025 10:24:01] "GET /api/files HTTP/1.1" 200 -
2025-12-01 10:24:01,472 - INFO - 127.0.0.1 - - [01/Dec/2025 10:24:01] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-01 10:24:13,827 - INFO - 127.0.0.1 - - [01/Dec/2025 10:24:13] "GET / HTTP/1.1" 200 -
2025-12-01 10:24:14,152 - INFO - 127.0.0.1 - - [01/Dec/2025 10:24:14] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-01 10:24:14,209 - INFO - 127.0.0.1 - - [01/Dec/2025 10:24:14] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-01 10:24:14,589 - INFO - 127.0.0.1 - - [01/Dec/2025 10:24:14] "GET /api/files HTTP/1.1" 200 -
2025-12-01 10:24:14,591 - INFO - 127.0.0.1 - - [01/Dec/2025 10:24:14] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-01 10:25:07,344 - INFO - 127.0.0.1 - - [01/Dec/2025 10:25:07] "GET / HTTP/1.1" 200 -
2025-12-01 10:25:07,686 - INFO - 127.0.0.1 - - [01/Dec/2025 10:25:07] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-01 10:25:07,719 - INFO - 127.0.0.1 - - [01/Dec/2025 10:25:07] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-12-01 10:25:07,721 - INFO - 127.0.0.1 - - [01/Dec/2025 10:25:07] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-01 10:25:08,075 - INFO - 127.0.0.1 - - [01/Dec/2025 10:25:08] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-01 10:25:08,076 - INFO - 127.0.0.1 - - [01/Dec/2025 10:25:08] "GET /api/files HTTP/1.1" 200 -
2025-12-01 10:27:38,608 - INFO - 127.0.0.1 - - [01/Dec/2025 10:27:38] "GET / HTTP/1.1" 200 -
2025-12-01 10:27:38,697 - INFO - 127.0.0.1 - - [01/Dec/2025 10:27:38] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-01 10:27:38,904 - INFO - 127.0.0.1 - - [01/Dec/2025 10:27:38] "GET /static/js/app.js HTTP/1.1" 200 -
2025-12-01 10:27:39,283 - INFO - 127.0.0.1 - - [01/Dec/2025 10:27:39] "GET /api/files HTTP/1.1" 200 -
2025-12-01 10:27:39,287 - INFO - 127.0.0.1 - - [01/Dec/2025 10:27:39] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-01 10:29:26,101 - INFO - 127.0.0.1 - - [01/Dec/2025 10:29:26] "GET / HTTP/1.1" 200 -
2025-12-01 10:29:26,129 - INFO - 127.0.0.1 - - [01/Dec/2025 10:29:26] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-01 10:29:26,369 - INFO - 127.0.0.1 - - [01/Dec/2025 10:29:26] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-01 10:29:26,700 - INFO - 127.0.0.1 - - [01/Dec/2025 10:29:26] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-01 10:29:26,700 - INFO - 127.0.0.1 - - [01/Dec/2025 10:29:26] "GET /api/files HTTP/1.1" 200 -
2025-12-01 10:29:45,783 - INFO - 127.0.0.1 - - [01/Dec/2025 10:29:45] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-01 10:29:46,118 - INFO - 127.0.0.1 - - [01/Dec/2025 10:29:46] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-12-01 10:29:57,546 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-01 10:29:57,553 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-12-01 10:29:57,554 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-12-01 10:29:57,554 - INFO - ä¸Šä¼ ç›®å½•: file
2025-12-01 10:29:57,554 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-12-01 10:29:57,557 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-12-01 10:29:57,573 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-12-01 10:29:57,573 - INFO - [33mPress CTRL+C to quit[0m
2025-12-01 10:29:59,365 - INFO - 127.0.0.1 - - [01/Dec/2025 10:29:59] "GET / HTTP/1.1" 200 -
2025-12-01 10:29:59,667 - INFO - 127.0.0.1 - - [01/Dec/2025 10:29:59] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-01 10:29:59,783 - INFO - 127.0.0.1 - - [01/Dec/2025 10:29:59] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-01 10:29:59,859 - INFO - 127.0.0.1 - - [01/Dec/2025 10:29:59] "GET /api/files HTTP/1.1" 200 -
2025-12-01 10:30:00,133 - INFO - 127.0.0.1 - - [01/Dec/2025 10:30:00] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-01 10:30:00,134 - INFO - 127.0.0.1 - - [01/Dec/2025 10:30:00] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-12-01 10:30:19,916 - INFO - 127.0.0.1 - - [01/Dec/2025 10:30:19] "GET /api/reports/daily/2025-11-29 HTTP/1.1" 200 -
2025-12-01 10:30:33,334 - INFO - 127.0.0.1 - - [01/Dec/2025 10:30:33] "GET /api/reports/daily/2025-11-30 HTTP/1.1" 200 -
2025-12-01 10:30:49,557 - INFO - 127.0.0.1 - - [01/Dec/2025 10:30:49] "GET / HTTP/1.1" 200 -
2025-12-01 10:30:49,614 - INFO - 127.0.0.1 - - [01/Dec/2025 10:30:49] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-12-01 10:30:49,823 - INFO - 127.0.0.1 - - [01/Dec/2025 10:30:49] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-01 10:30:49,929 - INFO - 127.0.0.1 - - [01/Dec/2025 10:30:49] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-01 10:30:50,259 - INFO - 127.0.0.1 - - [01/Dec/2025 10:30:50] "GET /api/files HTTP/1.1" 200 -
2025-12-01 10:30:50,263 - INFO - 127.0.0.1 - - [01/Dec/2025 10:30:50] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-01 10:30:55,696 - INFO - 127.0.0.1 - - [01/Dec/2025 10:30:55] "GET /api/files HTTP/1.1" 200 -
2025-12-01 10:30:56,751 - INFO - 127.0.0.1 - - [01/Dec/2025 10:30:56] "GET /api/files HTTP/1.1" 200 -
2025-12-01 10:31:06,961 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-01 10:31:06,962 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-01 10:31:06,962 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:31:06,962 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:31:06,962 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:31:06,963 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:31:06,969 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:31:06,971 - INFO - 127.0.0.1 - - [01/Dec/2025 10:31:06] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-12-01 10:31:14,108 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-01 10:31:14,108 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-01 10:31:14,108 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:31:14,108 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:31:14,111 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:31:14,111 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:31:14,119 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:31:14,120 - INFO - 127.0.0.1 - - [01/Dec/2025 10:31:14] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-12-01 10:32:15,474 - INFO - 127.0.0.1 - - [01/Dec/2025 10:32:15] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-12-01 10:32:15,840 - INFO - 127.0.0.1 - - [01/Dec/2025 10:32:15] "[32mGET / HTTP/1.1[0m" 302 -
2025-12-01 10:32:15,863 - INFO - 127.0.0.1 - - [01/Dec/2025 10:32:15] "GET /login?next=/ HTTP/1.1" 200 -
2025-12-01 10:32:16,647 - INFO - 127.0.0.1 - - [01/Dec/2025 10:32:16] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-12-01 10:32:24,194 - INFO - 127.0.0.1 - - [01/Dec/2025 10:32:24] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-12-01 10:32:24,360 - INFO - 127.0.0.1 - - [01/Dec/2025 10:32:24] "GET / HTTP/1.1" 200 -
2025-12-01 10:32:24,744 - INFO - 127.0.0.1 - - [01/Dec/2025 10:32:24] "GET /static/css/style.css HTTP/1.1" 200 -
2025-12-01 10:32:24,745 - INFO - 127.0.0.1 - - [01/Dec/2025 10:32:24] "GET /static/js/app.js HTTP/1.1" 200 -
2025-12-01 10:32:25,007 - INFO - 127.0.0.1 - - [01/Dec/2025 10:32:25] "GET /api/files HTTP/1.1" 200 -
2025-12-01 10:32:25,176 - INFO - 127.0.0.1 - - [01/Dec/2025 10:32:25] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-01 10:32:33,154 - INFO - æ–‡ä»¶å·²åˆ é™¤: KF77100064_20251201095938502.zip
2025-12-01 10:32:33,155 - INFO - 127.0.0.1 - - [01/Dec/2025 10:32:33] "DELETE /api/files/KF77100064_20251201095938502.zip HTTP/1.1" 200 -
2025-12-01 10:32:34,543 - INFO - 127.0.0.1 - - [01/Dec/2025 10:32:34] "GET /api/files HTTP/1.1" 200 -
2025-12-01 10:32:36,631 - INFO - æ–‡ä»¶å·²åˆ é™¤: KF77100064_20251130094732850.zip
2025-12-01 10:32:36,633 - INFO - 127.0.0.1 - - [01/Dec/2025 10:32:36] "DELETE /api/files/KF77100064_20251130094732850.zip HTTP/1.1" 200 -
2025-12-01 10:32:37,734 - INFO - 127.0.0.1 - - [01/Dec/2025 10:32:37] "GET /api/files HTTP/1.1" 200 -
2025-12-01 10:32:43,916 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-01 10:32:43,916 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-01 10:32:43,917 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:32:43,917 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:32:43,918 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:32:43,918 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:32:43,973 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:32:43,981 - INFO - 127.0.0.1 - - [01/Dec/2025 10:32:43] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-12-01 10:32:49,874 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-12-01 10:32:49,874 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-11-30, ç¯å¢ƒ: test
2025-12-01 10:32:49,875 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:32:49,875 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:32:49,875 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:32:49,875 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-01 10:32:49,886 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-01 10:32:49,887 - INFO - generate_report function called
2025-12-01 10:32:49,887 - INFO - report_data: {('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 67, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 52, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 40, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 35, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 31, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 31, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 27, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 24, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 8, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 2, ('äºŒç­2ç»„', 'ä½•çµ', 'KF77171520'): 1}
2025-12-01 10:32:49,887 - INFO - report_date: 2025-11-30
2025-12-01 10:32:49,887 - INFO - total_operations: 318
2025-12-01 10:32:49,887 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-11-30', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 318', '- **å‚ä¸äººæ•°**: 11', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 28.9', '']
2025-12-01 10:32:49,888 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251130.txt
2025-12-01 10:32:49,888 - INFO - Generating image report...
2025-12-01 10:32:49,889 - INFO - PIL is available.
2025-12-01 10:32:49,968 - INFO - Saving image to file\table_20251130.png
2025-12-01 10:32:49,999 - INFO - Image saved to file\table_20251130.png
2025-12-01 10:32:49,999 - INFO - Saving JPEG version to file\table_20251130.jpg
2025-12-01 10:32:50,004 - INFO - JPEG version saved to file\table_20251130.jpg
2025-12-01 10:32:50,005 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251130.png
2025-12-01 10:32:50,005 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-01 10:32:50,005 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-01 10:32:50,005 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251130.jpg
2025-12-01 10:32:50,006 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-01 10:32:50,459 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764556370204410124570032], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-01 10:32:50,460 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-01 10:32:51,012 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-01 10:32:51,012 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-01 10:32:51,012 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-01 10:32:51,014 - INFO - 127.0.0.1 - - [01/Dec/2025 10:32:51] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-01 10:32:59,214 - INFO - 127.0.0.1 - - [01/Dec/2025 10:32:59] "GET /api/reports/daily/2025-11-30 HTTP/1.1" 200 -
2025-12-01 10:39:36,528 - INFO - 127.0.0.1 - - [01/Dec/2025 10:39:36] "POST /api/schedule/update HTTP/1.1" 200 -
2025-12-01 10:41:05,516 - INFO - 127.0.0.1 - - [01/Dec/2025 10:41:05] "GET / HTTP/1.1" 200 -
2025-12-01 10:41:05,619 - INFO - 127.0.0.1 - - [01/Dec/2025 10:41:05] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-12-01 10:41:05,787 - INFO - 127.0.0.1 - - [01/Dec/2025 10:41:05] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-01 10:41:05,932 - INFO - 127.0.0.1 - - [01/Dec/2025 10:41:05] "GET /static/js/app.js HTTP/1.1" 200 -
2025-12-01 10:41:06,258 - INFO - 127.0.0.1 - - [01/Dec/2025 10:41:06] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-01 10:41:06,258 - INFO - 127.0.0.1 - - [01/Dec/2025 10:41:06] "GET /api/files HTTP/1.1" 200 -
2025-12-02 09:09:18,988 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-02 09:09:18,994 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-12-02 09:09:18,995 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-12-02 09:09:18,995 - INFO - ä¸Šä¼ ç›®å½•: file
2025-12-02 09:09:18,995 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-12-02 09:09:19,004 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-12-02 09:09:19,020 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-12-02 09:09:19,020 - INFO - [33mPress CTRL+C to quit[0m
2025-12-02 09:09:31,589 - INFO - 127.0.0.1 - - [02/Dec/2025 09:09:31] "GET / HTTP/1.1" 200 -
2025-12-02 09:09:31,676 - INFO - 127.0.0.1 - - [02/Dec/2025 09:09:31] "[33mGET /.well-known/appspecific/com.chrome.devtools.json HTTP/1.1[0m" 404 -
2025-12-02 09:09:31,874 - INFO - 127.0.0.1 - - [02/Dec/2025 09:09:31] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-02 09:09:32,020 - INFO - 127.0.0.1 - - [02/Dec/2025 09:09:32] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-02 09:09:32,384 - INFO - 127.0.0.1 - - [02/Dec/2025 09:09:32] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-02 09:09:32,386 - INFO - 127.0.0.1 - - [02/Dec/2025 09:09:32] "GET /api/files HTTP/1.1" 200 -
2025-12-02 09:09:51,020 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-02 09:09:51,021 - INFO - æ–‡ä»¶å·²ä¿å­˜: file\KF77100064_20251202090432824.zip
2025-12-02 09:09:51,023 - INFO - æ­£åœ¨å¤„ç†æ–‡ä»¶: KF77100064_20251202090432824.zip
2025-12-02 09:09:52,519 - INFO - æ£€æµ‹åˆ°ç¼–ç : GB2312
2025-12-02 09:09:52,520 - INFO - æˆåŠŸä½¿ç”¨ç¼–ç : gbk
2025-12-02 09:09:52,521 - INFO - CSVæ ‡é¢˜: ['æœåŠ¡å', 'å¸å·', 'å§“å', 'æ¨¡å—', 'æ–¹æ³•æè¿°', 'æ“ä½œæ—¶é—´', 'è€—æ—¶', 'è¯·æ±‚url', 'çŠ¶æ€', 'å…¥å‚']
2025-12-02 09:09:52,528 - INFO - æ­£åœ¨ä¿å­˜ 124 æ¡è®°å½•åˆ°æ•°æ®åº“...
2025-12-02 09:09:52,606 - INFO - æ‰¹é‡æ’å…¥å®Œæˆï¼ŒæˆåŠŸ: 124/124ï¼Œè·³è¿‡é‡å¤: 0
2025-12-02 09:09:52,606 - INFO - æ­£åœ¨æ›´æ–°æ—¥æ±‡æ€»: 2025-12-01
2025-12-02 09:09:52,611 - INFO - æ—¥æ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-12-01
2025-12-02 09:09:52,611 - INFO - æ­£åœ¨æ›´æ–°æœˆæ±‡æ€»: 2025-12
2025-12-02 09:09:52,616 - INFO - æœˆæ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-12
2025-12-02 09:09:52,616 - INFO - generate_report function called
2025-12-02 09:09:52,616 - INFO - report_data: {('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 21, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 28, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 21, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 23, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 29, ('ä¸€ç­2ç»„', 'æ¢ä¸ä¸', 'KF77130185'): 1}
2025-12-02 09:09:52,616 - INFO - report_date: 2025-12-01
2025-12-02 09:09:52,616 - INFO - total_operations: 124
2025-12-02 09:09:52,616 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-01', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 124', '- **å‚ä¸äººæ•°**: 7', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 17.7', '']
2025-12-02 09:09:52,617 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251201.txt
2025-12-02 09:09:52,617 - INFO - Generating image report...
2025-12-02 09:09:52,617 - INFO - PIL is available.
2025-12-02 09:09:52,721 - INFO - Saving image to file\table_20251201.png
2025-12-02 09:09:52,769 - INFO - Image saved to file\table_20251201.png
2025-12-02 09:09:52,770 - INFO - Saving JPEG version to file\table_20251201.jpg
2025-12-02 09:09:52,773 - INFO - JPEG version saved to file\table_20251201.jpg
2025-12-02 09:09:52,774 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251201.png
2025-12-02 09:09:52,775 - INFO - 127.0.0.1 - - [02/Dec/2025 09:09:52] "POST /api/upload HTTP/1.1" 200 -
2025-12-02 09:09:52,783 - INFO - 127.0.0.1 - - [02/Dec/2025 09:09:52] "GET /api/files HTTP/1.1" 200 -
2025-12-02 09:10:03,281 - INFO - 127.0.0.1 - - [02/Dec/2025 09:10:03] "[33mGET /api/reports/daily/2025-12-02 HTTP/1.1[0m" 404 -
2025-12-02 09:10:07,060 - INFO - 127.0.0.1 - - [02/Dec/2025 09:10:07] "GET /api/reports/daily/2025-12-01 HTTP/1.1" 200 -
2025-12-02 09:10:14,063 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-02, ç¯å¢ƒ: test
2025-12-02 09:10:14,063 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-02 09:10:14,064 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-02 09:10:14,072 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-02 09:10:14,073 - INFO - 127.0.0.1 - - [02/Dec/2025 09:10:14] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-12-02 09:10:18,787 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-02 09:10:18,787 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-02 09:10:18,787 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-02 09:10:18,795 - INFO - å·²åŠ è½½ 12 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-02 09:10:18,796 - INFO - generate_report function called
2025-12-02 09:10:18,796 - INFO - report_data: {('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 29, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 28, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 23, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 21, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 21, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1, ('ä¸€ç­2ç»„', 'æ¢ä¸ä¸', 'KF77130185'): 1}
2025-12-02 09:10:18,796 - INFO - report_date: 2025-12-01
2025-12-02 09:10:18,796 - INFO - total_operations: 124
2025-12-02 09:10:18,796 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-01', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 124', '- **å‚ä¸äººæ•°**: 7', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 17.7', '']
2025-12-02 09:10:18,798 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251201.txt
2025-12-02 09:10:18,798 - INFO - Generating image report...
2025-12-02 09:10:18,798 - INFO - PIL is available.
2025-12-02 09:10:18,859 - INFO - Saving image to file\table_20251201.png
2025-12-02 09:10:18,877 - INFO - Image saved to file\table_20251201.png
2025-12-02 09:10:18,878 - INFO - Saving JPEG version to file\table_20251201.jpg
2025-12-02 09:10:18,881 - INFO - JPEG version saved to file\table_20251201.jpg
2025-12-02 09:10:18,882 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251201.png
2025-12-02 09:10:18,882 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-02 09:10:18,882 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-02 09:10:18,882 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251201.jpg
2025-12-02 09:10:18,882 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-02 09:10:19,385 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764637820176913737971088], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-02 09:10:19,385 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-02 09:10:19,914 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-02 09:10:19,914 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-02 09:10:19,923 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-02 09:10:19,924 - INFO - 127.0.0.1 - - [02/Dec/2025 09:10:19] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-02 09:11:01,716 - INFO - 127.0.0.1 - - [02/Dec/2025 09:11:01] "GET / HTTP/1.1" 200 -
2025-12-02 09:11:01,854 - INFO - 127.0.0.1 - - [02/Dec/2025 09:11:01] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-02 09:11:01,983 - INFO - 127.0.0.1 - - [02/Dec/2025 09:11:01] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-02 09:11:02,440 - INFO - 127.0.0.1 - - [02/Dec/2025 09:11:02] "GET /api/files HTTP/1.1" 200 -
2025-12-02 09:11:02,440 - INFO - 127.0.0.1 - - [02/Dec/2025 09:11:02] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-02 09:11:07,614 - INFO - æ–‡ä»¶å·²åˆ é™¤: KF77100064_20251202090432824.zip
2025-12-02 09:11:07,615 - INFO - 127.0.0.1 - - [02/Dec/2025 09:11:07] "DELETE /api/files/KF77100064_20251202090432824.zip HTTP/1.1" 200 -
2025-12-02 09:11:09,293 - INFO - 127.0.0.1 - - [02/Dec/2025 09:11:09] "GET /api/files HTTP/1.1" 200 -
2025-12-02 09:11:22,660 - INFO - 127.0.0.1 - - [02/Dec/2025 09:11:22] "POST /api/schedule/update HTTP/1.1" 200 -
2025-12-02 09:13:33,644 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-02 09:13:33,645 - INFO - æ–‡ä»¶å·²ä¿å­˜: file\KF77100064_20251202090432824.zip
2025-12-02 09:13:33,646 - INFO - æ­£åœ¨å¤„ç†æ–‡ä»¶: KF77100064_20251202090432824.zip
2025-12-02 09:13:35,190 - INFO - æ£€æµ‹åˆ°ç¼–ç : GB2312
2025-12-02 09:13:35,190 - INFO - æˆåŠŸä½¿ç”¨ç¼–ç : gbk
2025-12-02 09:13:35,191 - INFO - CSVæ ‡é¢˜: ['æœåŠ¡å', 'å¸å·', 'å§“å', 'æ¨¡å—', 'æ–¹æ³•æè¿°', 'æ“ä½œæ—¶é—´', 'è€—æ—¶', 'è¯·æ±‚url', 'çŠ¶æ€', 'å…¥å‚']
2025-12-02 09:13:35,195 - INFO - æ­£åœ¨ä¿å­˜ 157 æ¡è®°å½•åˆ°æ•°æ®åº“...
2025-12-02 09:13:35,224 - INFO - æ‰¹é‡æ’å…¥å®Œæˆï¼ŒæˆåŠŸ: 33/157ï¼Œè·³è¿‡é‡å¤: 124
2025-12-02 09:13:35,224 - INFO - æ­£åœ¨æ›´æ–°æ—¥æ±‡æ€»: 2025-12-01
2025-12-02 09:13:35,233 - INFO - æ—¥æ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-12-01
2025-12-02 09:13:35,233 - INFO - æ­£åœ¨æ›´æ–°æœˆæ±‡æ€»: 2025-12
2025-12-02 09:13:35,240 - INFO - æœˆæ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-12
2025-12-02 09:13:35,241 - INFO - generate_report function called
2025-12-02 09:13:35,241 - INFO - report_data: {('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 21, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 28, ('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 33, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 21, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 23, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 29, ('ä¸€ç­2ç»„', 'æ¢ä¸ä¸', 'KF77130185'): 1}
2025-12-02 09:13:35,241 - INFO - report_date: 2025-12-01
2025-12-02 09:13:35,241 - INFO - total_operations: 157
2025-12-02 09:13:35,241 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-01', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 157', '- **å‚ä¸äººæ•°**: 8', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 19.6', '']
2025-12-02 09:13:35,241 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251201.txt
2025-12-02 09:13:35,242 - INFO - Generating image report...
2025-12-02 09:13:35,242 - INFO - PIL is available.
2025-12-02 09:13:35,305 - INFO - Saving image to file\table_20251201.png
2025-12-02 09:13:35,323 - INFO - Image saved to file\table_20251201.png
2025-12-02 09:13:35,324 - INFO - Saving JPEG version to file\table_20251201.jpg
2025-12-02 09:13:35,327 - INFO - JPEG version saved to file\table_20251201.jpg
2025-12-02 09:13:35,327 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251201.png
2025-12-02 09:13:35,330 - INFO - 127.0.0.1 - - [02/Dec/2025 09:13:35] "POST /api/upload HTTP/1.1" 200 -
2025-12-02 09:13:35,335 - INFO - 127.0.0.1 - - [02/Dec/2025 09:13:35] "GET /api/files HTTP/1.1" 200 -
2025-12-02 09:13:43,083 - INFO - 127.0.0.1 - - [02/Dec/2025 09:13:43] "GET /api/reports/daily/2025-12-01 HTTP/1.1" 200 -
2025-12-02 09:13:51,395 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-02, ç¯å¢ƒ: test
2025-12-02 09:13:51,395 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-02 09:13:51,395 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-02 09:13:51,404 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-02 09:13:51,404 - INFO - 127.0.0.1 - - [02/Dec/2025 09:13:51] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-12-02 09:13:56,733 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-02 09:13:56,733 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-02 09:13:56,733 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-02 09:13:56,740 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-02 09:13:56,740 - INFO - generate_report function called
2025-12-02 09:13:56,740 - INFO - report_data: {('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 33, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 29, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 28, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 23, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 21, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 21, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1, ('ä¸€ç­2ç»„', 'æ¢ä¸ä¸', 'KF77130185'): 1}
2025-12-02 09:13:56,740 - INFO - report_date: 2025-12-01
2025-12-02 09:13:56,740 - INFO - total_operations: 157
2025-12-02 09:13:56,740 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-01', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 157', '- **å‚ä¸äººæ•°**: 8', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 19.6', '']
2025-12-02 09:13:56,742 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251201.txt
2025-12-02 09:13:56,743 - INFO - Generating image report...
2025-12-02 09:13:56,743 - INFO - PIL is available.
2025-12-02 09:13:56,803 - INFO - Saving image to file\table_20251201.png
2025-12-02 09:13:56,827 - INFO - Image saved to file\table_20251201.png
2025-12-02 09:13:56,828 - INFO - Saving JPEG version to file\table_20251201.jpg
2025-12-02 09:13:56,831 - INFO - JPEG version saved to file\table_20251201.jpg
2025-12-02 09:13:56,831 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251201.png
2025-12-02 09:13:56,832 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-02 09:13:56,832 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-02 09:13:56,832 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251201.jpg
2025-12-02 09:13:56,832 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-02 09:13:57,322 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764638038547531068832718], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-02 09:13:57,323 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-02 09:13:57,868 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-02 09:13:57,869 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-02 09:13:57,869 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-02 09:13:57,875 - INFO - 127.0.0.1 - - [02/Dec/2025 09:13:57] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-02 10:28:52,701 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: prod
2025-12-02 10:28:52,702 - INFO - ç¯å¢ƒ: prod, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=f063326...
2025-12-02 10:28:52,702 - INFO - å‡†å¤‡å‘é€åˆ°ç”Ÿäº§ç¯å¢ƒ
2025-12-02 10:28:52,713 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-02 10:28:52,714 - INFO - generate_report function called
2025-12-02 10:28:52,714 - INFO - report_data: {('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 33, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 29, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 28, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 23, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 21, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 21, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1, ('ä¸€ç­2ç»„', 'æ¢ä¸ä¸', 'KF77130185'): 1}
2025-12-02 10:28:52,714 - INFO - report_date: 2025-12-01
2025-12-02 10:28:52,714 - INFO - total_operations: 157
2025-12-02 10:28:52,714 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-01', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 157', '- **å‚ä¸äººæ•°**: 8', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 19.6', '']
2025-12-02 10:28:52,715 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251201.txt
2025-12-02 10:28:52,716 - INFO - Generating image report...
2025-12-02 10:28:52,716 - INFO - PIL is available.
2025-12-02 10:28:52,779 - INFO - Saving image to file\table_20251201.png
2025-12-02 10:28:52,799 - INFO - Image saved to file\table_20251201.png
2025-12-02 10:28:52,800 - INFO - Saving JPEG version to file\table_20251201.jpg
2025-12-02 10:28:52,803 - INFO - JPEG version saved to file\table_20251201.jpg
2025-12-02 10:28:52,805 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251201.png
2025-12-02 10:28:52,806 - INFO - send_to_wechat ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=f063326...
2025-12-02 10:28:52,806 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-02 10:28:52,806 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251201.jpg
2025-12-02 10:28:52,806 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-02 10:28:53,283 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764642534189714265603074], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-02 10:28:53,283 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-02 10:28:53,799 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-02 10:28:53,799 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-02 10:28:53,799 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°ç”Ÿäº§ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=f063326...)
2025-12-02 10:28:53,800 - INFO - 127.0.0.1 - - [02/Dec/2025 10:28:53] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-02 10:29:14,413 - INFO - 127.0.0.1 - - [02/Dec/2025 10:29:14] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-02 11:42:32,196 - INFO - 127.0.0.1 - - [02/Dec/2025 11:42:32] "GET / HTTP/1.1" 200 -
2025-12-02 11:42:32,262 - INFO - 127.0.0.1 - - [02/Dec/2025 11:42:32] "GET /static/css/style.css HTTP/1.1" 200 -
2025-12-02 11:42:32,419 - INFO - 127.0.0.1 - - [02/Dec/2025 11:42:32] "GET /static/js/app.js HTTP/1.1" 200 -
2025-12-02 11:42:32,955 - INFO - 127.0.0.1 - - [02/Dec/2025 11:42:32] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-02 11:42:32,958 - INFO - 127.0.0.1 - - [02/Dec/2025 11:42:32] "GET /api/files HTTP/1.1" 200 -
2025-12-02 11:42:44,255 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-02 11:42:44,263 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-12-02 11:42:44,263 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-12-02 11:42:44,264 - INFO - ä¸Šä¼ ç›®å½•: file
2025-12-02 11:42:44,264 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-12-02 11:42:44,268 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-12-02 11:42:44,281 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-12-02 11:42:44,281 - INFO - [33mPress CTRL+C to quit[0m
2025-12-02 11:42:47,049 - INFO - 127.0.0.1 - - [02/Dec/2025 11:42:47] "GET / HTTP/1.1" 200 -
2025-12-02 11:42:47,095 - INFO - 127.0.0.1 - - [02/Dec/2025 11:42:47] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-02 11:42:47,315 - INFO - 127.0.0.1 - - [02/Dec/2025 11:42:47] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-02 11:42:59,302 - INFO - 127.0.0.1 - - [02/Dec/2025 11:42:59] "GET /api/reports/daily/2025-12-01 HTTP/1.1" 200 -
2025-12-02 11:43:47,301 - INFO - 127.0.0.1 - - [02/Dec/2025 11:43:47] "GET /api/reports/monthly/2025-12 HTTP/1.1" 200 -
2025-12-02 11:43:52,230 - INFO - 127.0.0.1 - - [02/Dec/2025 11:43:52] "GET /api/reports/monthly/2025-11 HTTP/1.1" 200 -
2025-12-02 11:43:55,490 - INFO - 127.0.0.1 - - [02/Dec/2025 11:43:55] "[33mGET /api/reports/monthly/2025-10 HTTP/1.1[0m" 404 -
2025-12-02 11:43:57,990 - INFO - 127.0.0.1 - - [02/Dec/2025 11:43:57] "GET /api/reports/monthly/2025-12 HTTP/1.1" 200 -
2025-12-02 11:44:24,454 - INFO - ä»CSVæ–‡ä»¶åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-02 11:44:24,455 - INFO - æ–‡ä»¶å·²ä¿å­˜: file\KF77100064_20251202090432824.zip
2025-12-02 11:44:24,456 - INFO - æ­£åœ¨å¤„ç†æ–‡ä»¶: KF77100064_20251202090432824.zip
2025-12-02 11:44:25,998 - INFO - æ£€æµ‹åˆ°ç¼–ç : GB2312
2025-12-02 11:44:26,000 - INFO - æˆåŠŸä½¿ç”¨ç¼–ç : gbk
2025-12-02 11:44:26,000 - INFO - CSVæ ‡é¢˜: ['æœåŠ¡å', 'å¸å·', 'å§“å', 'æ¨¡å—', 'æ–¹æ³•æè¿°', 'æ“ä½œæ—¶é—´', 'è€—æ—¶', 'è¯·æ±‚url', 'çŠ¶æ€', 'å…¥å‚']
2025-12-02 11:44:26,004 - INFO - æ­£åœ¨ä¿å­˜ 156 æ¡è®°å½•åˆ°æ•°æ®åº“...
2025-12-02 11:44:26,037 - INFO - æ‰¹é‡æ’å…¥å®Œæˆï¼ŒæˆåŠŸ: 0/156ï¼Œè·³è¿‡é‡å¤: 156
2025-12-02 11:44:26,037 - INFO - æ­£åœ¨æ›´æ–°æ—¥æ±‡æ€»: 2025-12-01
2025-12-02 11:44:26,044 - INFO - æ—¥æ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-12-01
2025-12-02 11:44:26,045 - INFO - æ­£åœ¨æ›´æ–°æœˆæ±‡æ€»: 2025-12
2025-12-02 11:44:26,049 - INFO - æœˆæ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-12
2025-12-02 11:44:26,049 - INFO - generate_report function called
2025-12-02 11:44:26,049 - INFO - report_data: {('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 21, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 28, ('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 33, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 21, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 23, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 29}
2025-12-02 11:44:26,049 - INFO - report_date: 2025-12-01
2025-12-02 11:44:26,049 - INFO - total_operations: 156
2025-12-02 11:44:26,049 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-01', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 156', '- **å‚ä¸äººæ•°**: 7', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 22.3', '']
2025-12-02 11:44:26,050 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251201.txt
2025-12-02 11:44:26,050 - INFO - Generating image report...
2025-12-02 11:44:26,050 - INFO - PIL is available.
2025-12-02 11:44:26,122 - INFO - Saving image to file\table_20251201.png
2025-12-02 11:44:26,200 - INFO - Image saved to file\table_20251201.png
2025-12-02 11:44:26,200 - INFO - Saving JPEG version to file\table_20251201.jpg
2025-12-02 11:44:26,203 - INFO - JPEG version saved to file\table_20251201.jpg
2025-12-02 11:44:26,203 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251201.png
2025-12-02 11:44:26,204 - INFO - 127.0.0.1 - - [02/Dec/2025 11:44:26] "POST /api/upload HTTP/1.1" 200 -
2025-12-02 11:44:29,854 - INFO - 127.0.0.1 - - [02/Dec/2025 11:44:29] "GET /api/reports/monthly/2025-12 HTTP/1.1" 200 -
2025-12-02 11:44:30,569 - INFO - 127.0.0.1 - - [02/Dec/2025 11:44:30] "GET /api/reports/monthly/2025-12 HTTP/1.1" 200 -
2025-12-02 11:44:46,028 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-02 11:44:46,035 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-12-02 11:44:46,035 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-12-02 11:44:46,035 - INFO - ä¸Šä¼ ç›®å½•: file
2025-12-02 11:44:46,035 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-12-02 11:44:46,041 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-12-02 11:44:46,052 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-12-02 11:44:46,052 - INFO - [33mPress CTRL+C to quit[0m
2025-12-02 11:44:48,037 - INFO - 127.0.0.1 - - [02/Dec/2025 11:44:48] "GET / HTTP/1.1" 200 -
2025-12-02 11:44:48,100 - INFO - 127.0.0.1 - - [02/Dec/2025 11:44:48] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-02 11:44:48,303 - INFO - 127.0.0.1 - - [02/Dec/2025 11:44:48] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-02 11:47:20,127 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-02 11:47:20,138 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-12-02 11:47:20,138 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-12-02 11:47:20,138 - INFO - ä¸Šä¼ ç›®å½•: file
2025-12-02 11:47:20,138 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-12-02 11:47:20,141 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-12-02 11:47:20,154 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-12-02 11:47:20,154 - INFO - [33mPress CTRL+C to quit[0m
2025-12-02 11:47:34,964 - INFO - 127.0.0.1 - - [02/Dec/2025 11:47:34] "GET / HTTP/1.1" 200 -
2025-12-02 11:47:35,054 - INFO - 127.0.0.1 - - [02/Dec/2025 11:47:35] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-02 11:47:35,217 - INFO - 127.0.0.1 - - [02/Dec/2025 11:47:35] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-02 11:47:40,550 - INFO - 127.0.0.1 - - [02/Dec/2025 11:47:40] "GET / HTTP/1.1" 200 -
2025-12-02 11:47:40,595 - INFO - 127.0.0.1 - - [02/Dec/2025 11:47:40] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-02 11:47:40,798 - INFO - 127.0.0.1 - - [02/Dec/2025 11:47:40] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-02 11:48:04,152 - INFO - 127.0.0.1 - - [02/Dec/2025 11:48:04] "GET / HTTP/1.1" 200 -
2025-12-02 11:48:04,199 - INFO - 127.0.0.1 - - [02/Dec/2025 11:48:04] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-02 11:48:04,455 - INFO - 127.0.0.1 - - [02/Dec/2025 11:48:04] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-02 11:48:09,407 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-02 11:48:09,417 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-12-02 11:48:09,417 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-12-02 11:48:09,417 - INFO - ä¸Šä¼ ç›®å½•: file
2025-12-02 11:48:09,417 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-12-02 11:48:09,422 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-12-02 11:48:09,435 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-12-02 11:48:09,435 - INFO - [33mPress CTRL+C to quit[0m
2025-12-02 11:48:11,415 - INFO - 127.0.0.1 - - [02/Dec/2025 11:48:11] "GET / HTTP/1.1" 200 -
2025-12-02 11:48:11,469 - INFO - 127.0.0.1 - - [02/Dec/2025 11:48:11] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-02 11:48:11,675 - INFO - 127.0.0.1 - - [02/Dec/2025 11:48:11] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-02 11:48:12,115 - INFO - 127.0.0.1 - - [02/Dec/2025 11:48:12] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-02 11:48:12,137 - INFO - 127.0.0.1 - - [02/Dec/2025 11:48:12] "GET /api/files HTTP/1.1" 200 -
2025-12-02 11:48:12,146 - INFO - 127.0.0.1 - - [02/Dec/2025 11:48:12] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-02 11:48:38,754 - INFO - 127.0.0.1 - - [02/Dec/2025 11:48:38] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-02 11:48:42,144 - INFO - æ›´æ–°å›¢é˜Ÿç»„é•¿æˆåŠŸ: ID=2
2025-12-02 11:48:42,144 - INFO - 127.0.0.1 - - [02/Dec/2025 11:48:42] "PUT /api/team-leaders/2 HTTP/1.1" 200 -
2025-12-02 11:48:43,607 - INFO - 127.0.0.1 - - [02/Dec/2025 11:48:43] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-02 11:48:49,036 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-02 11:48:49,036 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-02 11:48:49,036 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-02 11:48:49,045 - INFO - ä»CSVæ–‡ä»¶åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-02 11:48:49,048 - INFO - generate_report function called
2025-12-02 11:48:49,048 - INFO - report_data: {('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 33, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 29, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 28, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 23, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 21, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 21, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1, ('ä¸€ç­2ç»„', 'æ¢ä¸ä¸', 'KF77130185'): 1}
2025-12-02 11:48:49,048 - INFO - report_date: 2025-12-01
2025-12-02 11:48:49,048 - INFO - total_operations: 157
2025-12-02 11:48:49,048 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-01', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 157', '- **å‚ä¸äººæ•°**: 8', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 19.6', '']
2025-12-02 11:48:49,049 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251201.txt
2025-12-02 11:48:49,049 - INFO - Generating image report...
2025-12-02 11:48:49,049 - INFO - PIL is available.
2025-12-02 11:48:49,120 - INFO - Saving image to file\table_20251201.png
2025-12-02 11:48:49,157 - INFO - Image saved to file\table_20251201.png
2025-12-02 11:48:49,158 - INFO - Saving JPEG version to file\table_20251201.jpg
2025-12-02 11:48:49,163 - INFO - JPEG version saved to file\table_20251201.jpg
2025-12-02 11:48:49,164 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251201.png
2025-12-02 11:48:49,164 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-02 11:48:49,164 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251201.jpg
2025-12-02 11:48:49,164 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-02 11:48:49,661 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764647330448150958760456], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-02 11:48:49,661 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-02 11:48:50,155 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-02 11:48:50,155 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-02 11:48:50,155 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-02 11:48:50,157 - INFO - 127.0.0.1 - - [02/Dec/2025 11:48:50] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-02 11:49:06,324 - INFO - 127.0.0.1 - - [02/Dec/2025 11:49:06] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-02 11:49:09,843 - INFO - æ›´æ–°å›¢é˜Ÿç»„é•¿æˆåŠŸ: ID=2
2025-12-02 11:49:09,844 - INFO - 127.0.0.1 - - [02/Dec/2025 11:49:09] "PUT /api/team-leaders/2 HTTP/1.1" 200 -
2025-12-02 11:49:10,954 - INFO - 127.0.0.1 - - [02/Dec/2025 11:49:10] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-02 11:49:54,220 - INFO - æ·»åŠ å›¢é˜Ÿç»„é•¿æˆåŠŸ: ä¸€ç­2ç»„ - 665 (KF77130185)
2025-12-02 11:49:54,220 - INFO - 127.0.0.1 - - [02/Dec/2025 11:49:54] "POST /api/team-leaders HTTP/1.1" 200 -
2025-12-02 11:49:55,551 - INFO - 127.0.0.1 - - [02/Dec/2025 11:49:55] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-02 11:50:03,970 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-02 11:50:03,971 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-02 11:50:03,971 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-02 11:50:04,006 - INFO - ä»CSVæ–‡ä»¶åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-02 11:50:04,006 - INFO - generate_report function called
2025-12-02 11:50:04,007 - INFO - report_data: {('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 33, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 29, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 28, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 23, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 21, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 21, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1, ('ä¸€ç­2ç»„', 'æ¢ä¸ä¸', 'KF77130185'): 1}
2025-12-02 11:50:04,007 - INFO - report_date: 2025-12-01
2025-12-02 11:50:04,007 - INFO - total_operations: 157
2025-12-02 11:50:04,007 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-01', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 157', '- **å‚ä¸äººæ•°**: 8', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 19.6', '']
2025-12-02 11:50:04,008 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251201.txt
2025-12-02 11:50:04,008 - INFO - Generating image report...
2025-12-02 11:50:04,008 - INFO - PIL is available.
2025-12-02 11:50:04,077 - INFO - Saving image to file\table_20251201.png
2025-12-02 11:50:04,103 - INFO - Image saved to file\table_20251201.png
2025-12-02 11:50:04,104 - INFO - Saving JPEG version to file\table_20251201.jpg
2025-12-02 11:50:04,110 - INFO - JPEG version saved to file\table_20251201.jpg
2025-12-02 11:50:04,111 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251201.png
2025-12-02 11:50:04,111 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-02 11:50:04,111 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251201.jpg
2025-12-02 11:50:04,111 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-02 11:50:04,582 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764647405596310708078847], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-02 11:50:04,582 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-02 11:50:05,152 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-02 11:50:05,152 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-02 11:50:05,152 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-02 11:50:05,156 - INFO - 127.0.0.1 - - [02/Dec/2025 11:50:05] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-02 11:50:49,419 - INFO - åˆ é™¤å›¢é˜Ÿç»„é•¿æˆåŠŸ: ID=14
2025-12-02 11:50:49,419 - INFO - 127.0.0.1 - - [02/Dec/2025 11:50:49] "DELETE /api/team-leaders/14 HTTP/1.1" 200 -
2025-12-02 11:50:50,928 - INFO - 127.0.0.1 - - [02/Dec/2025 11:50:50] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-02 11:50:54,459 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-02 11:50:54,459 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-02 11:50:54,460 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-02 11:50:54,469 - INFO - ä»CSVæ–‡ä»¶åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-02 11:50:54,470 - INFO - generate_report function called
2025-12-02 11:50:54,470 - INFO - report_data: {('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 33, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 29, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 28, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 23, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 21, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 21, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1, ('ä¸€ç­2ç»„', 'æ¢ä¸ä¸', 'KF77130185'): 1}
2025-12-02 11:50:54,470 - INFO - report_date: 2025-12-01
2025-12-02 11:50:54,470 - INFO - total_operations: 157
2025-12-02 11:50:54,470 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-01', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 157', '- **å‚ä¸äººæ•°**: 8', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 19.6', '']
2025-12-02 11:50:54,471 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251201.txt
2025-12-02 11:50:54,471 - INFO - Generating image report...
2025-12-02 11:50:54,471 - INFO - PIL is available.
2025-12-02 11:50:54,533 - INFO - Saving image to file\table_20251201.png
2025-12-02 11:50:54,553 - INFO - Image saved to file\table_20251201.png
2025-12-02 11:50:54,553 - INFO - Saving JPEG version to file\table_20251201.jpg
2025-12-02 11:50:54,556 - INFO - JPEG version saved to file\table_20251201.jpg
2025-12-02 11:50:54,557 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251201.png
2025-12-02 11:50:54,557 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-02 11:50:54,557 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251201.jpg
2025-12-02 11:50:54,557 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-02 11:50:55,058 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764647456611670455285607], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-02 11:50:55,058 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-02 11:50:55,560 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-02 11:50:55,560 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-02 11:50:55,560 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-02 11:50:55,562 - INFO - 127.0.0.1 - - [02/Dec/2025 11:50:55] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-02 11:51:19,128 - INFO - 127.0.0.1 - - [02/Dec/2025 11:51:19] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-02 11:51:55,404 - INFO - ä»CSVæ–‡ä»¶åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-02 11:51:55,405 - INFO - æ–‡ä»¶å·²ä¿å­˜: file\KF77100064_20251202090432824.zip
2025-12-02 11:51:55,406 - INFO - æ­£åœ¨å¤„ç†æ–‡ä»¶: KF77100064_20251202090432824.zip
2025-12-02 11:51:56,940 - INFO - æ£€æµ‹åˆ°ç¼–ç : GB2312
2025-12-02 11:51:56,941 - INFO - æˆåŠŸä½¿ç”¨ç¼–ç : gbk
2025-12-02 11:51:56,941 - INFO - CSVæ ‡é¢˜: ['æœåŠ¡å', 'å¸å·', 'å§“å', 'æ¨¡å—', 'æ–¹æ³•æè¿°', 'æ“ä½œæ—¶é—´', 'è€—æ—¶', 'è¯·æ±‚url', 'çŠ¶æ€', 'å…¥å‚']
2025-12-02 11:51:56,947 - INFO - æ­£åœ¨ä¿å­˜ 156 æ¡è®°å½•åˆ°æ•°æ®åº“...
2025-12-02 11:51:56,979 - INFO - æ‰¹é‡æ’å…¥å®Œæˆï¼ŒæˆåŠŸ: 0/156ï¼Œè·³è¿‡é‡å¤: 156
2025-12-02 11:51:56,979 - INFO - æ­£åœ¨æ›´æ–°æ—¥æ±‡æ€»: 2025-12-01
2025-12-02 11:51:56,987 - INFO - æ—¥æ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-12-01
2025-12-02 11:51:56,987 - INFO - æ­£åœ¨æ›´æ–°æœˆæ±‡æ€»: 2025-12
2025-12-02 11:51:56,993 - INFO - æœˆæ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-12
2025-12-02 11:51:56,994 - INFO - generate_report function called
2025-12-02 11:51:56,994 - INFO - report_data: {('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 21, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 28, ('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 33, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 21, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 23, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 29}
2025-12-02 11:51:56,994 - INFO - report_date: 2025-12-01
2025-12-02 11:51:56,994 - INFO - total_operations: 156
2025-12-02 11:51:56,994 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-01', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 156', '- **å‚ä¸äººæ•°**: 7', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 22.3', '']
2025-12-02 11:51:56,994 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251201.txt
2025-12-02 11:51:56,995 - INFO - Generating image report...
2025-12-02 11:51:56,995 - INFO - PIL is available.
2025-12-02 11:51:57,048 - INFO - Saving image to file\table_20251201.png
2025-12-02 11:51:57,067 - INFO - Image saved to file\table_20251201.png
2025-12-02 11:51:57,067 - INFO - Saving JPEG version to file\table_20251201.jpg
2025-12-02 11:51:57,069 - INFO - JPEG version saved to file\table_20251201.jpg
2025-12-02 11:51:57,071 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251201.png
2025-12-02 11:51:57,071 - INFO - 127.0.0.1 - - [02/Dec/2025 11:51:57] "POST /api/upload HTTP/1.1" 200 -
2025-12-02 11:51:57,391 - INFO - 127.0.0.1 - - [02/Dec/2025 11:51:57] "GET /api/files HTTP/1.1" 200 -
2025-12-02 11:52:09,723 - INFO - 127.0.0.1 - - [02/Dec/2025 11:52:09] "GET /api/reports/daily/2025-12-01 HTTP/1.1" 200 -
2025-12-02 11:57:57,001 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-02 11:57:57,009 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-12-02 11:57:57,009 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-12-02 11:57:57,009 - INFO - ä¸Šä¼ ç›®å½•: file
2025-12-02 11:57:57,009 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-12-02 11:57:57,014 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-12-02 11:57:57,023 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-12-02 11:57:57,024 - INFO - [33mPress CTRL+C to quit[0m
2025-12-02 11:58:04,473 - INFO - 127.0.0.1 - - [02/Dec/2025 11:58:04] "GET / HTTP/1.1" 200 -
2025-12-02 11:58:04,528 - INFO - 127.0.0.1 - - [02/Dec/2025 11:58:04] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-02 11:58:04,751 - INFO - 127.0.0.1 - - [02/Dec/2025 11:58:04] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-02 11:58:05,209 - INFO - 127.0.0.1 - - [02/Dec/2025 11:58:05] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-02 11:58:05,214 - INFO - 127.0.0.1 - - [02/Dec/2025 11:58:05] "GET /api/files HTTP/1.1" 200 -
2025-12-02 11:58:05,235 - INFO - 127.0.0.1 - - [02/Dec/2025 11:58:05] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-02 11:58:16,444 - INFO - 127.0.0.1 - - [02/Dec/2025 11:58:16] "GET /api/reports/daily/2025-12-01 HTTP/1.1" 200 -
2025-12-02 11:58:25,156 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-02 11:58:25,156 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-02 11:58:25,156 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-02 11:58:25,164 - INFO - ä»CSVæ–‡ä»¶åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-02 11:58:25,165 - INFO - generate_report function called
2025-12-02 11:58:25,165 - INFO - report_data: {('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 33, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 29, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 28, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 23, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 21, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 21, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1, ('ä¸€ç­2ç»„', 'æ¢ä¸ä¸', 'KF77130185'): 1}
2025-12-02 11:58:25,165 - INFO - report_date: 2025-12-01
2025-12-02 11:58:25,165 - INFO - total_operations: 157
2025-12-02 11:58:25,165 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-01', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 157', '- **å‚ä¸äººæ•°**: 8', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 19.6', '']
2025-12-02 11:58:25,166 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251201.txt
2025-12-02 11:58:25,166 - INFO - Generating image report...
2025-12-02 11:58:25,166 - INFO - PIL is available.
2025-12-02 11:58:25,228 - INFO - Saving image to file\table_20251201.png
2025-12-02 11:58:25,254 - INFO - Image saved to file\table_20251201.png
2025-12-02 11:58:25,254 - INFO - Saving JPEG version to file\table_20251201.jpg
2025-12-02 11:58:25,256 - INFO - JPEG version saved to file\table_20251201.jpg
2025-12-02 11:58:25,257 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251201.png
2025-12-02 11:58:25,257 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-02 11:58:25,258 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251201.jpg
2025-12-02 11:58:25,258 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-02 11:58:25,773 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764647906194173369401782], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-02 11:58:25,774 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-02 11:58:26,252 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-02 11:58:26,252 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-02 11:58:26,252 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-02 11:58:26,254 - INFO - 127.0.0.1 - - [02/Dec/2025 11:58:26] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-02 14:30:35,634 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-02 14:30:35,643 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-12-02 14:30:35,643 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-12-02 14:30:35,643 - INFO - ä¸Šä¼ ç›®å½•: file
2025-12-02 14:30:35,643 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-12-02 14:30:35,647 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-12-02 14:30:35,661 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-12-02 14:30:35,661 - INFO - [33mPress CTRL+C to quit[0m
2025-12-02 14:30:39,514 - INFO - 127.0.0.1 - - [02/Dec/2025 14:30:39] "GET / HTTP/1.1" 200 -
2025-12-02 14:30:39,566 - INFO - 127.0.0.1 - - [02/Dec/2025 14:30:39] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-02 14:30:39,794 - INFO - 127.0.0.1 - - [02/Dec/2025 14:30:39] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-02 14:30:40,325 - INFO - 127.0.0.1 - - [02/Dec/2025 14:30:40] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-02 14:30:40,328 - INFO - 127.0.0.1 - - [02/Dec/2025 14:30:40] "GET /api/files HTTP/1.1" 200 -
2025-12-02 14:30:40,351 - INFO - 127.0.0.1 - - [02/Dec/2025 14:30:40] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-02 14:30:46,242 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-02 14:30:46,242 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-02 14:30:46,242 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-02 14:30:46,251 - INFO - ä»CSVæ–‡ä»¶åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-02 14:30:46,252 - INFO - generate_report function called
2025-12-02 14:30:46,252 - INFO - report_data: {('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 33, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 29, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 28, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 23, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 21, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 21, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1, ('ä¸€ç­2ç»„', 'æ¢ä¸ä¸', 'KF77130185'): 1}
2025-12-02 14:30:46,252 - INFO - report_date: 2025-12-01
2025-12-02 14:30:46,252 - INFO - total_operations: 157
2025-12-02 14:30:46,252 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-01', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 157', '- **å‚ä¸äººæ•°**: 8', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 19.6', '']
2025-12-02 14:30:46,253 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251201.txt
2025-12-02 14:30:46,253 - INFO - Generating image report...
2025-12-02 14:30:46,253 - INFO - PIL is available.
2025-12-02 14:30:46,331 - INFO - Saving image to file\table_20251201.png
2025-12-02 14:30:46,358 - INFO - Image saved to file\table_20251201.png
2025-12-02 14:30:46,358 - INFO - Saving JPEG version to file\table_20251201.jpg
2025-12-02 14:30:46,361 - INFO - JPEG version saved to file\table_20251201.jpg
2025-12-02 14:30:46,362 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251201.png
2025-12-02 14:30:46,363 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-02 14:30:46,363 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251201.jpg
2025-12-02 14:30:46,363 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-02 14:30:46,846 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764657047609111160888971], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-02 14:30:46,846 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-02 14:30:47,324 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-02 14:30:47,324 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-02 14:30:47,324 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-02 14:30:47,325 - INFO - 127.0.0.1 - - [02/Dec/2025 14:30:47] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-02 14:30:52,006 - INFO - 127.0.0.1 - - [02/Dec/2025 14:30:52] "GET /api/reports/daily/2025-12-01 HTTP/1.1" 200 -
2025-12-02 14:36:11,750 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-02 14:36:11,760 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-12-02 14:36:11,760 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-12-02 14:36:11,761 - INFO - ä¸Šä¼ ç›®å½•: file
2025-12-02 14:36:11,761 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-12-02 14:36:11,764 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-12-02 14:36:11,774 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-12-02 14:36:11,775 - INFO - [33mPress CTRL+C to quit[0m
2025-12-02 14:36:14,170 - INFO - 127.0.0.1 - - [02/Dec/2025 14:36:14] "GET / HTTP/1.1" 200 -
2025-12-02 14:36:14,217 - INFO - 127.0.0.1 - - [02/Dec/2025 14:36:14] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-02 14:36:14,460 - INFO - 127.0.0.1 - - [02/Dec/2025 14:36:14] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-02 14:36:14,918 - INFO - 127.0.0.1 - - [02/Dec/2025 14:36:14] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-02 14:36:14,921 - INFO - 127.0.0.1 - - [02/Dec/2025 14:36:14] "GET /api/files HTTP/1.1" 200 -
2025-12-02 14:36:14,923 - INFO - 127.0.0.1 - - [02/Dec/2025 14:36:14] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-02 14:36:23,092 - INFO - æ–‡ä»¶å·²åˆ é™¤: KF77100064_20251202090432824.zip
2025-12-02 14:36:23,093 - INFO - 127.0.0.1 - - [02/Dec/2025 14:36:23] "DELETE /api/files/KF77100064_20251202090432824.zip HTTP/1.1" 200 -
2025-12-02 14:36:24,165 - INFO - 127.0.0.1 - - [02/Dec/2025 14:36:24] "GET /api/files HTTP/1.1" 200 -
2025-12-02 14:36:30,068 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-02 14:36:30,068 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-02 14:36:30,069 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-02 14:36:30,079 - INFO - ä»CSVæ–‡ä»¶åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-02 14:36:30,079 - INFO - generate_report function called
2025-12-02 14:36:30,079 - INFO - report_data: {('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 33, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 29, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 28, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 23, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 21, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 21, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1, ('ä¸€ç­2ç»„', 'æ¢ä¸ä¸', 'KF77130185'): 1}
2025-12-02 14:36:30,080 - INFO - report_date: 2025-12-01
2025-12-02 14:36:30,080 - INFO - total_operations: 157
2025-12-02 14:36:30,080 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-01', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 157', '- **å‚ä¸äººæ•°**: 8', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 19.6', '']
2025-12-02 14:36:30,081 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251201.txt
2025-12-02 14:36:30,081 - INFO - Generating image report...
2025-12-02 14:36:30,081 - INFO - PIL is available.
2025-12-02 14:36:30,153 - INFO - Saving image to file\table_20251201.png
2025-12-02 14:36:30,177 - INFO - Image saved to file\table_20251201.png
2025-12-02 14:36:30,178 - INFO - Saving JPEG version to file\table_20251201.jpg
2025-12-02 14:36:30,180 - INFO - JPEG version saved to file\table_20251201.jpg
2025-12-02 14:36:30,181 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251201.png
2025-12-02 14:36:30,181 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-02 14:36:30,181 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251201.jpg
2025-12-02 14:36:30,182 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-02 14:36:30,704 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764657391358772402825757], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-02 14:36:30,706 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-02 14:36:31,219 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-02 14:36:31,219 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-02 14:36:31,219 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-02 14:36:31,221 - INFO - 127.0.0.1 - - [02/Dec/2025 14:36:31] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-02 14:36:33,268 - INFO - 127.0.0.1 - - [02/Dec/2025 14:36:33] "GET /api/reports/daily/2025-12-01 HTTP/1.1" 200 -
2025-12-02 14:36:53,380 - INFO - ä»CSVæ–‡ä»¶åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-02 14:36:53,383 - INFO - æ–‡ä»¶å·²ä¿å­˜: file\KF77100064_20251202090432824.zip
2025-12-02 14:36:53,385 - INFO - æ­£åœ¨å¤„ç†æ–‡ä»¶: KF77100064_20251202090432824.zip
2025-12-02 14:36:55,000 - INFO - æ£€æµ‹åˆ°ç¼–ç : GB2312
2025-12-02 14:36:55,001 - INFO - æˆåŠŸä½¿ç”¨ç¼–ç : gbk
2025-12-02 14:36:55,001 - INFO - CSVæ ‡é¢˜: ['æœåŠ¡å', 'å¸å·', 'å§“å', 'æ¨¡å—', 'æ–¹æ³•æè¿°', 'æ“ä½œæ—¶é—´', 'è€—æ—¶', 'è¯·æ±‚url', 'çŠ¶æ€', 'å…¥å‚']
2025-12-02 14:36:55,006 - INFO - æ­£åœ¨ä¿å­˜ 156 æ¡è®°å½•åˆ°æ•°æ®åº“...
2025-12-02 14:36:55,040 - INFO - æ‰¹é‡æ’å…¥å®Œæˆï¼ŒæˆåŠŸ: 0/156ï¼Œè·³è¿‡é‡å¤: 156
2025-12-02 14:36:55,041 - INFO - æ­£åœ¨æ›´æ–°æ—¥æ±‡æ€»: 2025-12-01
2025-12-02 14:36:55,047 - INFO - æ—¥æ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-12-01
2025-12-02 14:36:55,047 - INFO - æ­£åœ¨æ›´æ–°æœˆæ±‡æ€»: 2025-12
2025-12-02 14:36:55,053 - INFO - æœˆæ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-12
2025-12-02 14:36:55,053 - INFO - generate_report function called
2025-12-02 14:36:55,053 - INFO - report_data: {('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 21, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 28, ('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 33, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 21, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 23, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 29}
2025-12-02 14:36:55,053 - INFO - report_date: 2025-12-01
2025-12-02 14:36:55,053 - INFO - total_operations: 156
2025-12-02 14:36:55,053 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-01', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 156', '- **å‚ä¸äººæ•°**: 7', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 22.3', '']
2025-12-02 14:36:55,054 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251201.txt
2025-12-02 14:36:55,054 - INFO - Generating image report...
2025-12-02 14:36:55,054 - INFO - PIL is available.
2025-12-02 14:36:55,105 - INFO - Saving image to file\table_20251201.png
2025-12-02 14:36:55,124 - INFO - Image saved to file\table_20251201.png
2025-12-02 14:36:55,124 - INFO - Saving JPEG version to file\table_20251201.jpg
2025-12-02 14:36:55,126 - INFO - JPEG version saved to file\table_20251201.jpg
2025-12-02 14:36:55,127 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251201.png
2025-12-02 14:36:55,128 - INFO - 127.0.0.1 - - [02/Dec/2025 14:36:55] "POST /api/upload HTTP/1.1" 200 -
2025-12-02 14:36:55,137 - INFO - 127.0.0.1 - - [02/Dec/2025 14:36:55] "GET /api/files HTTP/1.1" 200 -
2025-12-02 14:37:01,348 - INFO - 127.0.0.1 - - [02/Dec/2025 14:37:01] "GET /api/reports/daily/2025-12-01 HTTP/1.1" 200 -
2025-12-02 14:37:02,072 - INFO - 127.0.0.1 - - [02/Dec/2025 14:37:02] "GET /api/reports/daily/2025-12-01 HTTP/1.1" 200 -
2025-12-02 14:37:03,510 - INFO - 127.0.0.1 - - [02/Dec/2025 14:37:03] "GET /api/reports/daily/2025-12-01 HTTP/1.1" 200 -
2025-12-02 14:37:15,018 - INFO - 127.0.0.1 - - [02/Dec/2025 14:37:15] "GET /api/reports/monthly/2025-12 HTTP/1.1" 200 -
2025-12-02 14:37:24,016 - INFO - 127.0.0.1 - - [02/Dec/2025 14:37:24] "GET /api/reports/daily/2025-12-01 HTTP/1.1" 200 -
2025-12-02 14:38:22,549 - INFO - 127.0.0.1 - - [02/Dec/2025 14:38:22] "[32mGET / HTTP/1.1[0m" 302 -
2025-12-02 14:38:22,558 - INFO - 127.0.0.1 - - [02/Dec/2025 14:38:22] "GET /login?next=/ HTTP/1.1" 200 -
2025-12-02 14:38:23,007 - INFO - 127.0.0.1 - - [02/Dec/2025 14:38:23] "[33mGET /favicon.ico HTTP/1.1[0m" 404 -
2025-12-02 14:38:39,445 - INFO - 127.0.0.1 - - [02/Dec/2025 14:38:39] "[32mPOST /login HTTP/1.1[0m" 302 -
2025-12-02 14:38:39,453 - INFO - 127.0.0.1 - - [02/Dec/2025 14:38:39] "GET / HTTP/1.1" 200 -
2025-12-02 14:38:39,580 - INFO - 127.0.0.1 - - [02/Dec/2025 14:38:39] "GET /static/css/style.css HTTP/1.1" 200 -
2025-12-02 14:38:39,807 - INFO - 127.0.0.1 - - [02/Dec/2025 14:38:39] "GET /static/js/app.js HTTP/1.1" 200 -
2025-12-02 14:38:40,146 - INFO - 127.0.0.1 - - [02/Dec/2025 14:38:40] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-02 14:38:40,188 - INFO - 127.0.0.1 - - [02/Dec/2025 14:38:40] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-02 14:38:40,189 - INFO - 127.0.0.1 - - [02/Dec/2025 14:38:40] "GET /api/files HTTP/1.1" 200 -
2025-12-02 14:38:57,531 - INFO - ä»CSVæ–‡ä»¶åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-02 14:38:57,532 - INFO - æ–‡ä»¶å·²ä¿å­˜: file\KF77100064_20251202090432824.zip
2025-12-02 14:38:57,533 - INFO - æ­£åœ¨å¤„ç†æ–‡ä»¶: KF77100064_20251202090432824.zip
2025-12-02 14:38:59,041 - INFO - æ£€æµ‹åˆ°ç¼–ç : GB2312
2025-12-02 14:38:59,041 - INFO - æˆåŠŸä½¿ç”¨ç¼–ç : gbk
2025-12-02 14:38:59,042 - INFO - CSVæ ‡é¢˜: ['æœåŠ¡å', 'å¸å·', 'å§“å', 'æ¨¡å—', 'æ–¹æ³•æè¿°', 'æ“ä½œæ—¶é—´', 'è€—æ—¶', 'è¯·æ±‚url', 'çŠ¶æ€', 'å…¥å‚']
2025-12-02 14:38:59,046 - INFO - æ­£åœ¨ä¿å­˜ 156 æ¡è®°å½•åˆ°æ•°æ®åº“...
2025-12-02 14:38:59,079 - INFO - æ‰¹é‡æ’å…¥å®Œæˆï¼ŒæˆåŠŸ: 0/156ï¼Œè·³è¿‡é‡å¤: 156
2025-12-02 14:38:59,079 - INFO - æ­£åœ¨æ›´æ–°æ—¥æ±‡æ€»: 2025-12-01
2025-12-02 14:38:59,084 - INFO - æ—¥æ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-12-01
2025-12-02 14:38:59,084 - INFO - æ­£åœ¨æ›´æ–°æœˆæ±‡æ€»: 2025-12
2025-12-02 14:38:59,090 - INFO - æœˆæ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-12
2025-12-02 14:38:59,090 - INFO - generate_report function called
2025-12-02 14:38:59,090 - INFO - report_data: {('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 21, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 28, ('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 33, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 21, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 23, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 29}
2025-12-02 14:38:59,090 - INFO - report_date: 2025-12-01
2025-12-02 14:38:59,090 - INFO - total_operations: 156
2025-12-02 14:38:59,090 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-01', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 156', '- **å‚ä¸äººæ•°**: 7', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 22.3', '']
2025-12-02 14:38:59,091 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251201.txt
2025-12-02 14:38:59,091 - INFO - Generating image report...
2025-12-02 14:38:59,091 - INFO - PIL is available.
2025-12-02 14:38:59,143 - INFO - Saving image to file\table_20251201.png
2025-12-02 14:38:59,166 - INFO - Image saved to file\table_20251201.png
2025-12-02 14:38:59,166 - INFO - Saving JPEG version to file\table_20251201.jpg
2025-12-02 14:38:59,171 - INFO - JPEG version saved to file\table_20251201.jpg
2025-12-02 14:38:59,172 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251201.png
2025-12-02 14:38:59,172 - INFO - 127.0.0.1 - - [02/Dec/2025 14:38:59] "POST /api/upload HTTP/1.1" 200 -
2025-12-02 14:38:59,487 - INFO - 127.0.0.1 - - [02/Dec/2025 14:38:59] "GET /api/files HTTP/1.1" 200 -
2025-12-02 14:39:05,315 - INFO - 127.0.0.1 - - [02/Dec/2025 14:39:05] "GET /api/reports/daily/2025-12-01 HTTP/1.1" 200 -
2025-12-02 14:42:35,136 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-03 09:33:11,254 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-03 09:33:11,263 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-12-03 09:33:11,263 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-12-03 09:33:11,263 - INFO - ä¸Šä¼ ç›®å½•: file
2025-12-03 09:33:11,263 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-12-03 09:33:11,268 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-12-03 09:33:11,286 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-12-03 09:33:11,287 - INFO - [33mPress CTRL+C to quit[0m
2025-12-03 09:34:00,956 - INFO - æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ: data/wecom_bot.db
2025-12-03 09:34:00,963 - INFO - å¯åŠ¨WebæœåŠ¡å™¨...
2025-12-03 09:34:00,964 - INFO - æ•°æ®åº“è·¯å¾„: data/wecom_bot.db
2025-12-03 09:34:00,964 - INFO - ä¸Šä¼ ç›®å½•: file
2025-12-03 09:34:00,964 - INFO - æ¸…ç†æ—§çš„ä¸´æ—¶æ–‡ä»¶...
2025-12-03 09:34:00,968 - INFO - æ— éœ€æ¸…ç†ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½åœ¨ 30 å¤©å†…
2025-12-03 09:34:00,979 - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://133.0.83.100:5000
2025-12-03 09:34:00,979 - INFO - [33mPress CTRL+C to quit[0m
2025-12-03 09:34:11,981 - INFO - 127.0.0.1 - - [03/Dec/2025 09:34:11] "GET / HTTP/1.1" 200 -
2025-12-03 09:34:12,144 - INFO - 127.0.0.1 - - [03/Dec/2025 09:34:12] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-03 09:34:12,223 - INFO - 127.0.0.1 - - [03/Dec/2025 09:34:12] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-03 09:34:12,907 - INFO - 127.0.0.1 - - [03/Dec/2025 09:34:12] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-03 09:34:12,961 - INFO - 127.0.0.1 - - [03/Dec/2025 09:34:12] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-03 09:34:12,963 - INFO - 127.0.0.1 - - [03/Dec/2025 09:34:12] "GET /api/files HTTP/1.1" 200 -
2025-12-03 09:34:18,492 - INFO - 127.0.0.1 - - [03/Dec/2025 09:34:18] "GET /api/reports/daily/2025-12-01 HTTP/1.1" 200 -
2025-12-03 09:34:30,691 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-02, ç¯å¢ƒ: test
2025-12-03 09:34:30,691 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-03 09:34:30,691 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-03 09:34:30,703 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-03 09:34:30,704 - INFO - 127.0.0.1 - - [03/Dec/2025 09:34:30] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-12-03 09:34:34,376 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-03 09:34:34,376 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-03 09:34:34,376 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-03 09:34:34,391 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-03 09:34:34,394 - INFO - generate_report function called
2025-12-03 09:34:34,394 - INFO - report_data: {('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 33, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 29, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 28, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 23, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 21, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 21, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1}
2025-12-03 09:34:34,394 - INFO - report_date: 2025-12-01
2025-12-03 09:34:34,394 - INFO - total_operations: 156
2025-12-03 09:34:34,394 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-01', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 156', '- **å‚ä¸äººæ•°**: 7', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 22.3', '']
2025-12-03 09:34:34,396 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251201.txt
2025-12-03 09:34:34,396 - INFO - Generating image report...
2025-12-03 09:34:34,396 - INFO - PIL is available.
2025-12-03 09:34:34,510 - INFO - Saving image to file\table_20251201.png
2025-12-03 09:34:34,559 - INFO - Image saved to file\table_20251201.png
2025-12-03 09:34:34,560 - INFO - Saving JPEG version to file\table_20251201.jpg
2025-12-03 09:34:34,564 - INFO - JPEG version saved to file\table_20251201.jpg
2025-12-03 09:34:34,565 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251201.png
2025-12-03 09:34:34,565 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-03 09:34:34,565 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251201.jpg
2025-12-03 09:34:34,566 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-03 09:34:35,099 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764725675550091921278723], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-03 09:34:35,099 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-03 09:34:35,601 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-03 09:34:35,601 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-03 09:34:35,601 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-03 09:34:35,605 - INFO - 127.0.0.1 - - [03/Dec/2025 09:34:35] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-03 09:35:33,883 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-03 09:35:33,887 - INFO - æ–‡ä»¶å·²ä¿å­˜: file\KF77100064_20251203092634013.zip
2025-12-03 09:35:33,889 - INFO - æ­£åœ¨å¤„ç†æ–‡ä»¶: KF77100064_20251203092634013.zip
2025-12-03 09:35:35,816 - INFO - æ£€æµ‹åˆ°ç¼–ç : GB2312
2025-12-03 09:35:35,826 - INFO - æˆåŠŸä½¿ç”¨ç¼–ç : gbk
2025-12-03 09:35:35,827 - INFO - CSVæ ‡é¢˜: ['æœåŠ¡å', 'å¸å·', 'å§“å', 'æ¨¡å—', 'æ–¹æ³•æè¿°', 'æ“ä½œæ—¶é—´', 'è€—æ—¶', 'è¯·æ±‚url', 'çŠ¶æ€', 'å…¥å‚']
2025-12-03 09:35:35,833 - INFO - æ­£åœ¨ä¿å­˜ 232 æ¡è®°å½•åˆ°æ•°æ®åº“...
2025-12-03 09:35:35,893 - INFO - æ‰¹é‡æ’å…¥å®Œæˆï¼ŒæˆåŠŸ: 231/232ï¼Œè·³è¿‡é‡å¤: 1
2025-12-03 09:35:35,893 - INFO - æ­£åœ¨æ›´æ–°æ—¥æ±‡æ€»: 2025-12-02
2025-12-03 09:35:35,898 - INFO - æ—¥æ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-12-02
2025-12-03 09:35:35,899 - INFO - æ­£åœ¨æ›´æ–°æœˆæ±‡æ€»: 2025-12
2025-12-03 09:35:35,905 - INFO - æœˆæ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-12
2025-12-03 09:35:35,905 - INFO - generate_report function called
2025-12-03 09:35:35,905 - INFO - report_data: {('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 27, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 24, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 57, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 18, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 14, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 37, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 23, ('äºŒç­2ç»„', 'ä½•çµ', 'KF77171520'): 6, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 11, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 15}
2025-12-03 09:35:35,906 - INFO - report_date: 2025-12-02
2025-12-03 09:35:35,906 - INFO - total_operations: 232
2025-12-03 09:35:35,906 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-02', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 232', '- **å‚ä¸äººæ•°**: 10', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.2', '']
2025-12-03 09:35:35,907 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251202.txt
2025-12-03 09:35:35,908 - INFO - Generating image report...
2025-12-03 09:35:35,908 - INFO - PIL is available.
2025-12-03 09:35:36,014 - INFO - Saving image to file\table_20251202.png
2025-12-03 09:35:36,050 - INFO - Image saved to file\table_20251202.png
2025-12-03 09:35:36,050 - INFO - Saving JPEG version to file\table_20251202.jpg
2025-12-03 09:35:36,054 - INFO - JPEG version saved to file\table_20251202.jpg
2025-12-03 09:35:36,054 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251202.png
2025-12-03 09:35:36,055 - INFO - 127.0.0.1 - - [03/Dec/2025 09:35:36] "POST /api/upload HTTP/1.1" 200 -
2025-12-03 09:35:36,073 - INFO - 127.0.0.1 - - [03/Dec/2025 09:35:36] "GET /api/files HTTP/1.1" 200 -
2025-12-03 09:35:43,357 - INFO - 127.0.0.1 - - [03/Dec/2025 09:35:43] "GET /api/reports/daily/2025-12-02 HTTP/1.1" 200 -
2025-12-03 09:35:52,599 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-01, ç¯å¢ƒ: test
2025-12-03 09:35:52,599 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-03 09:35:52,599 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-03 09:35:52,614 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-03 09:35:52,615 - INFO - generate_report function called
2025-12-03 09:35:52,616 - INFO - report_data: {('äºŒç­2ç»„', 'æ½˜é›ªåªš', 'KF77130234'): 33, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 29, ('äºŒç­2ç»„', 'ææ–°ç£Š', 'KF77130170'): 28, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 23, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 21, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 21, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 1}
2025-12-03 09:35:52,616 - INFO - report_date: 2025-12-01
2025-12-03 09:35:52,616 - INFO - total_operations: 156
2025-12-03 09:35:52,616 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-01', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 156', '- **å‚ä¸äººæ•°**: 7', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 22.3', '']
2025-12-03 09:35:52,617 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251201.txt
2025-12-03 09:35:52,617 - INFO - Generating image report...
2025-12-03 09:35:52,618 - INFO - PIL is available.
2025-12-03 09:35:52,677 - INFO - Saving image to file\table_20251201.png
2025-12-03 09:35:52,695 - INFO - Image saved to file\table_20251201.png
2025-12-03 09:35:52,695 - INFO - Saving JPEG version to file\table_20251201.jpg
2025-12-03 09:35:52,700 - INFO - JPEG version saved to file\table_20251201.jpg
2025-12-03 09:35:52,701 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251201.png
2025-12-03 09:35:52,701 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-03 09:35:52,702 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251201.jpg
2025-12-03 09:35:52,702 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-03 09:35:53,195 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764725753555210127370784], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-03 09:35:53,195 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-03 09:35:53,758 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-03 09:35:53,758 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-03 09:35:53,758 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-03 09:35:53,760 - INFO - 127.0.0.1 - - [03/Dec/2025 09:35:53] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-03 09:36:28,806 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-02, ç¯å¢ƒ: test
2025-12-03 09:36:28,809 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-03 09:36:28,809 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-03 09:36:28,827 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-03 09:36:28,828 - INFO - generate_report function called
2025-12-03 09:36:28,828 - INFO - report_data: {('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 57, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 37, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 27, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 23, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 18, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 15, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 14, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 11, ('äºŒç­2ç»„', 'ä½•çµ', 'KF77171520'): 6}
2025-12-03 09:36:28,828 - INFO - report_date: 2025-12-02
2025-12-03 09:36:28,828 - INFO - total_operations: 231
2025-12-03 09:36:28,828 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-02', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 231', '- **å‚ä¸äººæ•°**: 10', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.1', '']
2025-12-03 09:36:28,829 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251202.txt
2025-12-03 09:36:28,829 - INFO - Generating image report...
2025-12-03 09:36:28,829 - INFO - PIL is available.
2025-12-03 09:36:28,911 - INFO - Saving image to file\table_20251202.png
2025-12-03 09:36:28,936 - INFO - Image saved to file\table_20251202.png
2025-12-03 09:36:28,937 - INFO - Saving JPEG version to file\table_20251202.jpg
2025-12-03 09:36:28,943 - INFO - JPEG version saved to file\table_20251202.jpg
2025-12-03 09:36:28,944 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251202.png
2025-12-03 09:36:28,944 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-03 09:36:28,944 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251202.jpg
2025-12-03 09:36:28,944 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-03 09:36:29,428 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764725789617343080338961], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-03 09:36:29,428 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-03 09:36:29,987 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-03 09:36:29,987 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-03 09:36:29,987 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-03 09:36:29,990 - INFO - 127.0.0.1 - - [03/Dec/2025 09:36:29] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-03 09:52:13,831 - INFO - 127.0.0.1 - - [03/Dec/2025 09:52:13] "POST /api/schedule/update HTTP/1.1" 200 -
2025-12-03 10:02:27,439 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-02, ç¯å¢ƒ: prod
2025-12-03 10:02:27,439 - INFO - ç¯å¢ƒ: prod, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=f063326...
2025-12-03 10:02:27,439 - INFO - å‡†å¤‡å‘é€åˆ°ç”Ÿäº§ç¯å¢ƒ
2025-12-03 10:02:27,451 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-03 10:02:27,452 - INFO - generate_report function called
2025-12-03 10:02:27,452 - INFO - report_data: {('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 57, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 37, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 27, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 23, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 18, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 15, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 14, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 11, ('äºŒç­2ç»„', 'ä½•çµ', 'KF77171520'): 6}
2025-12-03 10:02:27,452 - INFO - report_date: 2025-12-02
2025-12-03 10:02:27,452 - INFO - total_operations: 231
2025-12-03 10:02:27,452 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-02', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 231', '- **å‚ä¸äººæ•°**: 10', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.1', '']
2025-12-03 10:02:27,454 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251202.txt
2025-12-03 10:02:27,454 - INFO - Generating image report...
2025-12-03 10:02:27,454 - INFO - PIL is available.
2025-12-03 10:02:27,550 - INFO - Saving image to file\table_20251202.png
2025-12-03 10:02:27,573 - INFO - Image saved to file\table_20251202.png
2025-12-03 10:02:27,573 - INFO - Saving JPEG version to file\table_20251202.jpg
2025-12-03 10:02:27,576 - INFO - JPEG version saved to file\table_20251202.jpg
2025-12-03 10:02:27,577 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251202.png
2025-12-03 10:02:27,577 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-03 10:02:27,578 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251202.jpg
2025-12-03 10:02:27,578 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-03 10:02:28,060 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764727348489064104999525], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-03 10:02:28,061 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-03 10:02:28,648 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-03 10:02:28,648 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-03 10:02:28,648 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°ç”Ÿäº§ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=f063326...)
2025-12-03 10:02:28,649 - INFO - 127.0.0.1 - - [03/Dec/2025 10:02:28] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-03 10:12:24,798 - INFO - åˆ é™¤å›¢é˜Ÿç»„é•¿æˆåŠŸ: ID=10
2025-12-03 10:12:24,799 - INFO - 127.0.0.1 - - [03/Dec/2025 10:12:24] "DELETE /api/team-leaders/10 HTTP/1.1" 200 -
2025-12-03 10:12:25,989 - INFO - 127.0.0.1 - - [03/Dec/2025 10:12:25] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-03 10:12:30,994 - INFO - 127.0.0.1 - - [03/Dec/2025 10:12:30] "GET /api/reports/daily/2025-12-02 HTTP/1.1" 200 -
2025-12-03 10:12:36,123 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-02, ç¯å¢ƒ: test
2025-12-03 10:12:36,124 - INFO - ç¯å¢ƒ: test, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...
2025-12-03 10:12:36,124 - INFO - å‡†å¤‡å‘é€åˆ°æµ‹è¯•ç¯å¢ƒ
2025-12-03 10:12:36,133 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-03 10:12:36,133 - INFO - generate_report function called
2025-12-03 10:12:36,133 - INFO - report_data: {('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 57, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 37, ('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 27, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 23, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 23, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 18, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 15, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 14, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 11}
2025-12-03 10:12:36,133 - INFO - report_date: 2025-12-02
2025-12-03 10:12:36,134 - INFO - total_operations: 225
2025-12-03 10:12:36,134 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-02', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 225', '- **å‚ä¸äººæ•°**: 9', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 25.0', '']
2025-12-03 10:12:36,134 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251202.txt
2025-12-03 10:12:36,135 - INFO - Generating image report...
2025-12-03 10:12:36,135 - INFO - PIL is available.
2025-12-03 10:12:36,200 - INFO - Saving image to file\table_20251202.png
2025-12-03 10:12:36,221 - INFO - Image saved to file\table_20251202.png
2025-12-03 10:12:36,221 - INFO - Saving JPEG version to file\table_20251202.jpg
2025-12-03 10:12:36,224 - INFO - JPEG version saved to file\table_20251202.jpg
2025-12-03 10:12:36,225 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251202.png
2025-12-03 10:12:36,225 - INFO - æ£€æµ‹åˆ°å›¾ç‰‡æŠ¥è¡¨ï¼Œå‡†å¤‡å‘é€å›¾ç‰‡
2025-12-03 10:12:36,225 - INFO - ä½¿ç”¨JPEGæ ¼å¼å›¾ç‰‡: file\table_20251202.jpg
2025-12-03 10:12:36,225 - INFO - ä¸Šä¼ å›¾ç‰‡è·å–media_id...
2025-12-03 10:12:36,704 - ERROR - å›¾ç‰‡ä¸Šä¼ å¤±è´¥ï¼ˆæ–¹å¼1ï¼‰: {'errcode': 40004, 'errmsg': 'invalid media type, hint: [1764727956345570364309108], from ip: 121.31.60.243, more info at https://open.work.weixin.qq.com/devtool/query?e=40004'}
2025-12-03 10:12:36,704 - ERROR - å›¾ç‰‡ä¸Šä¼ å¼‚å¸¸ï¼ˆæ–¹å¼2ï¼‰: list index out of range
2025-12-03 10:12:37,264 - INFO - å›¾ç‰‡ä¸Šä¼ æˆåŠŸï¼ˆæ–¹å¼3ï¼‰ï¼Œä½¿ç”¨base64æ–¹å¼
2025-12-03 10:12:37,264 - INFO - å›¾ç‰‡æŠ¥è¡¨å‘é€æˆåŠŸï¼ˆbase64æ–¹å¼ï¼‰
2025-12-03 10:12:37,264 - INFO - âœ“ æŠ¥è¡¨æˆåŠŸå‘é€åˆ°æµ‹è¯•ç¯å¢ƒ (webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=afa40fa...)
2025-12-03 10:12:37,266 - INFO - 127.0.0.1 - - [03/Dec/2025 10:12:37] "POST /api/send-to-wecom HTTP/1.1" 200 -
2025-12-03 10:13:05,585 - INFO - æ–‡ä»¶å·²åˆ é™¤: KF77100064_20251203092634013.zip
2025-12-03 10:13:05,585 - INFO - 127.0.0.1 - - [03/Dec/2025 10:13:05] "DELETE /api/files/KF77100064_20251203092634013.zip HTTP/1.1" 200 -
2025-12-03 10:13:06,817 - INFO - 127.0.0.1 - - [03/Dec/2025 10:13:06] "GET /api/files HTTP/1.1" 200 -
2025-12-03 10:13:08,846 - INFO - æ–‡ä»¶å·²åˆ é™¤: KF77100064_20251202090432824.zip
2025-12-03 10:13:08,848 - INFO - 127.0.0.1 - - [03/Dec/2025 10:13:08] "DELETE /api/files/KF77100064_20251202090432824.zip HTTP/1.1" 200 -
2025-12-03 10:13:10,001 - INFO - 127.0.0.1 - - [03/Dec/2025 10:13:10] "GET /api/files HTTP/1.1" 200 -
2025-12-03 10:13:30,721 - INFO - 127.0.0.1 - - [03/Dec/2025 10:13:30] "GET / HTTP/1.1" 200 -
2025-12-03 10:13:30,758 - INFO - 127.0.0.1 - - [03/Dec/2025 10:13:30] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-03 10:13:30,981 - INFO - 127.0.0.1 - - [03/Dec/2025 10:13:30] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-03 10:13:31,413 - INFO - 127.0.0.1 - - [03/Dec/2025 10:13:31] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-03 10:13:31,425 - INFO - 127.0.0.1 - - [03/Dec/2025 10:13:31] "GET /api/files HTTP/1.1" 200 -
2025-12-03 10:13:31,435 - INFO - 127.0.0.1 - - [03/Dec/2025 10:13:31] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-03 10:19:35,605 - INFO - æ”¶åˆ°å‘é€è¯·æ±‚ - æ—¥æœŸ: 2025-12-03, ç¯å¢ƒ: prod
2025-12-03 10:19:35,606 - INFO - ç¯å¢ƒ: prod, ä½¿ç”¨webhook: https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=f063326...
2025-12-03 10:19:35,606 - INFO - å‡†å¤‡å‘é€åˆ°ç”Ÿäº§ç¯å¢ƒ
2025-12-03 10:19:35,613 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-03 10:19:35,614 - INFO - 127.0.0.1 - - [03/Dec/2025 10:19:35] "[33mPOST /api/send-to-wecom HTTP/1.1[0m" 404 -
2025-12-03 10:19:55,248 - INFO - 127.0.0.1 - - [03/Dec/2025 10:19:55] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-03 11:29:33,490 - INFO - 127.0.0.1 - - [03/Dec/2025 11:29:33] "GET / HTTP/1.1" 200 -
2025-12-03 11:29:33,529 - INFO - 127.0.0.1 - - [03/Dec/2025 11:29:33] "[36mGET /static/css/style.css HTTP/1.1[0m" 304 -
2025-12-03 11:29:33,651 - INFO - 127.0.0.1 - - [03/Dec/2025 11:29:33] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-12-03 11:29:34,220 - INFO - 127.0.0.1 - - [03/Dec/2025 11:29:34] "GET /api/team-leaders HTTP/1.1" 200 -
2025-12-03 11:29:34,256 - INFO - 127.0.0.1 - - [03/Dec/2025 11:29:34] "GET /api/files HTTP/1.1" 200 -
2025-12-03 11:29:34,288 - INFO - 127.0.0.1 - - [03/Dec/2025 11:29:34] "GET /api/schedule/status HTTP/1.1" 200 -
2025-12-03 11:29:41,446 - INFO - å·²åŠ è½½ 13 ä¸ªå›¢é˜Ÿæ˜ å°„
2025-12-03 11:29:41,447 - INFO - æ–‡ä»¶å·²ä¿å­˜: file\KF77100064_20251203092634013.zip
2025-12-03 11:29:41,449 - INFO - æ­£åœ¨å¤„ç†æ–‡ä»¶: KF77100064_20251203092634013.zip
2025-12-03 11:29:43,288 - INFO - æ£€æµ‹åˆ°ç¼–ç : GB2312
2025-12-03 11:29:43,289 - INFO - æˆåŠŸä½¿ç”¨ç¼–ç : gbk
2025-12-03 11:29:43,290 - INFO - CSVæ ‡é¢˜: ['æœåŠ¡å', 'å¸å·', 'å§“å', 'æ¨¡å—', 'æ–¹æ³•æè¿°', 'æ“ä½œæ—¶é—´', 'è€—æ—¶', 'è¯·æ±‚url', 'çŠ¶æ€', 'å…¥å‚']
2025-12-03 11:29:43,299 - INFO - æ­£åœ¨ä¿å­˜ 232 æ¡è®°å½•åˆ°æ•°æ®åº“...
2025-12-03 11:29:43,355 - INFO - æ‰¹é‡æ’å…¥å®Œæˆï¼ŒæˆåŠŸ: 0/232ï¼Œè·³è¿‡é‡å¤: 232
2025-12-03 11:29:43,355 - INFO - æ­£åœ¨æ›´æ–°æ—¥æ±‡æ€»: 2025-12-02
2025-12-03 11:29:43,361 - INFO - æ—¥æ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-12-02
2025-12-03 11:29:43,362 - INFO - æ­£åœ¨æ›´æ–°æœˆæ±‡æ€»: 2025-12
2025-12-03 11:29:43,366 - INFO - æœˆæ±‡æ€»æ›´æ–°æˆåŠŸ: 2025-12
2025-12-03 11:29:43,366 - INFO - generate_report function called
2025-12-03 11:29:43,367 - INFO - report_data: {('äºŒç­1ç»„', 'é»„åˆšåˆš', 'KF77130134'): 27, ('äºŒç­1ç»„', 'æ¨æ™¨æµ©', 'KF77130230'): 24, ('ä¸€ç­1ç»„', 'é™ˆå¤å…°', 'KF77100020'): 57, ('äºŒç­3ç»„', 'å§œé›ªè‰³', 'KF77100340'): 18, ('ä¸€ç­3ç»„', 'å†œè¯—çª', 'KF77130101'): 14, ('äºŒç­3ç»„', 'å¢å¤§ä¼Ÿ', 'KF77130229'): 37, ('ä¸€ç­3ç»„', 'å‘¨ä¸½å©·', 'KF77130099'): 23, ('äºŒç­2ç»„', 'ä½•çµ', 'KF77171520'): 6, ('ä¸€ç­1ç»„', 'éŸ¦æ™–', 'KF77130095'): 11, ('ä¸€ç­2ç»„', 'é»„è®¾å’¸', 'KF77100085'): 15}
2025-12-03 11:29:43,367 - INFO - report_date: 2025-12-02
2025-12-03 11:29:43,367 - INFO - total_operations: 232
2025-12-03 11:29:43,367 - INFO - ç”Ÿæˆçš„æ±‡æ€»ä¿¡æ¯æ–‡æœ¬: ['ğŸ“Š å¬å½•éŸ³ç»Ÿè®¡æŠ¥è¡¨', 'ğŸ“… æ—¥æœŸ: 2025-12-02', '', '## ğŸ“ˆ æ±‡æ€»ä¿¡æ¯', '- **æ€»å¬å½•éŸ³æ¬¡æ•°**: 232', '- **å‚ä¸äººæ•°**: 10', '- **å¹³å‡æ¯äººå¬å½•éŸ³æ¬¡æ•°**: 23.2', '']
2025-12-03 11:29:43,368 - INFO - æ±‡æ€»ä¿¡æ¯å·²ä¿å­˜åˆ°: file\summary_20251202.txt
2025-12-03 11:29:43,368 - INFO - Generating image report...
2025-12-03 11:29:43,368 - INFO - PIL is available.
2025-12-03 11:29:43,448 - INFO - Saving image to file\table_20251202.png
2025-12-03 11:29:43,497 - INFO - Image saved to file\table_20251202.png
2025-12-03 11:29:43,497 - INFO - Saving JPEG version to file\table_20251202.jpg
2025-12-03 11:29:43,500 - INFO - JPEG version saved to file\table_20251202.jpg
2025-12-03 11:29:43,501 - INFO - è¡¨æ ¼å›¾ç‰‡å·²ä¿å­˜åˆ°: file\table_20251202.png
2025-12-03 11:29:43,502 - INFO - 127.0.0.1 - - [03/Dec/2025 11:29:43] "POST /api/upload HTTP/1.1" 200 -
2025-12-03 11:29:43,815 - INFO - 127.0.0.1 - - [03/Dec/2025 11:29:43] "GET /api/files HTTP/1.1" 200 -
2025-12-03 11:29:52,756 - INFO - 127.0.0.1 - - [03/Dec/2025 11:29:52] "GET /api/reports/daily/2025-12-02 HTTP/1.1" 200 -
